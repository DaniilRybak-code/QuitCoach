(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Ex(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ry={exports:{}},Zl={},sy={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ko=Symbol.for("react.element"),Ix=Symbol.for("react.portal"),Nx=Symbol.for("react.fragment"),Cx=Symbol.for("react.strict_mode"),Tx=Symbol.for("react.profiler"),kx=Symbol.for("react.provider"),Px=Symbol.for("react.context"),Rx=Symbol.for("react.forward_ref"),Ax=Symbol.for("react.suspense"),Dx=Symbol.for("react.memo"),jx=Symbol.for("react.lazy"),Ep=Symbol.iterator;function Ox(t){return t===null||typeof t!="object"?null:(t=Ep&&t[Ep]||t["@@iterator"],typeof t=="function"?t:null)}var iy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oy=Object.assign,ay={};function yi(t,e,n){this.props=t,this.context=e,this.refs=ay,this.updater=n||iy}yi.prototype.isReactComponent={};yi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};yi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ly(){}ly.prototype=yi.prototype;function fh(t,e,n){this.props=t,this.context=e,this.refs=ay,this.updater=n||iy}var ph=fh.prototype=new ly;ph.constructor=fh;oy(ph,yi.prototype);ph.isPureReactComponent=!0;var Ip=Array.isArray,cy=Object.prototype.hasOwnProperty,mh={current:null},uy={key:!0,ref:!0,__self:!0,__source:!0};function dy(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)cy.call(e,r)&&!uy.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ko,type:t,key:i,ref:o,props:s,_owner:mh.current}}function Lx(t,e){return{$$typeof:Ko,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ko}function Mx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Np=/\/+/g;function Jc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Mx(""+t.key):e.toString(36)}function Va(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ko:case Ix:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Jc(o,0):r,Ip(s)?(n="",t!=null&&(n=t.replace(Np,"$&/")+"/"),Va(s,e,n,"",function(u){return u})):s!=null&&(gh(s)&&(s=Lx(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Np,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Ip(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+Jc(i,l);o+=Va(i,e,n,c,s)}else if(c=Ox(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+Jc(i,l++),o+=Va(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function _a(t,e,n){if(t==null)return t;var r=[],s=0;return Va(t,r,"","",function(i){return e.call(n,i,s++)}),r}function Fx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var xt={current:null},Wa={transition:null},Ux={ReactCurrentDispatcher:xt,ReactCurrentBatchConfig:Wa,ReactCurrentOwner:mh};function hy(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:_a,forEach:function(t,e,n){_a(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return _a(t,function(){e++}),e},toArray:function(t){return _a(t,function(e){return e})||[]},only:function(t){if(!gh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};se.Component=yi;se.Fragment=Nx;se.Profiler=Tx;se.PureComponent=fh;se.StrictMode=Cx;se.Suspense=Ax;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ux;se.act=hy;se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=oy({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=mh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)cy.call(e,c)&&!uy.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Ko,type:t.type,key:s,ref:i,props:r,_owner:o}};se.createContext=function(t){return t={$$typeof:Px,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:kx,_context:t},t.Consumer=t};se.createElement=dy;se.createFactory=function(t){var e=dy.bind(null,t);return e.type=t,e};se.createRef=function(){return{current:null}};se.forwardRef=function(t){return{$$typeof:Rx,render:t}};se.isValidElement=gh;se.lazy=function(t){return{$$typeof:jx,_payload:{_status:-1,_result:t},_init:Fx}};se.memo=function(t,e){return{$$typeof:Dx,type:t,compare:e===void 0?null:e}};se.startTransition=function(t){var e=Wa.transition;Wa.transition={};try{t()}finally{Wa.transition=e}};se.unstable_act=hy;se.useCallback=function(t,e){return xt.current.useCallback(t,e)};se.useContext=function(t){return xt.current.useContext(t)};se.useDebugValue=function(){};se.useDeferredValue=function(t){return xt.current.useDeferredValue(t)};se.useEffect=function(t,e){return xt.current.useEffect(t,e)};se.useId=function(){return xt.current.useId()};se.useImperativeHandle=function(t,e,n){return xt.current.useImperativeHandle(t,e,n)};se.useInsertionEffect=function(t,e){return xt.current.useInsertionEffect(t,e)};se.useLayoutEffect=function(t,e){return xt.current.useLayoutEffect(t,e)};se.useMemo=function(t,e){return xt.current.useMemo(t,e)};se.useReducer=function(t,e,n){return xt.current.useReducer(t,e,n)};se.useRef=function(t){return xt.current.useRef(t)};se.useState=function(t){return xt.current.useState(t)};se.useSyncExternalStore=function(t,e,n){return xt.current.useSyncExternalStore(t,e,n)};se.useTransition=function(){return xt.current.useTransition()};se.version="18.3.1";sy.exports=se;var N=sy.exports;const $x=Ex(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bx=N,Vx=Symbol.for("react.element"),Wx=Symbol.for("react.fragment"),zx=Object.prototype.hasOwnProperty,Hx=Bx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gx={key:!0,ref:!0,__self:!0,__source:!0};function fy(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)zx.call(e,r)&&!Gx.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Vx,type:t,key:i,ref:o,props:s,_owner:Hx.current}}Zl.Fragment=Wx;Zl.jsx=fy;Zl.jsxs=fy;ry.exports=Zl;var a=ry.exports,Hu={},py={exports:{}},Ht={},my={exports:{}},gy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(k,$){var B=k.length;k.push($);e:for(;0<B;){var Y=B-1>>>1,q=k[Y];if(0<s(q,$))k[Y]=$,k[B]=q,B=Y;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var $=k[0],B=k.pop();if(B!==$){k[0]=B;e:for(var Y=0,q=k.length,ue=q>>>1;Y<ue;){var xe=2*(Y+1)-1,re=k[xe],he=xe+1,ot=k[he];if(0>s(re,B))he<q&&0>s(ot,re)?(k[Y]=ot,k[he]=B,Y=he):(k[Y]=re,k[xe]=B,Y=xe);else if(he<q&&0>s(ot,B))k[Y]=ot,k[he]=B,Y=he;else break e}}return $}function s(k,$){var B=k.sortIndex-$.sortIndex;return B!==0?B:k.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,g=!1,_=!1,x=!1,M=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(k){for(var $=n(u);$!==null;){if($.callback===null)r(u);else if($.startTime<=k)r(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=n(u)}}function b(k){if(x=!1,y(k),!_)if(n(c)!==null)_=!0,G(P);else{var $=n(u);$!==null&&Q(b,$.startTime-k)}}function P(k,$){_=!1,x&&(x=!1,m(T),T=-1),g=!0;var B=f;try{for(y($),h=n(c);h!==null&&(!(h.expirationTime>$)||k&&!S());){var Y=h.callback;if(typeof Y=="function"){h.callback=null,f=h.priorityLevel;var q=Y(h.expirationTime<=$);$=t.unstable_now(),typeof q=="function"?h.callback=q:h===n(c)&&r(c),y($)}else r(c);h=n(c)}if(h!==null)var ue=!0;else{var xe=n(u);xe!==null&&Q(b,xe.startTime-$),ue=!1}return ue}finally{h=null,f=B,g=!1}}var C=!1,R=null,T=-1,L=5,w=-1;function S(){return!(t.unstable_now()-w<L)}function v(){if(R!==null){var k=t.unstable_now();w=k;var $=!0;try{$=R(!0,k)}finally{$?E():(C=!1,R=null)}}else C=!1}var E;if(typeof p=="function")E=function(){p(v)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,U=A.port2;A.port1.onmessage=v,E=function(){U.postMessage(null)}}else E=function(){M(v,0)};function G(k){R=k,C||(C=!0,E())}function Q(k,$){T=M(function(){k(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){_||g||(_=!0,G(P))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(k){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var B=f;f=$;try{return k()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,$){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var B=f;f=k;try{return $()}finally{f=B}},t.unstable_scheduleCallback=function(k,$,B){var Y=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?Y+B:Y):B=Y,k){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=B+q,k={id:d++,callback:$,priorityLevel:k,startTime:B,expirationTime:q,sortIndex:-1},B>Y?(k.sortIndex=B,e(u,k),n(c)===null&&k===n(u)&&(x?(m(T),T=-1):x=!0,Q(b,B-Y))):(k.sortIndex=q,e(c,k),_||g||(_=!0,G(P))),k},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(k){var $=f;return function(){var B=f;f=$;try{return k.apply(this,arguments)}finally{f=B}}}})(gy);my.exports=gy;var qx=my.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx=N,Vt=qx;function D(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yy=new Set,mo={};function _s(t,e){si(t,e),si(t+"Capture",e)}function si(t,e){for(mo[t]=e,t=0;t<e.length;t++)yy.add(e[t])}var qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gu=Object.prototype.hasOwnProperty,Yx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cp={},Tp={};function Qx(t){return Gu.call(Tp,t)?!0:Gu.call(Cp,t)?!1:Yx.test(t)?Tp[t]=!0:(Cp[t]=!0,!1)}function Jx(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Xx(t,e,n,r){if(e===null||typeof e>"u"||Jx(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var it={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){it[t]=new bt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];it[e]=new bt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){it[t]=new bt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){it[t]=new bt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){it[t]=new bt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){it[t]=new bt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){it[t]=new bt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){it[t]=new bt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){it[t]=new bt(t,5,!1,t.toLowerCase(),null,!1,!1)});var yh=/[\-:]([a-z])/g;function vh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yh,vh);it[e]=new bt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yh,vh);it[e]=new bt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yh,vh);it[e]=new bt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){it[t]=new bt(t,1,!1,t.toLowerCase(),null,!1,!1)});it.xlinkHref=new bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){it[t]=new bt(t,1,!1,t.toLowerCase(),null,!0,!0)});function _h(t,e,n,r){var s=it.hasOwnProperty(e)?it[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Xx(e,n,s,r)&&(n=null),r||s===null?Qx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var nr=Kx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wa=Symbol.for("react.element"),js=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),wh=Symbol.for("react.strict_mode"),qu=Symbol.for("react.profiler"),vy=Symbol.for("react.provider"),_y=Symbol.for("react.context"),xh=Symbol.for("react.forward_ref"),Ku=Symbol.for("react.suspense"),Yu=Symbol.for("react.suspense_list"),bh=Symbol.for("react.memo"),cr=Symbol.for("react.lazy"),wy=Symbol.for("react.offscreen"),kp=Symbol.iterator;function ki(t){return t===null||typeof t!="object"?null:(t=kp&&t[kp]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,Xc;function Vi(t){if(Xc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xc=e&&e[1]||""}return`
`+Xc+t}var Zc=!1;function eu(t,e){if(!t||Zc)return"";Zc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Zc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Vi(t):""}function Zx(t){switch(t.tag){case 5:return Vi(t.type);case 16:return Vi("Lazy");case 13:return Vi("Suspense");case 19:return Vi("SuspenseList");case 0:case 2:case 15:return t=eu(t.type,!1),t;case 11:return t=eu(t.type.render,!1),t;case 1:return t=eu(t.type,!0),t;default:return""}}function Qu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Os:return"Fragment";case js:return"Portal";case qu:return"Profiler";case wh:return"StrictMode";case Ku:return"Suspense";case Yu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _y:return(t.displayName||"Context")+".Consumer";case vy:return(t._context.displayName||"Context")+".Provider";case xh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case bh:return e=t.displayName||null,e!==null?e:Qu(t.type)||"Memo";case cr:e=t._payload,t=t._init;try{return Qu(t(e))}catch{}}return null}function eb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qu(e);case 8:return e===wh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function tb(t){var e=xy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xa(t){t._valueTracker||(t._valueTracker=tb(t))}function by(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=xy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function il(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ju(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Pp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=jr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sy(t,e){e=e.checked,e!=null&&_h(t,"checked",e,!1)}function Xu(t,e){Sy(t,e);var n=jr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Zu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Zu(t,e.type,jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Zu(t,e,n){(e!=="number"||il(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wi=Array.isArray;function Gs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+jr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function ed(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(D(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ap(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(D(92));if(Wi(n)){if(1<n.length)throw Error(D(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:jr(n)}}function Ey(t,e){var n=jr(e.value),r=jr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Iy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function td(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Iy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ba,Ny=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ba=ba||document.createElement("div"),ba.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ba.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function go(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nb=["Webkit","ms","Moz","O"];Object.keys(Qi).forEach(function(t){nb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qi[e]=Qi[t]})});function Cy(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qi.hasOwnProperty(t)&&Qi[t]?(""+e).trim():e+"px"}function Ty(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Cy(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var rb=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nd(t,e){if(e){if(rb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(D(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(D(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(D(61))}if(e.style!=null&&typeof e.style!="object")throw Error(D(62))}}function rd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sd=null;function Sh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var id=null,qs=null,Ks=null;function jp(t){if(t=Jo(t)){if(typeof id!="function")throw Error(D(280));var e=t.stateNode;e&&(e=sc(e),id(t.stateNode,t.type,e))}}function ky(t){qs?Ks?Ks.push(t):Ks=[t]:qs=t}function Py(){if(qs){var t=qs,e=Ks;if(Ks=qs=null,jp(t),e)for(t=0;t<e.length;t++)jp(e[t])}}function Ry(t,e){return t(e)}function Ay(){}var tu=!1;function Dy(t,e,n){if(tu)return t(e,n);tu=!0;try{return Ry(t,e,n)}finally{tu=!1,(qs!==null||Ks!==null)&&(Ay(),Py())}}function yo(t,e){var n=t.stateNode;if(n===null)return null;var r=sc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(D(231,e,typeof n));return n}var od=!1;if(qn)try{var Pi={};Object.defineProperty(Pi,"passive",{get:function(){od=!0}}),window.addEventListener("test",Pi,Pi),window.removeEventListener("test",Pi,Pi)}catch{od=!1}function sb(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Ji=!1,ol=null,al=!1,ad=null,ib={onError:function(t){Ji=!0,ol=t}};function ob(t,e,n,r,s,i,o,l,c){Ji=!1,ol=null,sb.apply(ib,arguments)}function ab(t,e,n,r,s,i,o,l,c){if(ob.apply(this,arguments),Ji){if(Ji){var u=ol;Ji=!1,ol=null}else throw Error(D(198));al||(al=!0,ad=u)}}function ws(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Op(t){if(ws(t)!==t)throw Error(D(188))}function lb(t){var e=t.alternate;if(!e){if(e=ws(t),e===null)throw Error(D(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Op(s),t;if(i===r)return Op(s),e;i=i.sibling}throw Error(D(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(D(189))}}if(n.alternate!==r)throw Error(D(190))}if(n.tag!==3)throw Error(D(188));return n.stateNode.current===n?t:e}function Oy(t){return t=lb(t),t!==null?Ly(t):null}function Ly(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ly(t);if(e!==null)return e;t=t.sibling}return null}var My=Vt.unstable_scheduleCallback,Lp=Vt.unstable_cancelCallback,cb=Vt.unstable_shouldYield,ub=Vt.unstable_requestPaint,$e=Vt.unstable_now,db=Vt.unstable_getCurrentPriorityLevel,Eh=Vt.unstable_ImmediatePriority,Fy=Vt.unstable_UserBlockingPriority,ll=Vt.unstable_NormalPriority,hb=Vt.unstable_LowPriority,Uy=Vt.unstable_IdlePriority,ec=null,Nn=null;function fb(t){if(Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(ec,t,void 0,(t.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:gb,pb=Math.log,mb=Math.LN2;function gb(t){return t>>>=0,t===0?32:31-(pb(t)/mb|0)|0}var Sa=64,Ea=4194304;function zi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=zi(l):(i&=o,i!==0&&(r=zi(i)))}else o=n&~s,o!==0?r=zi(o):i!==0&&(r=zi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-pn(e),s=1<<n,r|=t[n],e&=~s;return r}function yb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vb(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-pn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=yb(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function ld(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $y(){var t=Sa;return Sa<<=1,!(Sa&4194240)&&(Sa=64),t}function nu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Yo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pn(e),t[e]=n}function _b(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-pn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Ih(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-pn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var de=0;function By(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Vy,Nh,Wy,zy,Hy,cd=!1,Ia=[],xr=null,br=null,Sr=null,vo=new Map,_o=new Map,hr=[],wb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mp(t,e){switch(t){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":br=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":vo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_o.delete(e.pointerId)}}function Ri(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Jo(e),e!==null&&Nh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function xb(t,e,n,r,s){switch(e){case"focusin":return xr=Ri(xr,t,e,n,r,s),!0;case"dragenter":return br=Ri(br,t,e,n,r,s),!0;case"mouseover":return Sr=Ri(Sr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return vo.set(i,Ri(vo.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,_o.set(i,Ri(_o.get(i)||null,t,e,n,r,s)),!0}return!1}function Gy(t){var e=Qr(t.target);if(e!==null){var n=ws(e);if(n!==null){if(e=n.tag,e===13){if(e=jy(n),e!==null){t.blockedOn=e,Hy(t.priority,function(){Wy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function za(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ud(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);sd=r,n.target.dispatchEvent(r),sd=null}else return e=Jo(n),e!==null&&Nh(e),t.blockedOn=n,!1;e.shift()}return!0}function Fp(t,e,n){za(t)&&n.delete(e)}function bb(){cd=!1,xr!==null&&za(xr)&&(xr=null),br!==null&&za(br)&&(br=null),Sr!==null&&za(Sr)&&(Sr=null),vo.forEach(Fp),_o.forEach(Fp)}function Ai(t,e){t.blockedOn===e&&(t.blockedOn=null,cd||(cd=!0,Vt.unstable_scheduleCallback(Vt.unstable_NormalPriority,bb)))}function wo(t){function e(s){return Ai(s,t)}if(0<Ia.length){Ai(Ia[0],t);for(var n=1;n<Ia.length;n++){var r=Ia[n];r.blockedOn===t&&(r.blockedOn=null)}}for(xr!==null&&Ai(xr,t),br!==null&&Ai(br,t),Sr!==null&&Ai(Sr,t),vo.forEach(e),_o.forEach(e),n=0;n<hr.length;n++)r=hr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<hr.length&&(n=hr[0],n.blockedOn===null);)Gy(n),n.blockedOn===null&&hr.shift()}var Ys=nr.ReactCurrentBatchConfig,ul=!0;function Sb(t,e,n,r){var s=de,i=Ys.transition;Ys.transition=null;try{de=1,Ch(t,e,n,r)}finally{de=s,Ys.transition=i}}function Eb(t,e,n,r){var s=de,i=Ys.transition;Ys.transition=null;try{de=4,Ch(t,e,n,r)}finally{de=s,Ys.transition=i}}function Ch(t,e,n,r){if(ul){var s=ud(t,e,n,r);if(s===null)hu(t,e,r,dl,n),Mp(t,r);else if(xb(s,t,e,n,r))r.stopPropagation();else if(Mp(t,r),e&4&&-1<wb.indexOf(t)){for(;s!==null;){var i=Jo(s);if(i!==null&&Vy(i),i=ud(t,e,n,r),i===null&&hu(t,e,r,dl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else hu(t,e,r,null,n)}}var dl=null;function ud(t,e,n,r){if(dl=null,t=Sh(r),t=Qr(t),t!==null)if(e=ws(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return dl=t,null}function qy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(db()){case Eh:return 1;case Fy:return 4;case ll:case hb:return 16;case Uy:return 536870912;default:return 16}default:return 16}}var yr=null,Th=null,Ha=null;function Ky(){if(Ha)return Ha;var t,e=Th,n=e.length,r,s="value"in yr?yr.value:yr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Ha=s.slice(t,1<r?1-r:void 0)}function Ga(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Na(){return!0}function Up(){return!1}function Gt(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Na:Up,this.isPropagationStopped=Up,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Na)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Na)},persist:function(){},isPersistent:Na}),e}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kh=Gt(vi),Qo=je({},vi,{view:0,detail:0}),Ib=Gt(Qo),ru,su,Di,tc=je({},Qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ph,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Di&&(Di&&t.type==="mousemove"?(ru=t.screenX-Di.screenX,su=t.screenY-Di.screenY):su=ru=0,Di=t),ru)},movementY:function(t){return"movementY"in t?t.movementY:su}}),$p=Gt(tc),Nb=je({},tc,{dataTransfer:0}),Cb=Gt(Nb),Tb=je({},Qo,{relatedTarget:0}),iu=Gt(Tb),kb=je({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),Pb=Gt(kb),Rb=je({},vi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ab=Gt(Rb),Db=je({},vi,{data:0}),Bp=Gt(Db),jb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ob={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Lb[t])?!!e[t]:!1}function Ph(){return Mb}var Fb=je({},Qo,{key:function(t){if(t.key){var e=jb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ga(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ob[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ph,charCode:function(t){return t.type==="keypress"?Ga(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ga(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ub=Gt(Fb),$b=je({},tc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vp=Gt($b),Bb=je({},Qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ph}),Vb=Gt(Bb),Wb=je({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),zb=Gt(Wb),Hb=je({},tc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Gb=Gt(Hb),qb=[9,13,27,32],Rh=qn&&"CompositionEvent"in window,Xi=null;qn&&"documentMode"in document&&(Xi=document.documentMode);var Kb=qn&&"TextEvent"in window&&!Xi,Yy=qn&&(!Rh||Xi&&8<Xi&&11>=Xi),Wp=String.fromCharCode(32),zp=!1;function Qy(t,e){switch(t){case"keyup":return qb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ls=!1;function Yb(t,e){switch(t){case"compositionend":return Jy(e);case"keypress":return e.which!==32?null:(zp=!0,Wp);case"textInput":return t=e.data,t===Wp&&zp?null:t;default:return null}}function Qb(t,e){if(Ls)return t==="compositionend"||!Rh&&Qy(t,e)?(t=Ky(),Ha=Th=yr=null,Ls=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Yy&&e.locale!=="ko"?null:e.data;default:return null}}var Jb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Jb[t.type]:e==="textarea"}function Xy(t,e,n,r){ky(r),e=hl(e,"onChange"),0<e.length&&(n=new kh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zi=null,xo=null;function Xb(t){c0(t,0)}function nc(t){var e=Us(t);if(by(e))return t}function Zb(t,e){if(t==="change")return e}var Zy=!1;if(qn){var ou;if(qn){var au="oninput"in document;if(!au){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),au=typeof Gp.oninput=="function"}ou=au}else ou=!1;Zy=ou&&(!document.documentMode||9<document.documentMode)}function qp(){Zi&&(Zi.detachEvent("onpropertychange",e0),xo=Zi=null)}function e0(t){if(t.propertyName==="value"&&nc(xo)){var e=[];Xy(e,xo,t,Sh(t)),Dy(Xb,e)}}function eS(t,e,n){t==="focusin"?(qp(),Zi=e,xo=n,Zi.attachEvent("onpropertychange",e0)):t==="focusout"&&qp()}function tS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nc(xo)}function nS(t,e){if(t==="click")return nc(e)}function rS(t,e){if(t==="input"||t==="change")return nc(e)}function sS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yn=typeof Object.is=="function"?Object.is:sS;function bo(t,e){if(yn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Gu.call(e,s)||!yn(t[s],e[s]))return!1}return!0}function Kp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yp(t,e){var n=Kp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Kp(n)}}function t0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?t0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function n0(){for(var t=window,e=il();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=il(t.document)}return e}function Ah(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function iS(t){var e=n0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&t0(n.ownerDocument.documentElement,n)){if(r!==null&&Ah(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Yp(n,i);var o=Yp(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oS=qn&&"documentMode"in document&&11>=document.documentMode,Ms=null,dd=null,eo=null,hd=!1;function Qp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hd||Ms==null||Ms!==il(r)||(r=Ms,"selectionStart"in r&&Ah(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),eo&&bo(eo,r)||(eo=r,r=hl(dd,"onSelect"),0<r.length&&(e=new kh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ms)))}function Ca(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Fs={animationend:Ca("Animation","AnimationEnd"),animationiteration:Ca("Animation","AnimationIteration"),animationstart:Ca("Animation","AnimationStart"),transitionend:Ca("Transition","TransitionEnd")},lu={},r0={};qn&&(r0=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function rc(t){if(lu[t])return lu[t];if(!Fs[t])return t;var e=Fs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in r0)return lu[t]=e[n];return t}var s0=rc("animationend"),i0=rc("animationiteration"),o0=rc("animationstart"),a0=rc("transitionend"),l0=new Map,Jp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vr(t,e){l0.set(t,e),_s(e,[t])}for(var cu=0;cu<Jp.length;cu++){var uu=Jp[cu],aS=uu.toLowerCase(),lS=uu[0].toUpperCase()+uu.slice(1);Vr(aS,"on"+lS)}Vr(s0,"onAnimationEnd");Vr(i0,"onAnimationIteration");Vr(o0,"onAnimationStart");Vr("dblclick","onDoubleClick");Vr("focusin","onFocus");Vr("focusout","onBlur");Vr(a0,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hi));function Xp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ab(r,e,void 0,t),t.currentTarget=null}function c0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Xp(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Xp(s,l,u),i=c}}}if(al)throw t=ad,al=!1,ad=null,t}function be(t,e){var n=e[yd];n===void 0&&(n=e[yd]=new Set);var r=t+"__bubble";n.has(r)||(u0(e,t,2,!1),n.add(r))}function du(t,e,n){var r=0;e&&(r|=4),u0(n,t,r,e)}var Ta="_reactListening"+Math.random().toString(36).slice(2);function So(t){if(!t[Ta]){t[Ta]=!0,yy.forEach(function(n){n!=="selectionchange"&&(cS.has(n)||du(n,!1,t),du(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ta]||(e[Ta]=!0,du("selectionchange",!1,e))}}function u0(t,e,n,r){switch(qy(e)){case 1:var s=Sb;break;case 4:s=Eb;break;default:s=Ch}n=s.bind(null,e,n,t),s=void 0,!od||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function hu(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Qr(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Dy(function(){var u=i,d=Sh(n),h=[];e:{var f=l0.get(t);if(f!==void 0){var g=kh,_=t;switch(t){case"keypress":if(Ga(n)===0)break e;case"keydown":case"keyup":g=Ub;break;case"focusin":_="focus",g=iu;break;case"focusout":_="blur",g=iu;break;case"beforeblur":case"afterblur":g=iu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=$p;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Cb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Vb;break;case s0:case i0:case o0:g=Pb;break;case a0:g=zb;break;case"scroll":g=Ib;break;case"wheel":g=Gb;break;case"copy":case"cut":case"paste":g=Ab;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Vp}var x=(e&4)!==0,M=!x&&t==="scroll",m=x?f!==null?f+"Capture":null:f;x=[];for(var p=u,y;p!==null;){y=p;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,m!==null&&(b=yo(p,m),b!=null&&x.push(Eo(p,b,y)))),M)break;p=p.return}0<x.length&&(f=new g(f,_,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==sd&&(_=n.relatedTarget||n.fromElement)&&(Qr(_)||_[Kn]))break e;if((g||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,g?(_=n.relatedTarget||n.toElement,g=u,_=_?Qr(_):null,_!==null&&(M=ws(_),_!==M||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=u),g!==_)){if(x=$p,b="onMouseLeave",m="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(x=Vp,b="onPointerLeave",m="onPointerEnter",p="pointer"),M=g==null?f:Us(g),y=_==null?f:Us(_),f=new x(b,p+"leave",g,n,d),f.target=M,f.relatedTarget=y,b=null,Qr(d)===u&&(x=new x(m,p+"enter",_,n,d),x.target=y,x.relatedTarget=M,b=x),M=b,g&&_)t:{for(x=g,m=_,p=0,y=x;y;y=As(y))p++;for(y=0,b=m;b;b=As(b))y++;for(;0<p-y;)x=As(x),p--;for(;0<y-p;)m=As(m),y--;for(;p--;){if(x===m||m!==null&&x===m.alternate)break t;x=As(x),m=As(m)}x=null}else x=null;g!==null&&Zp(h,f,g,x,!1),_!==null&&M!==null&&Zp(h,M,_,x,!0)}}e:{if(f=u?Us(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var P=Zb;else if(Hp(f))if(Zy)P=rS;else{P=tS;var C=eS}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=nS);if(P&&(P=P(t,u))){Xy(h,P,n,d);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Zu(f,"number",f.value)}switch(C=u?Us(u):window,t){case"focusin":(Hp(C)||C.contentEditable==="true")&&(Ms=C,dd=u,eo=null);break;case"focusout":eo=dd=Ms=null;break;case"mousedown":hd=!0;break;case"contextmenu":case"mouseup":case"dragend":hd=!1,Qp(h,n,d);break;case"selectionchange":if(oS)break;case"keydown":case"keyup":Qp(h,n,d)}var R;if(Rh)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Ls?Qy(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(Yy&&n.locale!=="ko"&&(Ls||T!=="onCompositionStart"?T==="onCompositionEnd"&&Ls&&(R=Ky()):(yr=d,Th="value"in yr?yr.value:yr.textContent,Ls=!0)),C=hl(u,T),0<C.length&&(T=new Bp(T,t,null,n,d),h.push({event:T,listeners:C}),R?T.data=R:(R=Jy(n),R!==null&&(T.data=R)))),(R=Kb?Yb(t,n):Qb(t,n))&&(u=hl(u,"onBeforeInput"),0<u.length&&(d=new Bp("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=R))}c0(h,e)})}function Eo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function hl(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=yo(t,n),i!=null&&r.unshift(Eo(t,i,s)),i=yo(t,e),i!=null&&r.push(Eo(t,i,s))),t=t.return}return r}function As(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Zp(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=yo(n,i),c!=null&&o.unshift(Eo(n,c,l))):s||(c=yo(n,i),c!=null&&o.push(Eo(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var uS=/\r\n?/g,dS=/\u0000|\uFFFD/g;function em(t){return(typeof t=="string"?t:""+t).replace(uS,`
`).replace(dS,"")}function ka(t,e,n){if(e=em(e),em(t)!==e&&n)throw Error(D(425))}function fl(){}var fd=null,pd=null;function md(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var gd=typeof setTimeout=="function"?setTimeout:void 0,hS=typeof clearTimeout=="function"?clearTimeout:void 0,tm=typeof Promise=="function"?Promise:void 0,fS=typeof queueMicrotask=="function"?queueMicrotask:typeof tm<"u"?function(t){return tm.resolve(null).then(t).catch(pS)}:gd;function pS(t){setTimeout(function(){throw t})}function fu(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wo(e)}function Er(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function nm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _i=Math.random().toString(36).slice(2),Sn="__reactFiber$"+_i,Io="__reactProps$"+_i,Kn="__reactContainer$"+_i,yd="__reactEvents$"+_i,mS="__reactListeners$"+_i,gS="__reactHandles$"+_i;function Qr(t){var e=t[Sn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Kn]||n[Sn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=nm(t);t!==null;){if(n=t[Sn])return n;t=nm(t)}return e}t=n,n=t.parentNode}return null}function Jo(t){return t=t[Sn]||t[Kn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Us(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(D(33))}function sc(t){return t[Io]||null}var vd=[],$s=-1;function Wr(t){return{current:t}}function Se(t){0>$s||(t.current=vd[$s],vd[$s]=null,$s--)}function _e(t,e){$s++,vd[$s]=t.current,t.current=e}var Or={},pt=Wr(Or),Rt=Wr(!1),as=Or;function ii(t,e){var n=t.type.contextTypes;if(!n)return Or;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function At(t){return t=t.childContextTypes,t!=null}function pl(){Se(Rt),Se(pt)}function rm(t,e,n){if(pt.current!==Or)throw Error(D(168));_e(pt,e),_e(Rt,n)}function d0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(D(108,eb(t)||"Unknown",s));return je({},n,r)}function ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Or,as=pt.current,_e(pt,t),_e(Rt,Rt.current),!0}function sm(t,e,n){var r=t.stateNode;if(!r)throw Error(D(169));n?(t=d0(t,e,as),r.__reactInternalMemoizedMergedChildContext=t,Se(Rt),Se(pt),_e(pt,t)):Se(Rt),_e(Rt,n)}var Fn=null,ic=!1,pu=!1;function h0(t){Fn===null?Fn=[t]:Fn.push(t)}function yS(t){ic=!0,h0(t)}function zr(){if(!pu&&Fn!==null){pu=!0;var t=0,e=de;try{var n=Fn;for(de=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fn=null,ic=!1}catch(s){throw Fn!==null&&(Fn=Fn.slice(t+1)),My(Eh,zr),s}finally{de=e,pu=!1}}return null}var Bs=[],Vs=0,gl=null,yl=0,Yt=[],Qt=0,ls=null,$n=1,Bn="";function Gr(t,e){Bs[Vs++]=yl,Bs[Vs++]=gl,gl=t,yl=e}function f0(t,e,n){Yt[Qt++]=$n,Yt[Qt++]=Bn,Yt[Qt++]=ls,ls=t;var r=$n;t=Bn;var s=32-pn(r)-1;r&=~(1<<s),n+=1;var i=32-pn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,$n=1<<32-pn(e)+s|n<<s|r,Bn=i+t}else $n=1<<i|n<<s|r,Bn=t}function Dh(t){t.return!==null&&(Gr(t,1),f0(t,1,0))}function jh(t){for(;t===gl;)gl=Bs[--Vs],Bs[Vs]=null,yl=Bs[--Vs],Bs[Vs]=null;for(;t===ls;)ls=Yt[--Qt],Yt[Qt]=null,Bn=Yt[--Qt],Yt[Qt]=null,$n=Yt[--Qt],Yt[Qt]=null}var $t=null,Ut=null,Ce=!1,dn=null;function p0(t,e){var n=Xt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function im(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$t=t,Ut=Er(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$t=t,Ut=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ls!==null?{id:$n,overflow:Bn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Xt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,$t=t,Ut=null,!0):!1;default:return!1}}function _d(t){return(t.mode&1)!==0&&(t.flags&128)===0}function wd(t){if(Ce){var e=Ut;if(e){var n=e;if(!im(t,e)){if(_d(t))throw Error(D(418));e=Er(n.nextSibling);var r=$t;e&&im(t,e)?p0(r,n):(t.flags=t.flags&-4097|2,Ce=!1,$t=t)}}else{if(_d(t))throw Error(D(418));t.flags=t.flags&-4097|2,Ce=!1,$t=t}}}function om(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$t=t}function Pa(t){if(t!==$t)return!1;if(!Ce)return om(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!md(t.type,t.memoizedProps)),e&&(e=Ut)){if(_d(t))throw m0(),Error(D(418));for(;e;)p0(t,e),e=Er(e.nextSibling)}if(om(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(D(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ut=Er(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ut=null}}else Ut=$t?Er(t.stateNode.nextSibling):null;return!0}function m0(){for(var t=Ut;t;)t=Er(t.nextSibling)}function oi(){Ut=$t=null,Ce=!1}function Oh(t){dn===null?dn=[t]:dn.push(t)}var vS=nr.ReactCurrentBatchConfig;function ji(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(D(309));var r=n.stateNode}if(!r)throw Error(D(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(D(284));if(!n._owner)throw Error(D(290,t))}return t}function Ra(t,e){throw t=Object.prototype.toString.call(e),Error(D(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function am(t){var e=t._init;return e(t._payload)}function g0(t){function e(m,p){if(t){var y=m.deletions;y===null?(m.deletions=[p],m.flags|=16):y.push(p)}}function n(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function r(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function s(m,p){return m=Tr(m,p),m.index=0,m.sibling=null,m}function i(m,p,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<p?(m.flags|=2,p):y):(m.flags|=2,p)):(m.flags|=1048576,p)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,p,y,b){return p===null||p.tag!==6?(p=xu(y,m.mode,b),p.return=m,p):(p=s(p,y),p.return=m,p)}function c(m,p,y,b){var P=y.type;return P===Os?d(m,p,y.props.children,b,y.key):p!==null&&(p.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===cr&&am(P)===p.type)?(b=s(p,y.props),b.ref=ji(m,p,y),b.return=m,b):(b=Za(y.type,y.key,y.props,null,m.mode,b),b.ref=ji(m,p,y),b.return=m,b)}function u(m,p,y,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=bu(y,m.mode,b),p.return=m,p):(p=s(p,y.children||[]),p.return=m,p)}function d(m,p,y,b,P){return p===null||p.tag!==7?(p=ss(y,m.mode,b,P),p.return=m,p):(p=s(p,y),p.return=m,p)}function h(m,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=xu(""+p,m.mode,y),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case wa:return y=Za(p.type,p.key,p.props,null,m.mode,y),y.ref=ji(m,null,p),y.return=m,y;case js:return p=bu(p,m.mode,y),p.return=m,p;case cr:var b=p._init;return h(m,b(p._payload),y)}if(Wi(p)||ki(p))return p=ss(p,m.mode,y,null),p.return=m,p;Ra(m,p)}return null}function f(m,p,y,b){var P=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return P!==null?null:l(m,p,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case wa:return y.key===P?c(m,p,y,b):null;case js:return y.key===P?u(m,p,y,b):null;case cr:return P=y._init,f(m,p,P(y._payload),b)}if(Wi(y)||ki(y))return P!==null?null:d(m,p,y,b,null);Ra(m,y)}return null}function g(m,p,y,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(y)||null,l(p,m,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case wa:return m=m.get(b.key===null?y:b.key)||null,c(p,m,b,P);case js:return m=m.get(b.key===null?y:b.key)||null,u(p,m,b,P);case cr:var C=b._init;return g(m,p,y,C(b._payload),P)}if(Wi(b)||ki(b))return m=m.get(y)||null,d(p,m,b,P,null);Ra(p,b)}return null}function _(m,p,y,b){for(var P=null,C=null,R=p,T=p=0,L=null;R!==null&&T<y.length;T++){R.index>T?(L=R,R=null):L=R.sibling;var w=f(m,R,y[T],b);if(w===null){R===null&&(R=L);break}t&&R&&w.alternate===null&&e(m,R),p=i(w,p,T),C===null?P=w:C.sibling=w,C=w,R=L}if(T===y.length)return n(m,R),Ce&&Gr(m,T),P;if(R===null){for(;T<y.length;T++)R=h(m,y[T],b),R!==null&&(p=i(R,p,T),C===null?P=R:C.sibling=R,C=R);return Ce&&Gr(m,T),P}for(R=r(m,R);T<y.length;T++)L=g(R,m,T,y[T],b),L!==null&&(t&&L.alternate!==null&&R.delete(L.key===null?T:L.key),p=i(L,p,T),C===null?P=L:C.sibling=L,C=L);return t&&R.forEach(function(S){return e(m,S)}),Ce&&Gr(m,T),P}function x(m,p,y,b){var P=ki(y);if(typeof P!="function")throw Error(D(150));if(y=P.call(y),y==null)throw Error(D(151));for(var C=P=null,R=p,T=p=0,L=null,w=y.next();R!==null&&!w.done;T++,w=y.next()){R.index>T?(L=R,R=null):L=R.sibling;var S=f(m,R,w.value,b);if(S===null){R===null&&(R=L);break}t&&R&&S.alternate===null&&e(m,R),p=i(S,p,T),C===null?P=S:C.sibling=S,C=S,R=L}if(w.done)return n(m,R),Ce&&Gr(m,T),P;if(R===null){for(;!w.done;T++,w=y.next())w=h(m,w.value,b),w!==null&&(p=i(w,p,T),C===null?P=w:C.sibling=w,C=w);return Ce&&Gr(m,T),P}for(R=r(m,R);!w.done;T++,w=y.next())w=g(R,m,T,w.value,b),w!==null&&(t&&w.alternate!==null&&R.delete(w.key===null?T:w.key),p=i(w,p,T),C===null?P=w:C.sibling=w,C=w);return t&&R.forEach(function(v){return e(m,v)}),Ce&&Gr(m,T),P}function M(m,p,y,b){if(typeof y=="object"&&y!==null&&y.type===Os&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case wa:e:{for(var P=y.key,C=p;C!==null;){if(C.key===P){if(P=y.type,P===Os){if(C.tag===7){n(m,C.sibling),p=s(C,y.props.children),p.return=m,m=p;break e}}else if(C.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===cr&&am(P)===C.type){n(m,C.sibling),p=s(C,y.props),p.ref=ji(m,C,y),p.return=m,m=p;break e}n(m,C);break}else e(m,C);C=C.sibling}y.type===Os?(p=ss(y.props.children,m.mode,b,y.key),p.return=m,m=p):(b=Za(y.type,y.key,y.props,null,m.mode,b),b.ref=ji(m,p,y),b.return=m,m=b)}return o(m);case js:e:{for(C=y.key;p!==null;){if(p.key===C)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(m,p.sibling),p=s(p,y.children||[]),p.return=m,m=p;break e}else{n(m,p);break}else e(m,p);p=p.sibling}p=bu(y,m.mode,b),p.return=m,m=p}return o(m);case cr:return C=y._init,M(m,p,C(y._payload),b)}if(Wi(y))return _(m,p,y,b);if(ki(y))return x(m,p,y,b);Ra(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(m,p.sibling),p=s(p,y),p.return=m,m=p):(n(m,p),p=xu(y,m.mode,b),p.return=m,m=p),o(m)):n(m,p)}return M}var ai=g0(!0),y0=g0(!1),vl=Wr(null),_l=null,Ws=null,Lh=null;function Mh(){Lh=Ws=_l=null}function Fh(t){var e=vl.current;Se(vl),t._currentValue=e}function xd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Qs(t,e){_l=t,Lh=Ws=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kt=!0),t.firstContext=null)}function rn(t){var e=t._currentValue;if(Lh!==t)if(t={context:t,memoizedValue:e,next:null},Ws===null){if(_l===null)throw Error(D(308));Ws=t,_l.dependencies={lanes:0,firstContext:t}}else Ws=Ws.next=t;return e}var Jr=null;function Uh(t){Jr===null?Jr=[t]:Jr.push(t)}function v0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Uh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Yn(t,r)}function Yn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ur=!1;function $h(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ir(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ae&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Yn(t,n)}return s=r.interleaved,s===null?(e.next=e,Uh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Yn(t,n)}function qa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ih(t,n)}}function lm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wl(t,e,n,r){var s=t.updateQueue;ur=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,g=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,x=l;switch(f=e,g=n,x.tag){case 1:if(_=x.payload,typeof _=="function"){h=_.call(g,h,f);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=x.payload,f=typeof _=="function"?_.call(g,h,f):_,f==null)break e;h=je({},h,f);break e;case 2:ur=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else g={eventTime:g,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=g,c=h):d=d.next=g,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);us|=o,t.lanes=o,t.memoizedState=h}}function cm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(D(191,s));s.call(r)}}}var Xo={},Cn=Wr(Xo),No=Wr(Xo),Co=Wr(Xo);function Xr(t){if(t===Xo)throw Error(D(174));return t}function Bh(t,e){switch(_e(Co,e),_e(No,t),_e(Cn,Xo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:td(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=td(e,t)}Se(Cn),_e(Cn,e)}function li(){Se(Cn),Se(No),Se(Co)}function w0(t){Xr(Co.current);var e=Xr(Cn.current),n=td(e,t.type);e!==n&&(_e(No,t),_e(Cn,n))}function Vh(t){No.current===t&&(Se(Cn),Se(No))}var Pe=Wr(0);function xl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mu=[];function Wh(){for(var t=0;t<mu.length;t++)mu[t]._workInProgressVersionPrimary=null;mu.length=0}var Ka=nr.ReactCurrentDispatcher,gu=nr.ReactCurrentBatchConfig,cs=0,De=null,He=null,Qe=null,bl=!1,to=!1,To=0,_S=0;function ut(){throw Error(D(321))}function zh(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!yn(t[n],e[n]))return!1;return!0}function Hh(t,e,n,r,s,i){if(cs=i,De=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ka.current=t===null||t.memoizedState===null?SS:ES,t=n(r,s),to){i=0;do{if(to=!1,To=0,25<=i)throw Error(D(301));i+=1,Qe=He=null,e.updateQueue=null,Ka.current=IS,t=n(r,s)}while(to)}if(Ka.current=Sl,e=He!==null&&He.next!==null,cs=0,Qe=He=De=null,bl=!1,e)throw Error(D(300));return t}function Gh(){var t=To!==0;return To=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qe===null?De.memoizedState=Qe=t:Qe=Qe.next=t,Qe}function sn(){if(He===null){var t=De.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var e=Qe===null?De.memoizedState:Qe.next;if(e!==null)Qe=e,He=t;else{if(t===null)throw Error(D(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Qe===null?De.memoizedState=Qe=t:Qe=Qe.next=t}return Qe}function ko(t,e){return typeof e=="function"?e(t):e}function yu(t){var e=sn(),n=e.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=t;var r=He,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((cs&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,De.lanes|=d,us|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,yn(r,e.memoizedState)||(kt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,De.lanes|=i,us|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vu(t){var e=sn(),n=e.queue;if(n===null)throw Error(D(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);yn(i,e.memoizedState)||(kt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function x0(){}function b0(t,e){var n=De,r=sn(),s=e(),i=!yn(r.memoizedState,s);if(i&&(r.memoizedState=s,kt=!0),r=r.queue,qh(I0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Qe!==null&&Qe.memoizedState.tag&1){if(n.flags|=2048,Po(9,E0.bind(null,n,r,s,e),void 0,null),Ze===null)throw Error(D(349));cs&30||S0(n,e,s)}return s}function S0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function E0(t,e,n,r){e.value=n,e.getSnapshot=r,N0(e)&&C0(t)}function I0(t,e,n){return n(function(){N0(e)&&C0(t)})}function N0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!yn(t,n)}catch{return!0}}function C0(t){var e=Yn(t,1);e!==null&&mn(e,t,1,-1)}function um(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ko,lastRenderedState:t},e.queue=t,t=t.dispatch=bS.bind(null,De,t),[e.memoizedState,t]}function Po(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=De.updateQueue,e===null?(e={lastEffect:null,stores:null},De.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function T0(){return sn().memoizedState}function Ya(t,e,n,r){var s=bn();De.flags|=t,s.memoizedState=Po(1|e,n,void 0,r===void 0?null:r)}function oc(t,e,n,r){var s=sn();r=r===void 0?null:r;var i=void 0;if(He!==null){var o=He.memoizedState;if(i=o.destroy,r!==null&&zh(r,o.deps)){s.memoizedState=Po(e,n,i,r);return}}De.flags|=t,s.memoizedState=Po(1|e,n,i,r)}function dm(t,e){return Ya(8390656,8,t,e)}function qh(t,e){return oc(2048,8,t,e)}function k0(t,e){return oc(4,2,t,e)}function P0(t,e){return oc(4,4,t,e)}function R0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function A0(t,e,n){return n=n!=null?n.concat([t]):null,oc(4,4,R0.bind(null,e,t),n)}function Kh(){}function D0(t,e){var n=sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zh(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function j0(t,e){var n=sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&zh(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function O0(t,e,n){return cs&21?(yn(n,e)||(n=$y(),De.lanes|=n,us|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kt=!0),t.memoizedState=n)}function wS(t,e){var n=de;de=n!==0&&4>n?n:4,t(!0);var r=gu.transition;gu.transition={};try{t(!1),e()}finally{de=n,gu.transition=r}}function L0(){return sn().memoizedState}function xS(t,e,n){var r=Cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},M0(t))F0(e,n);else if(n=v0(t,e,n,r),n!==null){var s=vt();mn(n,t,r,s),U0(n,e,r)}}function bS(t,e,n){var r=Cr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(M0(t))F0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,yn(l,o)){var c=e.interleaved;c===null?(s.next=s,Uh(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=v0(t,e,s,r),n!==null&&(s=vt(),mn(n,t,r,s),U0(n,e,r))}}function M0(t){var e=t.alternate;return t===De||e!==null&&e===De}function F0(t,e){to=bl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function U0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ih(t,n)}}var Sl={readContext:rn,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},SS={readContext:rn,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:rn,useEffect:dm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ya(4194308,4,R0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ya(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ya(4,2,t,e)},useMemo:function(t,e){var n=bn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=bn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=xS.bind(null,De,t),[r.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:um,useDebugValue:Kh,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=um(!1),e=t[0];return t=wS.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=De,s=bn();if(Ce){if(n===void 0)throw Error(D(407));n=n()}else{if(n=e(),Ze===null)throw Error(D(349));cs&30||S0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,dm(I0.bind(null,r,i,t),[t]),r.flags|=2048,Po(9,E0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=bn(),e=Ze.identifierPrefix;if(Ce){var n=Bn,r=$n;n=(r&~(1<<32-pn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=To++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_S++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ES={readContext:rn,useCallback:D0,useContext:rn,useEffect:qh,useImperativeHandle:A0,useInsertionEffect:k0,useLayoutEffect:P0,useMemo:j0,useReducer:yu,useRef:T0,useState:function(){return yu(ko)},useDebugValue:Kh,useDeferredValue:function(t){var e=sn();return O0(e,He.memoizedState,t)},useTransition:function(){var t=yu(ko)[0],e=sn().memoizedState;return[t,e]},useMutableSource:x0,useSyncExternalStore:b0,useId:L0,unstable_isNewReconciler:!1},IS={readContext:rn,useCallback:D0,useContext:rn,useEffect:qh,useImperativeHandle:A0,useInsertionEffect:k0,useLayoutEffect:P0,useMemo:j0,useReducer:vu,useRef:T0,useState:function(){return vu(ko)},useDebugValue:Kh,useDeferredValue:function(t){var e=sn();return He===null?e.memoizedState=t:O0(e,He.memoizedState,t)},useTransition:function(){var t=vu(ko)[0],e=sn().memoizedState;return[t,e]},useMutableSource:x0,useSyncExternalStore:b0,useId:L0,unstable_isNewReconciler:!1};function cn(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ac={isMounted:function(t){return(t=t._reactInternals)?ws(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vt(),s=Cr(t),i=Hn(r,s);i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(mn(e,t,s,r),qa(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vt(),s=Cr(t),i=Hn(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ir(t,i,s),e!==null&&(mn(e,t,s,r),qa(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vt(),r=Cr(t),s=Hn(n,r);s.tag=2,e!=null&&(s.callback=e),e=Ir(t,s,r),e!==null&&(mn(e,t,r,n),qa(e,t,r))}};function hm(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!bo(n,r)||!bo(s,i):!0}function $0(t,e,n){var r=!1,s=Or,i=e.contextType;return typeof i=="object"&&i!==null?i=rn(i):(s=At(e)?as:pt.current,r=e.contextTypes,i=(r=r!=null)?ii(t,s):Or),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ac,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function fm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ac.enqueueReplaceState(e,e.state,null)}function Sd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$h(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=rn(i):(i=At(e)?as:pt.current,s.context=ii(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(bd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ac.enqueueReplaceState(s,s.state,null),wl(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ci(t,e){try{var n="",r=e;do n+=Zx(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function _u(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ed(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var NS=typeof WeakMap=="function"?WeakMap:Map;function B0(t,e,n){n=Hn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Il||(Il=!0,jd=r),Ed(t,e)},n}function V0(t,e,n){n=Hn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ed(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ed(t,e),typeof r!="function"&&(Nr===null?Nr=new Set([this]):Nr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new NS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=$S.bind(null,t,e,n),e.then(t,t))}function mm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function gm(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Hn(-1,1),e.tag=2,Ir(n,e,1))),n.lanes|=1),t)}var CS=nr.ReactCurrentOwner,kt=!1;function gt(t,e,n,r){e.child=t===null?y0(e,null,n,r):ai(e,t.child,n,r)}function ym(t,e,n,r,s){n=n.render;var i=e.ref;return Qs(e,s),r=Hh(t,e,n,r,i,s),n=Gh(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qn(t,e,s)):(Ce&&n&&Dh(e),e.flags|=1,gt(t,e,r,s),e.child)}function vm(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!nf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,W0(t,e,i,r,s)):(t=Za(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:bo,n(o,r)&&t.ref===e.ref)return Qn(t,e,s)}return e.flags|=1,t=Tr(i,r),t.ref=e.ref,t.return=e,e.child=t}function W0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(bo(i,r)&&t.ref===e.ref)if(kt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(kt=!0);else return e.lanes=t.lanes,Qn(t,e,s)}return Id(t,e,n,r,s)}function z0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Hs,Mt),Mt|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Hs,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,_e(Hs,Mt),Mt|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,_e(Hs,Mt),Mt|=r;return gt(t,e,s,n),e.child}function H0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Id(t,e,n,r,s){var i=At(n)?as:pt.current;return i=ii(e,i),Qs(e,s),n=Hh(t,e,n,r,i,s),r=Gh(),t!==null&&!kt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Qn(t,e,s)):(Ce&&r&&Dh(e),e.flags|=1,gt(t,e,n,s),e.child)}function _m(t,e,n,r,s){if(At(n)){var i=!0;ml(e)}else i=!1;if(Qs(e,s),e.stateNode===null)Qa(t,e),$0(e,n,r),Sd(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=rn(u):(u=At(n)?as:pt.current,u=ii(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&fm(e,o,r,u),ur=!1;var f=e.memoizedState;o.state=f,wl(e,r,o,s),c=e.memoizedState,l!==r||f!==c||Rt.current||ur?(typeof d=="function"&&(bd(e,n,d,r),c=e.memoizedState),(l=ur||hm(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,_0(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:cn(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=rn(c):(c=At(n)?as:pt.current,c=ii(e,c));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&fm(e,o,r,c),ur=!1,f=e.memoizedState,o.state=f,wl(e,r,o,s);var _=e.memoizedState;l!==h||f!==_||Rt.current||ur?(typeof g=="function"&&(bd(e,n,g,r),_=e.memoizedState),(u=ur||hm(e,n,u,r,f,_,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Nd(t,e,n,r,i,s)}function Nd(t,e,n,r,s,i){H0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&sm(e,n,!1),Qn(t,e,i);r=e.stateNode,CS.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ai(e,t.child,null,i),e.child=ai(e,null,l,i)):gt(t,e,l,i),e.memoizedState=r.state,s&&sm(e,n,!0),e.child}function G0(t){var e=t.stateNode;e.pendingContext?rm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&rm(t,e.context,!1),Bh(t,e.containerInfo)}function wm(t,e,n,r,s){return oi(),Oh(s),e.flags|=256,gt(t,e,n,r),e.child}var Cd={dehydrated:null,treeContext:null,retryLane:0};function Td(t){return{baseLanes:t,cachePool:null,transitions:null}}function q0(t,e,n){var r=e.pendingProps,s=Pe.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_e(Pe,s&1),t===null)return wd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=uc(o,r,0,null),t=ss(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Td(n),e.memoizedState=Cd,t):Yh(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return TS(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Tr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Tr(l,i):(i=ss(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Td(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Cd,r}return i=t.child,t=i.sibling,r=Tr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Yh(t,e){return e=uc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Aa(t,e,n,r){return r!==null&&Oh(r),ai(e,t.child,null,n),t=Yh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function TS(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=_u(Error(D(422))),Aa(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=uc({mode:"visible",children:r.children},s,0,null),i=ss(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ai(e,t.child,null,o),e.child.memoizedState=Td(o),e.memoizedState=Cd,i);if(!(e.mode&1))return Aa(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(D(419)),r=_u(i,r,void 0),Aa(t,e,o,r)}if(l=(o&t.childLanes)!==0,kt||l){if(r=Ze,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Yn(t,s),mn(r,t,s,-1))}return tf(),r=_u(Error(D(421))),Aa(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=BS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ut=Er(s.nextSibling),$t=e,Ce=!0,dn=null,t!==null&&(Yt[Qt++]=$n,Yt[Qt++]=Bn,Yt[Qt++]=ls,$n=t.id,Bn=t.overflow,ls=e),e=Yh(e,r.children),e.flags|=4096,e)}function xm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xd(t.return,e,n)}function wu(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function K0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(gt(t,e,r.children,n),r=Pe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xm(t,n,e);else if(t.tag===19)xm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Pe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&xl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),wu(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&xl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}wu(e,!0,n,null,i);break;case"together":wu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),us|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(D(153));if(e.child!==null){for(t=e.child,n=Tr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Tr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function kS(t,e,n){switch(e.tag){case 3:G0(e),oi();break;case 5:w0(e);break;case 1:At(e.type)&&ml(e);break;case 4:Bh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;_e(vl,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Pe,Pe.current&1),e.flags|=128,null):n&e.child.childLanes?q0(t,e,n):(_e(Pe,Pe.current&1),t=Qn(t,e,n),t!==null?t.sibling:null);_e(Pe,Pe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return K0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_e(Pe,Pe.current),r)break;return null;case 22:case 23:return e.lanes=0,z0(t,e,n)}return Qn(t,e,n)}var Y0,kd,Q0,J0;Y0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};kd=function(){};Q0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Xr(Cn.current);var i=null;switch(n){case"input":s=Ju(t,s),r=Ju(t,r),i=[];break;case"select":s=je({},s,{value:void 0}),r=je({},r,{value:void 0}),i=[];break;case"textarea":s=ed(t,s),r=ed(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=fl)}nd(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(mo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(mo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&be("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};J0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Oi(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function dt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PS(t,e,n){var r=e.pendingProps;switch(jh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(e),null;case 1:return At(e.type)&&pl(),dt(e),null;case 3:return r=e.stateNode,li(),Se(Rt),Se(pt),Wh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Pa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,dn!==null&&(Md(dn),dn=null))),kd(t,e),dt(e),null;case 5:Vh(e);var s=Xr(Co.current);if(n=e.type,t!==null&&e.stateNode!=null)Q0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(D(166));return dt(e),null}if(t=Xr(Cn.current),Pa(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Sn]=e,r[Io]=i,t=(e.mode&1)!==0,n){case"dialog":be("cancel",r),be("close",r);break;case"iframe":case"object":case"embed":be("load",r);break;case"video":case"audio":for(s=0;s<Hi.length;s++)be(Hi[s],r);break;case"source":be("error",r);break;case"img":case"image":case"link":be("error",r),be("load",r);break;case"details":be("toggle",r);break;case"input":Pp(r,i),be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},be("invalid",r);break;case"textarea":Ap(r,i),be("invalid",r)}nd(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ka(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ka(r.textContent,l,t),s=["children",""+l]):mo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&be("scroll",r)}switch(n){case"input":xa(r),Rp(r,i,!0);break;case"textarea":xa(r),Dp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=fl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Iy(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Sn]=e,t[Io]=r,Y0(t,e,!1,!1),e.stateNode=t;e:{switch(o=rd(n,r),n){case"dialog":be("cancel",t),be("close",t),s=r;break;case"iframe":case"object":case"embed":be("load",t),s=r;break;case"video":case"audio":for(s=0;s<Hi.length;s++)be(Hi[s],t);s=r;break;case"source":be("error",t),s=r;break;case"img":case"image":case"link":be("error",t),be("load",t),s=r;break;case"details":be("toggle",t),s=r;break;case"input":Pp(t,r),s=Ju(t,r),be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=je({},r,{value:void 0}),be("invalid",t);break;case"textarea":Ap(t,r),s=ed(t,r),be("invalid",t);break;default:s=r}nd(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Ty(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ny(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&go(t,c):typeof c=="number"&&go(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(mo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&be("scroll",t):c!=null&&_h(t,i,c,o))}switch(n){case"input":xa(t),Rp(t,r,!1);break;case"textarea":xa(t),Dp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+jr(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Gs(t,!!r.multiple,i,!1):r.defaultValue!=null&&Gs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=fl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dt(e),null;case 6:if(t&&e.stateNode!=null)J0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(D(166));if(n=Xr(Co.current),Xr(Cn.current),Pa(e)){if(r=e.stateNode,n=e.memoizedProps,r[Sn]=e,(i=r.nodeValue!==n)&&(t=$t,t!==null))switch(t.tag){case 3:ka(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ka(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sn]=e,e.stateNode=r}return dt(e),null;case 13:if(Se(Pe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&Ut!==null&&e.mode&1&&!(e.flags&128))m0(),oi(),e.flags|=98560,i=!1;else if(i=Pa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(D(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(D(317));i[Sn]=e}else oi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dt(e),i=!1}else dn!==null&&(Md(dn),dn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Pe.current&1?qe===0&&(qe=3):tf())),e.updateQueue!==null&&(e.flags|=4),dt(e),null);case 4:return li(),kd(t,e),t===null&&So(e.stateNode.containerInfo),dt(e),null;case 10:return Fh(e.type._context),dt(e),null;case 17:return At(e.type)&&pl(),dt(e),null;case 19:if(Se(Pe),i=e.memoizedState,i===null)return dt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Oi(i,!1);else{if(qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=xl(t),o!==null){for(e.flags|=128,Oi(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _e(Pe,Pe.current&1|2),e.child}t=t.sibling}i.tail!==null&&$e()>ui&&(e.flags|=128,r=!0,Oi(i,!1),e.lanes=4194304)}else{if(!r)if(t=xl(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Oi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ce)return dt(e),null}else 2*$e()-i.renderingStartTime>ui&&n!==1073741824&&(e.flags|=128,r=!0,Oi(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$e(),e.sibling=null,n=Pe.current,_e(Pe,r?n&1|2:n&1),e):(dt(e),null);case 22:case 23:return ef(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(dt(e),e.subtreeFlags&6&&(e.flags|=8192)):dt(e),null;case 24:return null;case 25:return null}throw Error(D(156,e.tag))}function RS(t,e){switch(jh(e),e.tag){case 1:return At(e.type)&&pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return li(),Se(Rt),Se(pt),Wh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Vh(e),null;case 13:if(Se(Pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(D(340));oi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Se(Pe),null;case 4:return li(),null;case 10:return Fh(e.type._context),null;case 22:case 23:return ef(),null;case 24:return null;default:return null}}var Da=!1,ht=!1,AS=typeof WeakSet=="function"?WeakSet:Set,z=null;function zs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Me(t,e,r)}else n.current=null}function Pd(t,e,n){try{n()}catch(r){Me(t,e,r)}}var bm=!1;function DS(t,e){if(fd=ul,t=n0(),Ah(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var g;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(pd={focusedElem:t,selectionRange:n},ul=!1,z=e;z!==null;)if(e=z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,z=t;else for(;z!==null;){e=z;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var x=_.memoizedProps,M=_.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?x:cn(e.type,x),M);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(b){Me(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,z=t;break}z=e.return}return _=bm,bm=!1,_}function no(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Pd(e,n,i)}s=s.next}while(s!==r)}}function lc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Rd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function X0(t){var e=t.alternate;e!==null&&(t.alternate=null,X0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sn],delete e[Io],delete e[yd],delete e[mS],delete e[gS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Z0(t){return t.tag===5||t.tag===3||t.tag===4}function Sm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Z0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ad(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=fl));else if(r!==4&&(t=t.child,t!==null))for(Ad(t,e,n),t=t.sibling;t!==null;)Ad(t,e,n),t=t.sibling}function Dd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Dd(t,e,n),t=t.sibling;t!==null;)Dd(t,e,n),t=t.sibling}var rt=null,un=!1;function ar(t,e,n){for(n=n.child;n!==null;)ev(t,e,n),n=n.sibling}function ev(t,e,n){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(ec,n)}catch{}switch(n.tag){case 5:ht||zs(n,e);case 6:var r=rt,s=un;rt=null,ar(t,e,n),rt=r,un=s,rt!==null&&(un?(t=rt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rt.removeChild(n.stateNode));break;case 18:rt!==null&&(un?(t=rt,n=n.stateNode,t.nodeType===8?fu(t.parentNode,n):t.nodeType===1&&fu(t,n),wo(t)):fu(rt,n.stateNode));break;case 4:r=rt,s=un,rt=n.stateNode.containerInfo,un=!0,ar(t,e,n),rt=r,un=s;break;case 0:case 11:case 14:case 15:if(!ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Pd(n,e,o),s=s.next}while(s!==r)}ar(t,e,n);break;case 1:if(!ht&&(zs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Me(n,e,l)}ar(t,e,n);break;case 21:ar(t,e,n);break;case 22:n.mode&1?(ht=(r=ht)||n.memoizedState!==null,ar(t,e,n),ht=r):ar(t,e,n);break;default:ar(t,e,n)}}function Em(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new AS),e.forEach(function(r){var s=VS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ln(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:rt=l.stateNode,un=!1;break e;case 3:rt=l.stateNode.containerInfo,un=!0;break e;case 4:rt=l.stateNode.containerInfo,un=!0;break e}l=l.return}if(rt===null)throw Error(D(160));ev(i,o,s),rt=null,un=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Me(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)tv(e,t),e=e.sibling}function tv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ln(e,t),xn(t),r&4){try{no(3,t,t.return),lc(3,t)}catch(x){Me(t,t.return,x)}try{no(5,t,t.return)}catch(x){Me(t,t.return,x)}}break;case 1:ln(e,t),xn(t),r&512&&n!==null&&zs(n,n.return);break;case 5:if(ln(e,t),xn(t),r&512&&n!==null&&zs(n,n.return),t.flags&32){var s=t.stateNode;try{go(s,"")}catch(x){Me(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sy(s,i),rd(l,o);var u=rd(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Ty(s,h):d==="dangerouslySetInnerHTML"?Ny(s,h):d==="children"?go(s,h):_h(s,d,h,u)}switch(l){case"input":Xu(s,i);break;case"textarea":Ey(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Gs(s,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Gs(s,!!i.multiple,i.defaultValue,!0):Gs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Io]=i}catch(x){Me(t,t.return,x)}}break;case 6:if(ln(e,t),xn(t),r&4){if(t.stateNode===null)throw Error(D(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Me(t,t.return,x)}}break;case 3:if(ln(e,t),xn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wo(e.containerInfo)}catch(x){Me(t,t.return,x)}break;case 4:ln(e,t),xn(t);break;case 13:ln(e,t),xn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Xh=$e())),r&4&&Em(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ht=(u=ht)||d,ln(e,t),ht=u):ln(e,t),xn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(z=t,d=t.child;d!==null;){for(h=z=d;z!==null;){switch(f=z,g=f.child,f.tag){case 0:case 11:case 14:case 15:no(4,f,f.return);break;case 1:zs(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(x){Me(r,n,x)}}break;case 5:zs(f,f.return);break;case 22:if(f.memoizedState!==null){Nm(h);continue}}g!==null?(g.return=f,z=g):Nm(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Cy("display",o))}catch(x){Me(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Me(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ln(e,t),xn(t),r&4&&Em(t);break;case 21:break;default:ln(e,t),xn(t)}}function xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Z0(n)){var r=n;break e}n=n.return}throw Error(D(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(go(s,""),r.flags&=-33);var i=Sm(t);Dd(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Sm(t);Ad(t,l,o);break;default:throw Error(D(161))}}catch(c){Me(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function jS(t,e,n){z=t,nv(t)}function nv(t,e,n){for(var r=(t.mode&1)!==0;z!==null;){var s=z,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Da;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||ht;l=Da;var u=ht;if(Da=o,(ht=c)&&!u)for(z=s;z!==null;)o=z,c=o.child,o.tag===22&&o.memoizedState!==null?Cm(s):c!==null?(c.return=o,z=c):Cm(s);for(;i!==null;)z=i,nv(i),i=i.sibling;z=s,Da=l,ht=u}Im(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,z=i):Im(t)}}function Im(t){for(;z!==null;){var e=z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ht||lc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ht)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:cn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&cm(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}cm(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&wo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}ht||e.flags&512&&Rd(e)}catch(f){Me(e,e.return,f)}}if(e===t){z=null;break}if(n=e.sibling,n!==null){n.return=e.return,z=n;break}z=e.return}}function Nm(t){for(;z!==null;){var e=z;if(e===t){z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,z=n;break}z=e.return}}function Cm(t){for(;z!==null;){var e=z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lc(4,e)}catch(c){Me(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Me(e,s,c)}}var i=e.return;try{Rd(e)}catch(c){Me(e,i,c)}break;case 5:var o=e.return;try{Rd(e)}catch(c){Me(e,o,c)}}}catch(c){Me(e,e.return,c)}if(e===t){z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,z=l;break}z=e.return}}var OS=Math.ceil,El=nr.ReactCurrentDispatcher,Qh=nr.ReactCurrentOwner,en=nr.ReactCurrentBatchConfig,ae=0,Ze=null,Ve=null,st=0,Mt=0,Hs=Wr(0),qe=0,Ro=null,us=0,cc=0,Jh=0,ro=null,Tt=null,Xh=0,ui=1/0,Mn=null,Il=!1,jd=null,Nr=null,ja=!1,vr=null,Nl=0,so=0,Od=null,Ja=-1,Xa=0;function vt(){return ae&6?$e():Ja!==-1?Ja:Ja=$e()}function Cr(t){return t.mode&1?ae&2&&st!==0?st&-st:vS.transition!==null?(Xa===0&&(Xa=$y()),Xa):(t=de,t!==0||(t=window.event,t=t===void 0?16:qy(t.type)),t):1}function mn(t,e,n,r){if(50<so)throw so=0,Od=null,Error(D(185));Yo(t,n,r),(!(ae&2)||t!==Ze)&&(t===Ze&&(!(ae&2)&&(cc|=n),qe===4&&fr(t,st)),Dt(t,r),n===1&&ae===0&&!(e.mode&1)&&(ui=$e()+500,ic&&zr()))}function Dt(t,e){var n=t.callbackNode;vb(t,e);var r=cl(t,t===Ze?st:0);if(r===0)n!==null&&Lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Lp(n),e===1)t.tag===0?yS(Tm.bind(null,t)):h0(Tm.bind(null,t)),fS(function(){!(ae&6)&&zr()}),n=null;else{switch(By(r)){case 1:n=Eh;break;case 4:n=Fy;break;case 16:n=ll;break;case 536870912:n=Uy;break;default:n=ll}n=uv(n,rv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function rv(t,e){if(Ja=-1,Xa=0,ae&6)throw Error(D(327));var n=t.callbackNode;if(Js()&&t.callbackNode!==n)return null;var r=cl(t,t===Ze?st:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Cl(t,r);else{e=r;var s=ae;ae|=2;var i=iv();(Ze!==t||st!==e)&&(Mn=null,ui=$e()+500,rs(t,e));do try{FS();break}catch(l){sv(t,l)}while(1);Mh(),El.current=i,ae=s,Ve!==null?e=0:(Ze=null,st=0,e=qe)}if(e!==0){if(e===2&&(s=ld(t),s!==0&&(r=s,e=Ld(t,s))),e===1)throw n=Ro,rs(t,0),fr(t,r),Dt(t,$e()),n;if(e===6)fr(t,r);else{if(s=t.current.alternate,!(r&30)&&!LS(s)&&(e=Cl(t,r),e===2&&(i=ld(t),i!==0&&(r=i,e=Ld(t,i))),e===1))throw n=Ro,rs(t,0),fr(t,r),Dt(t,$e()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(D(345));case 2:qr(t,Tt,Mn);break;case 3:if(fr(t,r),(r&130023424)===r&&(e=Xh+500-$e(),10<e)){if(cl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){vt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=gd(qr.bind(null,t,Tt,Mn),e);break}qr(t,Tt,Mn);break;case 4:if(fr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-pn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=$e()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*OS(r/1960))-r,10<r){t.timeoutHandle=gd(qr.bind(null,t,Tt,Mn),r);break}qr(t,Tt,Mn);break;case 5:qr(t,Tt,Mn);break;default:throw Error(D(329))}}}return Dt(t,$e()),t.callbackNode===n?rv.bind(null,t):null}function Ld(t,e){var n=ro;return t.current.memoizedState.isDehydrated&&(rs(t,e).flags|=256),t=Cl(t,e),t!==2&&(e=Tt,Tt=n,e!==null&&Md(e)),t}function Md(t){Tt===null?Tt=t:Tt.push.apply(Tt,t)}function LS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!yn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fr(t,e){for(e&=~Jh,e&=~cc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-pn(e),r=1<<n;t[n]=-1,e&=~r}}function Tm(t){if(ae&6)throw Error(D(327));Js();var e=cl(t,0);if(!(e&1))return Dt(t,$e()),null;var n=Cl(t,e);if(t.tag!==0&&n===2){var r=ld(t);r!==0&&(e=r,n=Ld(t,r))}if(n===1)throw n=Ro,rs(t,0),fr(t,e),Dt(t,$e()),n;if(n===6)throw Error(D(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,qr(t,Tt,Mn),Dt(t,$e()),null}function Zh(t,e){var n=ae;ae|=1;try{return t(e)}finally{ae=n,ae===0&&(ui=$e()+500,ic&&zr())}}function ds(t){vr!==null&&vr.tag===0&&!(ae&6)&&Js();var e=ae;ae|=1;var n=en.transition,r=de;try{if(en.transition=null,de=1,t)return t()}finally{de=r,en.transition=n,ae=e,!(ae&6)&&zr()}}function ef(){Mt=Hs.current,Se(Hs)}function rs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hS(n)),Ve!==null)for(n=Ve.return;n!==null;){var r=n;switch(jh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&pl();break;case 3:li(),Se(Rt),Se(pt),Wh();break;case 5:Vh(r);break;case 4:li();break;case 13:Se(Pe);break;case 19:Se(Pe);break;case 10:Fh(r.type._context);break;case 22:case 23:ef()}n=n.return}if(Ze=t,Ve=t=Tr(t.current,null),st=Mt=e,qe=0,Ro=null,Jh=cc=us=0,Tt=ro=null,Jr!==null){for(e=0;e<Jr.length;e++)if(n=Jr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Jr=null}return t}function sv(t,e){do{var n=Ve;try{if(Mh(),Ka.current=Sl,bl){for(var r=De.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}bl=!1}if(cs=0,Qe=He=De=null,to=!1,To=0,Qh.current=null,n===null||n.return===null){qe=1,Ro=e,Ve=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=st,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=mm(o);if(g!==null){g.flags&=-257,gm(g,o,l,i,e),g.mode&1&&pm(i,u,e),e=g,c=u;var _=e.updateQueue;if(_===null){var x=new Set;x.add(c),e.updateQueue=x}else _.add(c);break e}else{if(!(e&1)){pm(i,u,e),tf();break e}c=Error(D(426))}}else if(Ce&&l.mode&1){var M=mm(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),gm(M,o,l,i,e),Oh(ci(c,l));break e}}i=c=ci(c,l),qe!==4&&(qe=2),ro===null?ro=[i]:ro.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=B0(i,c,e);lm(i,m);break e;case 1:l=c;var p=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Nr===null||!Nr.has(y)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=V0(i,l,e);lm(i,b);break e}}i=i.return}while(i!==null)}av(n)}catch(P){e=P,Ve===n&&n!==null&&(Ve=n=n.return);continue}break}while(1)}function iv(){var t=El.current;return El.current=Sl,t===null?Sl:t}function tf(){(qe===0||qe===3||qe===2)&&(qe=4),Ze===null||!(us&268435455)&&!(cc&268435455)||fr(Ze,st)}function Cl(t,e){var n=ae;ae|=2;var r=iv();(Ze!==t||st!==e)&&(Mn=null,rs(t,e));do try{MS();break}catch(s){sv(t,s)}while(1);if(Mh(),ae=n,El.current=r,Ve!==null)throw Error(D(261));return Ze=null,st=0,qe}function MS(){for(;Ve!==null;)ov(Ve)}function FS(){for(;Ve!==null&&!cb();)ov(Ve)}function ov(t){var e=cv(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?av(t):Ve=e,Qh.current=null}function av(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=RS(n,e),n!==null){n.flags&=32767,Ve=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{qe=6,Ve=null;return}}else if(n=PS(n,e,Mt),n!==null){Ve=n;return}if(e=e.sibling,e!==null){Ve=e;return}Ve=e=t}while(e!==null);qe===0&&(qe=5)}function qr(t,e,n){var r=de,s=en.transition;try{en.transition=null,de=1,US(t,e,n,r)}finally{en.transition=s,de=r}return null}function US(t,e,n,r){do Js();while(vr!==null);if(ae&6)throw Error(D(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(D(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(_b(t,i),t===Ze&&(Ve=Ze=null,st=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ja||(ja=!0,uv(ll,function(){return Js(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=en.transition,en.transition=null;var o=de;de=1;var l=ae;ae|=4,Qh.current=null,DS(t,n),tv(n,t),iS(pd),ul=!!fd,pd=fd=null,t.current=n,jS(n),ub(),ae=l,de=o,en.transition=i}else t.current=n;if(ja&&(ja=!1,vr=t,Nl=s),i=t.pendingLanes,i===0&&(Nr=null),fb(n.stateNode),Dt(t,$e()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Il)throw Il=!1,t=jd,jd=null,t;return Nl&1&&t.tag!==0&&Js(),i=t.pendingLanes,i&1?t===Od?so++:(so=0,Od=t):so=0,zr(),null}function Js(){if(vr!==null){var t=By(Nl),e=en.transition,n=de;try{if(en.transition=null,de=16>t?16:t,vr===null)var r=!1;else{if(t=vr,vr=null,Nl=0,ae&6)throw Error(D(331));var s=ae;for(ae|=4,z=t.current;z!==null;){var i=z,o=i.child;if(z.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(z=u;z!==null;){var d=z;switch(d.tag){case 0:case 11:case 15:no(8,d,i)}var h=d.child;if(h!==null)h.return=d,z=h;else for(;z!==null;){d=z;var f=d.sibling,g=d.return;if(X0(d),d===u){z=null;break}if(f!==null){f.return=g,z=f;break}z=g}}}var _=i.alternate;if(_!==null){var x=_.child;if(x!==null){_.child=null;do{var M=x.sibling;x.sibling=null,x=M}while(x!==null)}}z=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,z=o;else e:for(;z!==null;){if(i=z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:no(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,z=m;break e}z=i.return}}var p=t.current;for(z=p;z!==null;){o=z;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,z=y;else e:for(o=p;z!==null;){if(l=z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lc(9,l)}}catch(P){Me(l,l.return,P)}if(l===o){z=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,z=b;break e}z=l.return}}if(ae=s,zr(),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(ec,t)}catch{}r=!0}return r}finally{de=n,en.transition=e}}return!1}function km(t,e,n){e=ci(n,e),e=B0(t,e,1),t=Ir(t,e,1),e=vt(),t!==null&&(Yo(t,1,e),Dt(t,e))}function Me(t,e,n){if(t.tag===3)km(t,t,n);else for(;e!==null;){if(e.tag===3){km(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Nr===null||!Nr.has(r))){t=ci(n,t),t=V0(e,t,1),e=Ir(e,t,1),t=vt(),e!==null&&(Yo(e,1,t),Dt(e,t));break}}e=e.return}}function $S(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vt(),t.pingedLanes|=t.suspendedLanes&n,Ze===t&&(st&n)===n&&(qe===4||qe===3&&(st&130023424)===st&&500>$e()-Xh?rs(t,0):Jh|=n),Dt(t,e)}function lv(t,e){e===0&&(t.mode&1?(e=Ea,Ea<<=1,!(Ea&130023424)&&(Ea=4194304)):e=1);var n=vt();t=Yn(t,e),t!==null&&(Yo(t,e,n),Dt(t,n))}function BS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),lv(t,n)}function VS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(D(314))}r!==null&&r.delete(e),lv(t,n)}var cv;cv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Rt.current)kt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return kt=!1,kS(t,e,n);kt=!!(t.flags&131072)}else kt=!1,Ce&&e.flags&1048576&&f0(e,yl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qa(t,e),t=e.pendingProps;var s=ii(e,pt.current);Qs(e,n),s=Hh(null,e,r,t,s,n);var i=Gh();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,At(r)?(i=!0,ml(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$h(e),s.updater=ac,e.stateNode=s,s._reactInternals=e,Sd(e,r,t,n),e=Nd(null,e,r,!0,i,n)):(e.tag=0,Ce&&i&&Dh(e),gt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=zS(r),t=cn(r,t),s){case 0:e=Id(null,e,r,t,n);break e;case 1:e=_m(null,e,r,t,n);break e;case 11:e=ym(null,e,r,t,n);break e;case 14:e=vm(null,e,r,cn(r.type,t),n);break e}throw Error(D(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cn(r,s),Id(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cn(r,s),_m(t,e,r,s,n);case 3:e:{if(G0(e),t===null)throw Error(D(387));r=e.pendingProps,i=e.memoizedState,s=i.element,_0(t,e),wl(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ci(Error(D(423)),e),e=wm(t,e,r,n,s);break e}else if(r!==s){s=ci(Error(D(424)),e),e=wm(t,e,r,n,s);break e}else for(Ut=Er(e.stateNode.containerInfo.firstChild),$t=e,Ce=!0,dn=null,n=y0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oi(),r===s){e=Qn(t,e,n);break e}gt(t,e,r,n)}e=e.child}return e;case 5:return w0(e),t===null&&wd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,md(r,s)?o=null:i!==null&&md(r,i)&&(e.flags|=32),H0(t,e),gt(t,e,o,n),e.child;case 6:return t===null&&wd(e),null;case 13:return q0(t,e,n);case 4:return Bh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ai(e,null,r,n):gt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cn(r,s),ym(t,e,r,s,n);case 7:return gt(t,e,e.pendingProps,n),e.child;case 8:return gt(t,e,e.pendingProps.children,n),e.child;case 12:return gt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,_e(vl,r._currentValue),r._currentValue=o,i!==null)if(yn(i.value,o)){if(i.children===s.children&&!Rt.current){e=Qn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Hn(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),xd(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(D(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),xd(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}gt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Qs(e,n),s=rn(s),r=r(s),e.flags|=1,gt(t,e,r,n),e.child;case 14:return r=e.type,s=cn(r,e.pendingProps),s=cn(r.type,s),vm(t,e,r,s,n);case 15:return W0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:cn(r,s),Qa(t,e),e.tag=1,At(r)?(t=!0,ml(e)):t=!1,Qs(e,n),$0(e,r,s),Sd(e,r,s,n),Nd(null,e,r,!0,t,n);case 19:return K0(t,e,n);case 22:return z0(t,e,n)}throw Error(D(156,e.tag))};function uv(t,e){return My(t,e)}function WS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(t,e,n,r){return new WS(t,e,n,r)}function nf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zS(t){if(typeof t=="function")return nf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===xh)return 11;if(t===bh)return 14}return 2}function Tr(t,e){var n=t.alternate;return n===null?(n=Xt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Za(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")nf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Os:return ss(n.children,s,i,e);case wh:o=8,s|=8;break;case qu:return t=Xt(12,n,e,s|2),t.elementType=qu,t.lanes=i,t;case Ku:return t=Xt(13,n,e,s),t.elementType=Ku,t.lanes=i,t;case Yu:return t=Xt(19,n,e,s),t.elementType=Yu,t.lanes=i,t;case wy:return uc(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case vy:o=10;break e;case _y:o=9;break e;case xh:o=11;break e;case bh:o=14;break e;case cr:o=16,r=null;break e}throw Error(D(130,t==null?t:typeof t,""))}return e=Xt(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ss(t,e,n,r){return t=Xt(7,t,r,e),t.lanes=n,t}function uc(t,e,n,r){return t=Xt(22,t,r,e),t.elementType=wy,t.lanes=n,t.stateNode={isHidden:!1},t}function xu(t,e,n){return t=Xt(6,t,null,e),t.lanes=n,t}function bu(t,e,n){return e=Xt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HS(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nu(0),this.expirationTimes=nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rf(t,e,n,r,s,i,o,l,c){return t=new HS(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Xt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$h(i),t}function GS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:js,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function dv(t){if(!t)return Or;t=t._reactInternals;e:{if(ws(t)!==t||t.tag!==1)throw Error(D(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(At(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(D(171))}if(t.tag===1){var n=t.type;if(At(n))return d0(t,n,e)}return e}function hv(t,e,n,r,s,i,o,l,c){return t=rf(n,r,!0,t,s,i,o,l,c),t.context=dv(null),n=t.current,r=vt(),s=Cr(n),i=Hn(r,s),i.callback=e??null,Ir(n,i,s),t.current.lanes=s,Yo(t,s,r),Dt(t,r),t}function dc(t,e,n,r){var s=e.current,i=vt(),o=Cr(s);return n=dv(n),e.context===null?e.context=n:e.pendingContext=n,e=Hn(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ir(s,e,o),t!==null&&(mn(t,s,o,i),qa(t,s,o)),o}function Tl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Pm(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sf(t,e){Pm(t,e),(t=t.alternate)&&Pm(t,e)}function qS(){return null}var fv=typeof reportError=="function"?reportError:function(t){console.error(t)};function of(t){this._internalRoot=t}hc.prototype.render=of.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(D(409));dc(t,e,null,null)};hc.prototype.unmount=of.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ds(function(){dc(null,t,null,null)}),e[Kn]=null}};function hc(t){this._internalRoot=t}hc.prototype.unstable_scheduleHydration=function(t){if(t){var e=zy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<hr.length&&e!==0&&e<hr[n].priority;n++);hr.splice(n,0,t),n===0&&Gy(t)}};function af(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Rm(){}function KS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Tl(o);i.call(u)}}var o=hv(e,r,t,0,null,!1,!1,"",Rm);return t._reactRootContainer=o,t[Kn]=o.current,So(t.nodeType===8?t.parentNode:t),ds(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Tl(c);l.call(u)}}var c=rf(t,0,!1,null,null,!1,!1,"",Rm);return t._reactRootContainer=c,t[Kn]=c.current,So(t.nodeType===8?t.parentNode:t),ds(function(){dc(e,c,n,r)}),c}function pc(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Tl(o);l.call(c)}}dc(e,o,t,s)}else o=KS(n,e,t,s,r);return Tl(o)}Vy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zi(e.pendingLanes);n!==0&&(Ih(e,n|1),Dt(e,$e()),!(ae&6)&&(ui=$e()+500,zr()))}break;case 13:ds(function(){var r=Yn(t,1);if(r!==null){var s=vt();mn(r,t,1,s)}}),sf(t,1)}};Nh=function(t){if(t.tag===13){var e=Yn(t,134217728);if(e!==null){var n=vt();mn(e,t,134217728,n)}sf(t,134217728)}};Wy=function(t){if(t.tag===13){var e=Cr(t),n=Yn(t,e);if(n!==null){var r=vt();mn(n,t,e,r)}sf(t,e)}};zy=function(){return de};Hy=function(t,e){var n=de;try{return de=t,e()}finally{de=n}};id=function(t,e,n){switch(e){case"input":if(Xu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=sc(r);if(!s)throw Error(D(90));by(r),Xu(r,s)}}}break;case"textarea":Ey(t,n);break;case"select":e=n.value,e!=null&&Gs(t,!!n.multiple,e,!1)}};Ry=Zh;Ay=ds;var YS={usingClientEntryPoint:!1,Events:[Jo,Us,sc,ky,Py,Zh]},Li={findFiberByHostInstance:Qr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QS={bundleType:Li.bundleType,version:Li.version,rendererPackageName:Li.rendererPackageName,rendererConfig:Li.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Oy(t),t===null?null:t.stateNode},findFiberByHostInstance:Li.findFiberByHostInstance||qS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oa.isDisabled&&Oa.supportsFiber)try{ec=Oa.inject(QS),Nn=Oa}catch{}}Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YS;Ht.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!af(e))throw Error(D(200));return GS(t,e,null,n)};Ht.createRoot=function(t,e){if(!af(t))throw Error(D(299));var n=!1,r="",s=fv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=rf(t,1,!1,null,null,n,!1,r,s),t[Kn]=e.current,So(t.nodeType===8?t.parentNode:t),new of(e)};Ht.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(D(188)):(t=Object.keys(t).join(","),Error(D(268,t)));return t=Oy(e),t=t===null?null:t.stateNode,t};Ht.flushSync=function(t){return ds(t)};Ht.hydrate=function(t,e,n){if(!fc(e))throw Error(D(200));return pc(null,t,e,!0,n)};Ht.hydrateRoot=function(t,e,n){if(!af(t))throw Error(D(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=fv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=hv(e,null,t,1,n??null,s,!1,i,o),t[Kn]=e.current,So(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new hc(e)};Ht.render=function(t,e,n){if(!fc(e))throw Error(D(200));return pc(null,t,e,!1,n)};Ht.unmountComponentAtNode=function(t){if(!fc(t))throw Error(D(40));return t._reactRootContainer?(ds(function(){pc(null,null,t,!1,function(){t._reactRootContainer=null,t[Kn]=null})}),!0):!1};Ht.unstable_batchedUpdates=Zh;Ht.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!fc(n))throw Error(D(200));if(t==null||t._reactInternals===void 0)throw Error(D(38));return pc(t,e,n,!1,r)};Ht.version="18.3.1-next-f1338f8080-20240426";function pv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pv)}catch(t){console.error(t)}}pv(),py.exports=Ht;var JS=py.exports,Am=JS;Hu.createRoot=Am.createRoot,Hu.hydrateRoot=Am.hydrateRoot;const XS="modulepreload",ZS=function(t){return"/"+t},Dm={},ye=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=ZS(i),i in Dm)return;Dm[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":XS,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},eE=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=function(t,e){if(!t)throw wi(e)},wi=function(t){return new Error("Firebase Database ("+mv.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},tE=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},lf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,g=u&63;c||(g=64,o||(f=64)),r.push(n[d],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(gv(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new nE;const f=i<<2|l>>4;if(r.push(f),u!==64){const g=l<<4&240|u>>2;if(r.push(g),h!==64){const _=u<<6&192|h;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yv=function(t){const e=gv(t);return lf.encodeByteArray(e,!0)},kl=function(t){return yv(t).replace(/\./g,"")},Pl=function(t){try{return lf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t){return vv(void 0,t)}function vv(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!sE(n)||(t[n]=vv(t[n],e[n]));return t}function sE(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=()=>iE().__FIREBASE_DEFAULTS__,aE=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Pl(t[1]);return e&&JSON.parse(e)},cf=()=>{try{return eE()||oE()||aE()||lE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},_v=t=>{var e,n;return(n=(e=cf())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},cE=t=>{const e=_v(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},wv=()=>{var t;return(t=cf())==null?void 0:t.config},xv=t=>{var e;return(e=cf())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function bv(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t},l="";return[kl(JSON.stringify(n)),kl(JSON.stringify(o)),l].join(".")}const io={};function dE(){const t={prod:[],emulator:[]};for(const e of Object.keys(io))io[e]?t.emulator.push(e):t.prod.push(e);return t}function hE(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let jm=!1;function Sv(t,e){if(typeof window>"u"||typeof document>"u"||!xi(window.location.host)||io[t]===e||io[t]||jm)return;io[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=dE().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,g){f.setAttribute("width","24"),f.setAttribute("id",g),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{jm=!0,o()},f}function d(f,g){f.setAttribute("id",g),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=hE(r),g=n("text"),_=document.getElementById(g)||document.createElement("span"),x=n("learnmore"),M=document.getElementById(x)||document.createElement("a"),m=n("preprendIcon"),p=document.getElementById(m)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const y=f.element;l(y),d(M,x);const b=u();c(p,m),y.append(p,_,M,b),document.body.appendChild(y)}i?(_.innerText="Preview backend disconnected.",p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wt())}function fE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function df(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ev(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function pE(){const t=wt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Iv(){return mv.NODE_ADMIN===!0}function hf(){try{return typeof indexedDB=="object"}catch{return!1}}function ff(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function Nv(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mE="FirebaseError";class An extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=mE,Object.setPrototypeOf(this,An.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xs.prototype.create)}}class xs{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?gE(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new An(s,l,r)}}function gE(t,e){return t.replace(yE,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const yE=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ao(t){return JSON.parse(t)}function Ge(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cv=function(t){let e={},n={},r={},s="";try{const i=t.split(".");e=Ao(Pl(i[0])||""),n=Ao(Pl(i[1])||""),s=i[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:s}},vE=function(t){const e=Cv(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},_E=function(t){const e=Cv(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hs(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Rl(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Al(t,e,n){const r={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=e.call(n,t[s],s,t));return r}function Lr(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Om(i)&&Om(o)){if(!Lr(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Om(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gi(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function qi(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)r[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const f=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4],u,d;for(let h=0;h<80;h++){h<40?h<20?(u=l^i&(o^l),d=1518500249):(u=i^o^l,d=1859775393):h<60?(u=i&o|l&(i|o),d=2400959708):(u=i^o^l,d=3395469782);const f=(s<<5|s>>>27)+u+c+d+r[h]&4294967295;c=l,l=o,o=(i<<30|i>>>2)&4294967295,i=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let s=0;const i=this.buf_;let o=this.inbuf_;for(;s<n;){if(o===0)for(;s<=r;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<n;)if(i[o]=e.charCodeAt(s),++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}else for(;s<n;)if(i[o]=e[s],++o,++s,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let s=0;s<5;s++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[s]>>i&255,++r;return e}}function xE(t,e){const n=new bE(t,e);return n.subscribe.bind(n)}class bE{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");SE(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Su),s.error===void 0&&(s.error=Su),s.complete===void 0&&(s.complete=Su);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SE(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Su(){}function fs(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);if(s>=55296&&s<=56319){const i=s-55296;r++,O(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;s=65536+(i<<10)+o}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},mc=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=1e3,NE=2,CE=4*60*60*1e3,TE=.5;function Lm(t,e=IE,n=NE){const r=e*Math.pow(n,t),s=Math.round(TE*r*(Math.random()-.5)*2);return Math.min(CE,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(t){return t&&t._delegate?t._delegate:t}class Wt{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ft;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PE(e))try{this.getOrInitializeService({instanceIdentifier:Kr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kr){return this.instances.has(e)}getOptions(e=Kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:kE(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kr){return this.component?this.component.multipleInstances?e:Kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function kE(t){return t===Kr?void 0:t}function PE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Fd(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));const RE={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},AE=fe.INFO,DE={[fe.DEBUG]:"log",[fe.VERBOSE]:"log",[fe.INFO]:"info",[fe.WARN]:"warn",[fe.ERROR]:"error"},jE=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=DE[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gc{constructor(e){this.name=e,this._logLevel=AE,this._logHandler=jE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,fe.DEBUG,...e),this._logHandler(this,fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,fe.VERBOSE,...e),this._logHandler(this,fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,fe.INFO,...e),this._logHandler(this,fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,fe.WARN,...e),this._logHandler(this,fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,fe.ERROR,...e),this._logHandler(this,fe.ERROR,...e)}}const OE=(t,e)=>e.some(n=>t instanceof n);let Mm,Fm;function LE(){return Mm||(Mm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ME(){return Fm||(Fm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kv=new WeakMap,Ud=new WeakMap,Pv=new WeakMap,Eu=new WeakMap,pf=new WeakMap;function FE(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(kr(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&kv.set(n,t)}).catch(()=>{}),pf.set(e,t),e}function UE(t){if(Ud.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ud.set(t,e)}let $d={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ud.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Pv.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return kr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $E(t){$d=t($d)}function BE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Iu(this),e,...n);return Pv.set(r,e.sort?e.sort():[e]),kr(r)}:ME().includes(t)?function(...e){return t.apply(Iu(this),e),kr(kv.get(this))}:function(...e){return kr(t.apply(Iu(this),e))}}function VE(t){return typeof t=="function"?BE(t):(t instanceof IDBTransaction&&UE(t),OE(t,LE())?new Proxy(t,$d):t)}function kr(t){if(t instanceof IDBRequest)return FE(t);if(Eu.has(t))return Eu.get(t);const e=VE(t);return e!==t&&(Eu.set(t,e),pf.set(e,t)),e}const Iu=t=>pf.get(t);function Rv(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=kr(o);return r&&o.addEventListener("upgradeneeded",c=>{r(kr(o.result),c.oldVersion,c.newVersion,kr(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const WE=["get","getKey","getAll","getAllKeys","count"],zE=["put","add","delete","clear"],Nu=new Map;function Um(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Nu.get(e))return Nu.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=zE.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||WE.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return Nu.set(e,i),i}$E(t=>({...t,get:(e,n,r)=>Um(e,n)||t.get(e,n,r),has:(e,n)=>!!Um(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(GE(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function GE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bd="@firebase/app",$m="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn=new gc("@firebase/app"),qE="@firebase/app-compat",KE="@firebase/analytics-compat",YE="@firebase/analytics",QE="@firebase/app-check-compat",JE="@firebase/app-check",XE="@firebase/auth",ZE="@firebase/auth-compat",eI="@firebase/database",tI="@firebase/data-connect",nI="@firebase/database-compat",rI="@firebase/functions",sI="@firebase/functions-compat",iI="@firebase/installations",oI="@firebase/installations-compat",aI="@firebase/messaging",lI="@firebase/messaging-compat",cI="@firebase/performance",uI="@firebase/performance-compat",dI="@firebase/remote-config",hI="@firebase/remote-config-compat",fI="@firebase/storage",pI="@firebase/storage-compat",mI="@firebase/firestore",gI="@firebase/ai",yI="@firebase/firestore-compat",vI="firebase",_I="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd="[DEFAULT]",wI={[Bd]:"fire-core",[qE]:"fire-core-compat",[YE]:"fire-analytics",[KE]:"fire-analytics-compat",[JE]:"fire-app-check",[QE]:"fire-app-check-compat",[XE]:"fire-auth",[ZE]:"fire-auth-compat",[eI]:"fire-rtdb",[tI]:"fire-data-connect",[nI]:"fire-rtdb-compat",[rI]:"fire-fn",[sI]:"fire-fn-compat",[iI]:"fire-iid",[oI]:"fire-iid-compat",[aI]:"fire-fcm",[lI]:"fire-fcm-compat",[cI]:"fire-perf",[uI]:"fire-perf-compat",[dI]:"fire-rc",[hI]:"fire-rc-compat",[fI]:"fire-gcs",[pI]:"fire-gcs-compat",[mI]:"fire-fst",[yI]:"fire-fst-compat",[gI]:"fire-vertex","fire-js":"fire-js",[vI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=new Map,xI=new Map,Wd=new Map;function Bm(t,e){try{t.container.addComponent(e)}catch(n){Jn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function kn(t){const e=t.name;if(Wd.has(e))return Jn.debug(`There were multiple attempts to register component ${e}.`),!1;Wd.set(e,t);for(const n of Do.values())Bm(n,t);for(const n of xI.values())Bm(n,t);return!0}function Ss(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ae(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pr=new xs("app","Firebase",bI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi=_I;function Av(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Vd,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Pr.create("bad-app-name",{appName:String(s)});if(n||(n=wv()),!n)throw Pr.create("no-options");const i=Do.get(s);if(i){if(Lr(n,i.options)&&Lr(r,i.config))return i;throw Pr.create("duplicate-app",{appName:s})}const o=new Tv(s);for(const c of Wd.values())o.addComponent(c);const l=new SI(n,r,o);return Do.set(s,l),l}function yc(t=Vd){const e=Do.get(t);if(!e&&t===Vd&&wv())return Av();if(!e)throw Pr.create("no-app",{appName:t});return e}function EI(){return Array.from(Do.values())}function tn(t,e,n){let r=wI[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Jn.warn(o.join(" "));return}kn(new Wt(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II="firebase-heartbeat-database",NI=1,jo="firebase-heartbeat-store";let Cu=null;function Dv(){return Cu||(Cu=Rv(II,NI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Pr.create("idb-open",{originalErrorMessage:t.message})})),Cu}async function CI(t){try{const n=(await Dv()).transaction(jo),r=await n.objectStore(jo).get(jv(t));return await n.done,r}catch(e){if(e instanceof An)Jn.warn(e.message);else{const n=Pr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Jn.warn(n.message)}}}async function Vm(t,e){try{const r=(await Dv()).transaction(jo,"readwrite");await r.objectStore(jo).put(e,jv(t)),await r.done}catch(n){if(n instanceof An)Jn.warn(n.message);else{const r=Pr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Jn.warn(r.message)}}}function jv(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=1024,kI=30;class PI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AI(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Wm();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>kI){const o=DI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Jn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Wm(),{heartbeatsToSend:r,unsentEntries:s}=RI(this._heartbeatsCache.heartbeats),i=kl(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Jn.warn(n),""}}}function Wm(){return new Date().toISOString().substring(0,10)}function RI(t,e=TI){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),zm(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),zm(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hf()?ff().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await CI(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Vm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Vm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function zm(t){return kl(JSON.stringify({version:2,heartbeats:t})).length}function DI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jI(t){kn(new Wt("platform-logger",e=>new HE(e),"PRIVATE")),kn(new Wt("heartbeat",e=>new PI(e),"PRIVATE")),tn(Bd,$m,t),tn(Bd,$m,"esm2020"),tn("fire-js","")}jI("");var OI="firebase",LI="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tn(OI,LI,"app");const Hm="@firebase/database",Gm="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ov="";function Lv(t){Ov=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ge(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ao(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return vn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new MI(e)}}catch{}return new FI},Zr=Mv("localStorage"),zd=Mv("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=new gc("@firebase/database"),Fv=function(){let t=1;return function(){return t++}}(),Uv=function(t){const e=EE(t),n=new wE;n.update(e);const r=n.digest();return lf.encodeByteArray(r)},Zo=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Zo.apply(null,r):typeof r=="object"?e+=Ge(r):e+=r,e+=" "}return e};let is=null,qm=!0;const $v=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Xs.logLevel=fe.VERBOSE,is=Xs.log.bind(Xs),e&&zd.set("logging_enabled",!0)):typeof t=="function"?is=t:(is=null,zd.remove("logging_enabled"))},Xe=function(...t){if(qm===!0&&(qm=!1,is===null&&zd.get("logging_enabled")===!0&&$v(!0)),is){const e=Zo.apply(null,t);is(e)}},ea=function(t){return function(...e){Xe(t,...e)}},Hd=function(...t){const e="FIREBASE INTERNAL ERROR: "+Zo(...t);Xs.error(e)},Pn=function(...t){const e=`FIREBASE FATAL ERROR: ${Zo(...t)}`;throw Xs.error(e),new Error(e)},ft=function(...t){const e="FIREBASE WARNING: "+Zo(...t);Xs.warn(e)},UI=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ft("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},vc=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},$I=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Mr="[MIN_NAME]",Xn="[MAX_NAME]",Es=function(t,e){if(t===e)return 0;if(t===Mr||e===Xn)return-1;if(e===Mr||t===Xn)return 1;{const n=Km(t),r=Km(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},BI=function(t,e){return t===e?0:t<e?-1:1},Mi=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ge(e))},mf=function(t){if(typeof t!="object"||t===null)return Ge(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Ge(e[r]),n+=":",n+=mf(t[e[r]]);return n+="}",n},Bv=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let s=0;s<n;s+=e)s+e>n?r.push(t.substring(s,n)):r.push(t.substring(s,s+e));return r};function tt(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Vv=function(t){O(!vc(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let s,i,o,l,c;t===0?(i=0,o=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),i=l+r,o=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-r-n))));const u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(s?1:0),u.reverse();const d=u.join("");let h="";for(c=0;c<64;c+=8){let f=parseInt(d.substr(c,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},VI=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},WI=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zI(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const HI=new RegExp("^-?(0*)\\d{1,10}$"),GI=-2147483648,qI=2147483647,Km=function(t){if(HI.test(t)){const e=Number(t);if(e>=GI&&e<=qI)return e}return null},Si=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw ft("Exception was thrown by user callback.",n),e},Math.floor(0))}},KI=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oo=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Ae(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ft(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Xe("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ft(e)}}class Zs{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Zs.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf="5",Wv="v",zv="s",Hv="r",Gv="f",qv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Kv="ls",Yv="p",Gd="ac",Qv="websocket",Jv="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xv{constructor(e,n,r,s,i=!1,o="",l=!1,c=!1,u=null){this.secure=n,this.namespace=r,this.webSocketOnly=s,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Zr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function JI(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Zv(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let r;if(e===Qv)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Jv)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);JI(t)&&(n.ns=t.namespace);const s=[];return tt(n,(i,o)=>{s.push(i+"="+o)}),r+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(){this.counters_={}}incrementCounter(e,n=1){vn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return rE(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu={},ku={};function yf(t){const e=t.toString();return Tu[e]||(Tu[e]=new XI),Tu[e]}function ZI(t,e){const n=t.toString();return ku[n]||(ku[n]=e()),ku[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<r.length;++s)r[s]&&Si(()=>{this.onMessage_(r[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ym="start",tN="close",nN="pLPCommand",rN="pRTLPCB",e_="id",t_="pw",n_="ser",sN="cb",iN="seg",oN="ts",aN="d",lN="dframe",r_=1870,s_=30,cN=r_-s_,uN=25e3,dN=3e4;class _r{constructor(e,n,r,s,i,o,l){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.transportSessionId=o,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ea(e),this.stats_=yf(n),this.urlFn=c=>(this.appCheckToken&&(c[Gd]=this.appCheckToken),Zv(n,Jv,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new eN(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(dN)),$I(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vf((...i)=>{const[o,l,c,u,d]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Ym)this.id=l,this.password=c;else if(o===tN)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,l]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,l)},()=>{this.onClosed_()},this.urlFn);const r={};r[Ym]="t",r[n_]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[sN]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Wv]=gf,this.transportSessionId&&(r[zv]=this.transportSessionId),this.lastSessionId&&(r[Kv]=this.lastSessionId),this.applicationId&&(r[Yv]=this.applicationId),this.appCheckToken&&(r[Gd]=this.appCheckToken),typeof location<"u"&&location.hostname&&qv.test(location.hostname)&&(r[Hv]=Gv);const s=this.urlFn(r);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_r.forceAllow_=!0}static forceDisallow(){_r.forceDisallow_=!0}static isAvailable(){return _r.forceAllow_?!0:!_r.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!VI()&&!WI()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ge(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=yv(n),s=Bv(r,cN);for(let i=0;i<s.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[lN]="t",r[e_]=e,r[t_]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ge(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class vf{constructor(e,n,r,s){this.onDisconnect=r,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Fv(),window[nN+this.uniqueCallbackIdentifier]=e,window[rN+this.uniqueCallbackIdentifier]=n,this.myIFrame=vf.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(l){Xe("frame writing exception"),l.stack&&Xe(l.stack),Xe(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Xe("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[e_]=this.myID,e[t_]=this.myPW,e[n_]=this.currentSerial;let n=this.urlFn(e),r="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+s_+r.length<=r_;){const o=this.pendingSegs.shift();r=r+"&"+iN+s+"="+o.seg+"&"+oN+s+"="+o.ts+"&"+aN+s+"="+o.d,s++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(r,Math.floor(uN)),i=()=>{clearTimeout(s),r()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const s=r.readyState;(!s||s==="loaded"||s==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Xe("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=16384,fN=45e3;let Dl=null;typeof MozWebSocket<"u"?Dl=MozWebSocket:typeof WebSocket<"u"&&(Dl=WebSocket);class Jt{constructor(e,n,r,s,i,o,l){this.connId=e,this.applicationId=r,this.appCheckToken=s,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ea(this.connId),this.stats_=yf(n),this.connURL=Jt.connectionURL_(n,o,l,s,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,s,i){const o={};return o[Wv]=gf,typeof location<"u"&&location.hostname&&qv.test(location.hostname)&&(o[Hv]=Gv),n&&(o[zv]=n),r&&(o[Kv]=r),s&&(o[Gd]=s),i&&(o[Yv]=i),Zv(e,Qv,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zr.set("previous_websocket_failure",!0);try{let r;Iv(),this.mySock=new Dl(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Jt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Dl!==null&&!Jt.forceDisallow_}static previouslyFailed(){return Zr.isInMemoryStorage||Zr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Zr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=Ao(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(O(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=Ge(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Bv(n,hN);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(fN))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Jt.responsesRequiredToBeHealthy=2;Jt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{static get ALL_TRANSPORTS(){return[_r,Jt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=Jt&&Jt.isAvailable();let r=n&&!Jt.previouslyFailed();if(e.webSocketOnly&&(n||ft("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Jt];else{const s=this.transports_=[];for(const i of di.ALL_TRANSPORTS)i&&i.isAvailable()&&s.push(i);di.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}di.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=6e4,mN=5e3,gN=10*1024,yN=100*1024,Pu="t",Qm="d",vN="s",Jm="r",_N="e",Xm="o",Zm="a",eg="n",tg="p",wN="h";class xN{constructor(e,n,r,s,i,o,l,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=s,this.authToken_=i,this.onMessage_=o,this.onReady_=l,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ea("c:"+this.id+":"),this.transportManager_=new di(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=oo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>yN?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>gN?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Pu in e){const n=e[Pu];n===Zm?this.upgradeIfSecondaryHealthy_():n===Jm?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Xm&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Mi("t",e),r=Mi("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:tg,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Zm,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:eg,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Mi("t",e),r=Mi("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Mi(Pu,e);if(Qm in e){const r=e[Qm];if(n===wN){const s={...r};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===eg){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===vN?this.onConnectionShutdown_(r):n===Jm?this.onReset_(r):n===_N?Hd("Server Error: "+r):n===Xm?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hd("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),gf!==r&&ft("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),oo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(pN))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(mN))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:tg,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{put(e,n,r,s){}merge(e,n,r,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let s=0;s<r.length;s++)r[s].callback.apply(r[s].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const s=this.getInitialEvent(e);s&&n.apply(r,s)}off(e,n,r){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let i=0;i<s.length;i++)if(s[i].callback===n&&(!r||r===s[i].context)){s.splice(i,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl extends o_{static getInstance(){return new jl}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!uf()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ng=32,rg=768;class ce{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[r]=this.pieces_[s],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function le(){return new ce("")}function ee(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Fr(t){return t.pieces_.length-t.pieceNum_}function ge(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ce(t.pieces_,e)}function _f(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function bN(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Oo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function a_(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ce(e,0)}function Te(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ce)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let s=0;s<r.length;s++)r[s].length>0&&n.push(r[s])}return new ce(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function yt(t,e){const n=ee(t),r=ee(e);if(n===null)return e;if(n===r)return yt(ge(t),ge(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function SN(t,e){const n=Oo(t,0),r=Oo(e,0);for(let s=0;s<n.length&&s<r.length;s++){const i=Es(n[s],r[s]);if(i!==0)return i}return n.length===r.length?0:n.length<r.length?-1:1}function wf(t,e){if(Fr(t)!==Fr(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Zt(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Fr(t)>Fr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class EN{constructor(e,n){this.errorPrefix_=n,this.parts_=Oo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=mc(this.parts_[r]);l_(this)}}function IN(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=mc(e),l_(t)}function NN(t){const e=t.parts_.pop();t.byteLength_-=mc(e),t.parts_.length>0&&(t.byteLength_-=1)}function l_(t){if(t.byteLength_>rg)throw new Error(t.errorPrefix_+"has a key path longer than "+rg+" bytes ("+t.byteLength_+").");if(t.parts_.length>ng)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ng+") or object contains a cycle "+Yr(t))}function Yr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends o_{static getInstance(){return new xf}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi=1e3,CN=60*5*1e3,sg=30*1e3,TN=1.3,kN=3e4,PN="server_kill",ig=3;class nn extends i_{constructor(e,n,r,s,i,o,l,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=nn.nextPersistentConnectionId_++,this.log_=ea("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Fi,this.maxReconnectDelay_=CN,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Iv())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");xf.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&jl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const s=++this.requestNumber_,i={r:s,a:e,b:n};this.log_(Ge(i)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[s]=r)}get(e){this.initConnection_();const n=new Ft,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const l=o.d;o.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,r,s){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:n,query:e,tag:r};this.listens.get(o).set(i,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),s=n._queryIdentifier;this.log_("Listen on "+r+" for "+s);const i={p:r},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,l=>{const c=l.d,u=l.s;nn.warnOnListenWarnings_(c,n),(this.listens.get(r)&&this.listens.get(r).get(s))===e&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),e.onComplete&&e.onComplete(u,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&vn(e,"w")){const r=hs(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();ft(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||_E(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=sg)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=vE(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,s=>{const i=s.s,o=s.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,e._queryObject,n)}sendUnlisten_(e,n,r,s){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";s&&(i.q=r,i.t=s),this.sendRequest(o,i)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,s){const i={p:n,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{s&&setTimeout(()=>{s(o.s,o.d)},Math.floor(0))})}put(e,n,r,s){this.putInternal("p",e,n,r,s)}merge(e,n,r,s){this.putInternal("m",e,n,r,s)}putInternal(e,n,r,s,i){this.initConnection_();const o={p:n,d:r};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const i=r.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ge(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Hd("Unrecognized action received from server: "+Ge(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Fi,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Fi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>kN&&(this.reconnectDelay_=Fi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*TN)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+nn.nextConnectionId_++,i=this.lastSessionId;let o=!1,l=null;const c=function(){l?l.close():(o=!0,r())},u=function(h){O(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};const d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);o?Xe("getToken() completed but was canceled"):(Xe("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,l=new xN(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,g=>{ft(g+" ("+this.repoInfo_.toString()+")"),this.interrupt(PN)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&ft(h),c())}}}interrupt(e){Xe("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Xe("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Rl(this.interruptReasons_)&&(this.reconnectDelay_=Fi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(i=>mf(i)).join("$"):r="default";const s=this.removeListen_(e,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,n){const r=new ce(e).toString();let s;if(this.listens.has(r)){const i=this.listens.get(r);s=i.get(n),i.delete(n),i.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(e,n){Xe("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ig&&(this.reconnectDelay_=sg,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Xe("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ig&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Ov.replace(/\./g,"-")]=1,uf()?e["framework.cordova"]=1:Ev()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=jl.getInstance().currentlyOnline();return Rl(this.interruptReasons_)&&e}}nn.nextPersistentConnectionId_=0;nn.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new ne(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new ne(Mr,e),s=new ne(Mr,n);return this.compare(r,s)!==0}minPost(){return ne.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let La;class c_ extends _c{static get __EMPTY_NODE(){return La}static set __EMPTY_NODE(e){La=e}compare(e,n){return Es(e.name,n.name)}isDefinedOn(e){throw wi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ne.MIN}maxPost(){return new ne(Xn,La)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new ne(e,La)}toString(){return".key"}}const Tn=new c_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,r,s,i=null){this.isReverse_=s,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,s&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Je{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Je.RED,this.left=s??Pt.EMPTY_NODE,this.right=i??Pt.EMPTY_NODE}copy(e,n,r,s,i){return new Je(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return i<0?s=s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s=s.copy(null,n,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Pt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,s;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Pt.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Je.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Je.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Je.RED=!0;Je.BLACK=!1;class RN{copy(e,n,r,s,i){return this}insert(e,n,r){return new Je(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Pt{constructor(e,n=Pt.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Pt(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Je.BLACK,null,null))}remove(e){return new Pt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Je.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,s=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return s?s.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(s=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ma(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Ma(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Ma(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Ma(this.root_,null,this.comparator_,!0,e)}}Pt.EMPTY_NODE=new RN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AN(t,e){return Es(t.name,e.name)}function bf(t,e){return Es(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qd;function DN(t){qd=t}const u_=function(t){return typeof t=="number"?"number:"+Vv(t):"string:"+t},d_=function(t){if(t.isLeafNode()){const e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&vn(e,".sv"),"Priority must be a string or number.")}else O(t===qd||t.isEmpty(),"priority of unexpected type.");O(t===qd||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let og;class Ke{static set __childrenNodeConstructor(e){og=e}static get __childrenNodeConstructor(){return og}constructor(e,n=Ke.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),d_(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ke(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ke.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return te(e)?this:ee(e)===".priority"?this.priorityNode_:Ke.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ke.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=ee(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(O(r!==".priority"||Fr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,Ke.__childrenNodeConstructor.EMPTY_NODE.updateChild(ge(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+u_(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Vv(this.value_):e+=this.value_,this.lazyHash_=Uv(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ke.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ke.__childrenNodeConstructor?-1:(O(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,s=Ke.VALUE_TYPE_ORDER.indexOf(n),i=Ke.VALUE_TYPE_ORDER.indexOf(r);return O(s>=0,"Unknown leaf type: "+n),O(i>=0,"Unknown leaf type: "+r),s===i?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ke.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h_,f_;function jN(t){h_=t}function ON(t){f_=t}class LN extends _c{compare(e,n){const r=e.node.getPriority(),s=n.node.getPriority(),i=r.compareTo(s);return i===0?Es(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ne.MIN}maxPost(){return new ne(Xn,new Ke("[PRIORITY-POST]",f_))}makePost(e,n){const r=h_(e);return new ne(n,new Ke("[PRIORITY-POST]",r))}toString(){return".priority"}}const we=new LN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=Math.log(2);class FN{constructor(e){const n=i=>parseInt(Math.log(i)/MN,10),r=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const s=r(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ol=function(t,e,n,r){t.sort(e);const s=function(c,u){const d=u-c;let h,f;if(d===0)return null;if(d===1)return h=t[c],f=n?n(h):h,new Je(f,h.node,Je.BLACK,null,null);{const g=parseInt(d/2,10)+c,_=s(c,g),x=s(g+1,u);return h=t[g],f=n?n(h):h,new Je(f,h.node,Je.BLACK,_,x)}},i=function(c){let u=null,d=null,h=t.length;const f=function(_,x){const M=h-_,m=h;h-=_;const p=s(M+1,m),y=t[M],b=n?n(y):y;g(new Je(b,y.node,x,null,p))},g=function(_){u?(u.left=_,u=_):(d=_,u=_)};for(let _=0;_<c.count;++_){const x=c.nextBitIsOne(),M=Math.pow(2,c.count-(_+1));x?f(M,Je.BLACK):(f(M,Je.BLACK),f(M,Je.RED))}return d},o=new FN(t.length),l=i(o);return new Pt(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ru;const Ds={};class Vn{static get Default(){return O(Ds&&we,"ChildrenNode.ts has not been loaded"),Ru=Ru||new Vn({".priority":Ds},{".priority":we}),Ru}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=hs(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Pt?n:null}hasIndex(e){return vn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Tn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let s=!1;const i=n.getIterator(ne.Wrap);let o=i.getNext();for(;o;)s=s||e.isDefinedOn(o.node),r.push(o),o=i.getNext();let l;s?l=Ol(r,e.getCompare()):l=Ds;const c=e.toString(),u={...this.indexSet_};u[c]=e;const d={...this.indexes_};return d[c]=l,new Vn(d,u)}addToIndexes(e,n){const r=Al(this.indexes_,(s,i)=>{const o=hs(this.indexSet_,i);if(O(o,"Missing index implementation for "+i),s===Ds)if(o.isDefinedOn(e.node)){const l=[],c=n.getIterator(ne.Wrap);let u=c.getNext();for(;u;)u.name!==e.name&&l.push(u),u=c.getNext();return l.push(e),Ol(l,o.getCompare())}else return Ds;else{const l=n.get(e.name);let c=s;return l&&(c=c.remove(new ne(e.name,l))),c.insert(e,e.node)}});return new Vn(r,this.indexSet_)}removeFromIndexes(e,n){const r=Al(this.indexes_,s=>{if(s===Ds)return s;{const i=n.get(e.name);return i?s.remove(new ne(e.name,i)):s}});return new Vn(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ui;class K{static get EMPTY_NODE(){return Ui||(Ui=new K(new Pt(bf),null,Vn.Default))}constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&d_(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ui}updatePriority(e){return this.children_.isEmpty()?this:new K(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Ui:n}}getChild(e){const n=ee(e);return n===null?this:this.getImmediateChild(n).getChild(ge(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(O(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new ne(e,n);let s,i;n.isEmpty()?(s=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(r,this.children_));const o=s.isEmpty()?Ui:this.priorityNode_;return new K(s,o,i)}}updateChild(e,n){const r=ee(e);if(r===null)return n;{O(ee(e)!==".priority"||Fr(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(ge(e),n);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,s=0,i=!0;if(this.forEachChild(we,(o,l)=>{n[o]=l.val(e),r++,i&&K.INTEGER_REGEXP_.test(o)?s=Math.max(s,Number(o)):i=!1}),!e&&i&&s<2*r){const o=[];for(const l in n)o[l]=n[l];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+u_(this.getPriority().val())+":"),this.forEachChild(we,(n,r)=>{const s=r.hash();s!==""&&(e+=":"+n+":"+s)}),this.lazyHash_=e===""?"":Uv(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const s=this.resolveIndex_(r);if(s){const i=s.getPredecessorKey(new ne(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new ne(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new ne(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(s=>n(s.name,s.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ne.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)<0;)s.getNext(),i=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ne.Wrap);let i=s.peek();for(;i!=null&&n.compare(i,e)>0;)s.getNext(),i=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ta?-1:0}withIndex(e){if(e===Tn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new K(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Tn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(we),s=n.getIterator(we);let i=r.getNext(),o=s.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=s.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Tn?null:this.indexMap_.get(e.toString())}}K.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class UN extends K{constructor(){super(new Pt(bf),K.EMPTY_NODE,Vn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return K.EMPTY_NODE}isEmpty(){return!1}}const ta=new UN;Object.defineProperties(ne,{MIN:{value:new ne(Mr,K.EMPTY_NODE)},MAX:{value:new ne(Xn,ta)}});c_.__EMPTY_NODE=K.EMPTY_NODE;Ke.__childrenNodeConstructor=K;DN(ta);ON(ta);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=!0;function Re(t,e=null){if(t===null)return K.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ke(n,Re(e))}if(!(t instanceof Array)&&$N){const n=[];let r=!1;if(tt(t,(o,l)=>{if(o.substring(0,1)!=="."){const c=Re(l);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ne(o,c)))}}),n.length===0)return K.EMPTY_NODE;const i=Ol(n,AN,o=>o.name,bf);if(r){const o=Ol(n,we.getCompare());return new K(i,Re(e),new Vn({".priority":o},{".priority":we}))}else return new K(i,Re(e),Vn.Default)}else{let n=K.EMPTY_NODE;return tt(t,(r,s)=>{if(vn(t,r)&&r.substring(0,1)!=="."){const i=Re(s);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(r,i))}}),n.updatePriority(Re(e))}}jN(Re);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf extends _c{constructor(e){super(),this.indexPath_=e,O(!te(e)&&ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),s=this.extractChild(n.node),i=r.compareTo(s);return i===0?Es(e.name,n.name):i}makePost(e,n){const r=Re(e),s=K.EMPTY_NODE.updateChild(this.indexPath_,r);return new ne(n,s)}maxPost(){const e=K.EMPTY_NODE.updateChild(this.indexPath_,ta);return new ne(Xn,e)}toString(){return Oo(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN extends _c{compare(e,n){const r=e.node.compareTo(n.node);return r===0?Es(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ne.MIN}maxPost(){return ne.MAX}makePost(e,n){const r=Re(e);return new ne(n,r)}toString(){return".value"}}const Ef=new BN;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t){return{type:"value",snapshotNode:t}}function hi(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Lo(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Mo(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function VN(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e){this.index_=e}updateChild(e,n,r,s,i,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(s).equals(r.getChild(s))&&l.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Lo(n,l)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?o.trackChildChange(hi(n,r)):o.trackChildChange(Mo(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(we,(s,i)=>{n.hasChild(s)||r.trackChildChange(Lo(s,i))}),n.isLeafNode()||n.forEachChild(we,(s,i)=>{if(e.hasChild(s)){const o=e.getImmediateChild(s);o.equals(i)||r.trackChildChange(Mo(s,i,o))}else r.trackChildChange(hi(s,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?K.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e){this.indexedFilter_=new If(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fo.getStartPost_(e),this.endPost_=Fo.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,s,i,o){return this.matches(new ne(n,r))||(r=K.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,s,i,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=K.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(K.EMPTY_NODE);const i=this;return n.forEachChild(we,(o,l)=>{i.matches(new ne(o,l))||(s=s.updateImmediateChild(o,K.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Fo(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,s,i,o){return this.rangedFilter_.matches(new ne(n,r))||(r=K.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,s,i,o):this.fullLimitUpdateChild_(e,n,r,i,o)}updateFullNode(e,n,r){let s;if(n.isLeafNode()||n.isEmpty())s=K.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=K.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const l=i.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),o++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(K.EMPTY_NODE);let i;this.reverse_?i=s.getReverseIterator(this.index_):i=s.getIterator(this.index_);let o=0;for(;i.hasNext();){const l=i.getNext();o<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?o++:s=s.updateImmediateChild(l.name,K.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,s,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(f,g)=>h(g,f)}else o=this.index_.getCompare();const l=e;O(l.numChildren()===this.limit_,"");const c=new ne(n,r),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(l.hasChild(n)){const h=l.getImmediateChild(n);let f=s.getChildAfterChild(this.index_,u,this.reverse_);for(;f!=null&&(f.name===n||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const g=f==null?1:o(f,c);if(d&&!r.isEmpty()&&g>=0)return i!=null&&i.trackChildChange(Mo(n,r,h)),l.updateImmediateChild(n,r);{i!=null&&i.trackChildChange(Lo(n,h));const x=l.updateImmediateChild(n,K.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(i!=null&&i.trackChildChange(hi(f.name,f.node)),x.updateImmediateChild(f.name,f.node)):x}}else return r.isEmpty()?e:d&&o(u,c)>=0?(i!=null&&(i.trackChildChange(Lo(u.name,u.node)),i.trackChildChange(hi(n,r))),l.updateImmediateChild(n,r).updateImmediateChild(u.name,K.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=we}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Mr}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===we}copy(){const e=new Nf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function zN(t){return t.loadsAllData()?new If(t.getIndex()):t.hasLimit()?new WN(t):new Fo(t)}function HN(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function GN(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Kd(t,e,n){const r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function qN(t,e,n){let r;return t.index_===Tn||n?r=Kd(t,e,n):r=Kd(t,e,Xn),r.startAfterSet_=!0,r}function Yd(t,e,n){const r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function KN(t,e,n){let r;return t.index_===Tn||n?r=Yd(t,e,n):r=Yd(t,e,Mr),r.endBeforeSet_=!0,r}function wc(t,e){const n=t.copy();return n.index_=e,n}function ag(t){const e={};if(t.isDefault())return e;let n;if(t.index_===we?n="$priority":t.index_===Ef?n="$value":t.index_===Tn?n="$key":(O(t.index_ instanceof Sf,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ge(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=Ge(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Ge(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Ge(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Ge(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function lg(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==we&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends i_{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,r,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=s,this.log_=ea("p:rest:"),this.listens_={}}listen(e,n,r,s){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=Ll.getListenId_(e,r),l={};this.listens_[o]=l;const c=ag(e._queryParams);this.restRequest_(i+".json",c,(u,d)=>{let h=d;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(i,h,!1,r),hs(this.listens_,o)===l){let f;u?u===401?f="permission_denied":f="rest_error:"+u:f="ok",s(f,null)}})}unlisten(e,n){const r=Ll.getListenId_(e,n);delete this.listens_[r]}get(e){const n=ag(e._queryParams),r=e._path.toString(),s=new Ft;return this.restRequest_(r+".json",n,(i,o)=>{let l=o;i===404&&(l=null,i=null),i===null?(this.onDataUpdate_(r,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,i])=>{s&&s.accessToken&&(n.auth=s.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+bs(n);this.log_("Sending REST request for "+o);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(r&&l.readyState===4){this.log_("REST Response for "+o+" received. status:",l.status,"response:",l.responseText);let c=null;if(l.status>=200&&l.status<300){try{c=Ao(l.responseText)}catch{ft("Failed to parse JSON response for "+o+": "+l.responseText)}r(null,c)}else l.status!==401&&l.status!==404&&ft("Got unsuccessful REST response for "+o+" Status: "+l.status),r(l.status);r=null}},l.open("GET",o,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(){this.rootNode_=K.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(){return{value:null,children:new Map}}function Ei(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=ee(e);t.children.has(r)||t.children.set(r,Ml());const s=t.children.get(r);e=ge(e),Ei(s,e,n)}}function Qd(t,e){if(te(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(we,(r,s)=>{Ei(t,new ce(r),s)}),Qd(t,e)}}else if(t.children.size>0){const n=ee(e);return e=ge(e),t.children.has(n)&&Qd(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Jd(t,e,n){t.value!==null?n(e,t.value):QN(t,(r,s)=>{const i=new ce(e.toString()+"/"+r);Jd(s,i,n)})}function QN(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&tt(this.last_,(r,s)=>{n[r]=n[r]-s}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=10*1e3,XN=30*1e3,ZN=5*60*1e3;class e1{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new JN(e);const r=cg+(XN-cg)*Math.random();oo(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;tt(e,(s,i)=>{i>0&&vn(this.statsToReport_,s)&&(n[s]=i,r=!0)}),r&&this.server_.reportStats(n),oo(this.reportStats_.bind(this),Math.floor(Math.random()*2*ZN))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(hn||(hn={}));function Cf(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Tf(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function kf(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=hn.ACK_USER_WRITE,this.source=Cf()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new ce(e));return new Fl(le(),n,this.revert)}}else return O(ee(this.path)===e,"operationForChild called for unrelated child."),new Fl(ge(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,n){this.source=e,this.path=n,this.type=hn.LISTEN_COMPLETE}operationForChild(e){return te(this.path)?new Uo(this.source,le()):new Uo(this.source,ge(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=hn.OVERWRITE}operationForChild(e){return te(this.path)?new ps(this.source,le(),this.snap.getImmediateChild(e)):new ps(this.source,ge(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=hn.MERGE}operationForChild(e){if(te(this.path)){const n=this.children.subtree(new ce(e));return n.isEmpty()?null:n.value?new ps(this.source,le(),n.value):new fi(this.source,le(),n)}else return O(ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new fi(this.source,ge(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;const n=ee(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function n1(t,e,n,r){const s=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(VN(o.childName,o.snapshotNode))}),$i(t,s,"child_removed",e,r,n),$i(t,s,"child_added",e,r,n),$i(t,s,"child_moved",i,r,n),$i(t,s,"child_changed",e,r,n),$i(t,s,"value",e,r,n),s}function $i(t,e,n,r,s,i){const o=r.filter(l=>l.type===n);o.sort((l,c)=>s1(t,l,c)),o.forEach(l=>{const c=r1(t,l,i);s.forEach(u=>{u.respondsTo(l.type)&&e.push(u.createEvent(c,t.query_))})})}function r1(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function s1(t,e,n){if(e.childName==null||n.childName==null)throw wi("Should only compare child_ events.");const r=new ne(e.childName,e.snapshotNode),s=new ne(n.childName,n.snapshotNode);return t.index_.compare(r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(t,e){return{eventCache:t,serverCache:e}}function ao(t,e,n,r){return xc(new Ur(e,n,r),t.serverCache)}function m_(t,e,n,r){return xc(t.eventCache,new Ur(e,n,r))}function Ul(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function ms(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Au;const i1=()=>(Au||(Au=new Pt(BI)),Au);class ve{static fromObject(e){let n=new ve(null);return tt(e,(r,s)=>{n=n.set(new ce(r),s)}),n}constructor(e,n=i1()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:le(),value:this.value};if(te(e))return null;{const r=ee(e),s=this.children.get(r);if(s!==null){const i=s.findRootMostMatchingPathAndValue(ge(e),n);return i!=null?{path:Te(new ce(r),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{const n=ee(e),r=this.children.get(n);return r!==null?r.subtree(ge(e)):new ve(null)}}set(e,n){if(te(e))return new ve(n,this.children);{const r=ee(e),i=(this.children.get(r)||new ve(null)).set(ge(e),n),o=this.children.insert(r,i);return new ve(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new ve(null):new ve(null,this.children);{const n=ee(e),r=this.children.get(n);if(r){const s=r.remove(ge(e));let i;return s.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,s),this.value===null&&i.isEmpty()?new ve(null):new ve(this.value,i)}else return this}}get(e){if(te(e))return this.value;{const n=ee(e),r=this.children.get(n);return r?r.get(ge(e)):null}}setTree(e,n){if(te(e))return n;{const r=ee(e),i=(this.children.get(r)||new ve(null)).setTree(ge(e),n);let o;return i.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,i),new ve(this.value,o)}}fold(e){return this.fold_(le(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((s,i)=>{r[s]=i.fold_(Te(e,s),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,le(),n)}findOnPath_(e,n,r){const s=this.value?r(n,this.value):!1;if(s)return s;if(te(e))return null;{const i=ee(e),o=this.children.get(i);return o?o.findOnPath_(ge(e),Te(n,i),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,le(),n)}foreachOnPath_(e,n,r){if(te(e))return this;{this.value&&r(n,this.value);const s=ee(e),i=this.children.get(s);return i?i.foreachOnPath_(ge(e),Te(n,s),r):new ve(null)}}foreach(e){this.foreach_(le(),e)}foreach_(e,n){this.children.inorderTraversal((r,s)=>{s.foreach_(Te(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.writeTree_=e}static empty(){return new gn(new ve(null))}}function lo(t,e,n){if(te(e))return new gn(new ve(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const s=r.path;let i=r.value;const o=yt(s,e);return i=i.updateChild(o,n),new gn(t.writeTree_.set(s,i))}else{const s=new ve(n),i=t.writeTree_.setTree(e,s);return new gn(i)}}}function Xd(t,e,n){let r=t;return tt(n,(s,i)=>{r=lo(r,Te(e,s),i)}),r}function ug(t,e){if(te(e))return gn.empty();{const n=t.writeTree_.setTree(e,new ve(null));return new gn(n)}}function Zd(t,e){return Is(t,e)!=null}function Is(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(yt(n.path,e)):null}function dg(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(we,(r,s)=>{e.push(new ne(r,s))}):t.writeTree_.children.inorderTraversal((r,s)=>{s.value!=null&&e.push(new ne(r,s.value))}),e}function Rr(t,e){if(te(e))return t;{const n=Is(t,e);return n!=null?new gn(new ve(n)):new gn(t.writeTree_.subtree(e))}}function eh(t){return t.writeTree_.isEmpty()}function pi(t,e){return g_(le(),t.writeTree_,e)}function g_(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((s,i)=>{s===".priority"?(O(i.value!==null,"Priority writes must always be leaf nodes"),r=i.value):n=g_(Te(t,s),i,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Te(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(t,e){return w_(e,t)}function o1(t,e,n,r,s){O(r>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:s}),s&&(t.visibleWrites=lo(t.visibleWrites,e,n)),t.lastWriteId=r}function a1(t,e,n,r){O(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Xd(t.visibleWrites,e,n),t.lastWriteId=r}function l1(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function c1(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let s=r.visible,i=!1,o=t.allWrites.length-1;for(;s&&o>=0;){const l=t.allWrites[o];l.visible&&(o>=n&&u1(l,r.path)?s=!1:Zt(r.path,l.path)&&(i=!0)),o--}if(s){if(i)return d1(t),!0;if(r.snap)t.visibleWrites=ug(t.visibleWrites,r.path);else{const l=r.children;tt(l,c=>{t.visibleWrites=ug(t.visibleWrites,Te(r.path,c))})}return!0}else return!1}function u1(t,e){if(t.snap)return Zt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Zt(Te(t.path,n),e))return!0;return!1}function d1(t){t.visibleWrites=y_(t.allWrites,h1,le()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function h1(t){return t.visible}function y_(t,e,n){let r=gn.empty();for(let s=0;s<t.length;++s){const i=t[s];if(e(i)){const o=i.path;let l;if(i.snap)Zt(n,o)?(l=yt(n,o),r=lo(r,l,i.snap)):Zt(o,n)&&(l=yt(o,n),r=lo(r,le(),i.snap.getChild(l)));else if(i.children){if(Zt(n,o))l=yt(n,o),r=Xd(r,l,i.children);else if(Zt(o,n))if(l=yt(o,n),te(l))r=Xd(r,le(),i.children);else{const c=hs(i.children,ee(l));if(c){const u=c.getChild(ge(l));r=lo(r,le(),u)}}}else throw wi("WriteRecord should have .snap or .children")}}return r}function v_(t,e,n,r,s){if(!r&&!s){const i=Is(t.visibleWrites,e);if(i!=null)return i;{const o=Rr(t.visibleWrites,e);if(eh(o))return n;if(n==null&&!Zd(o,le()))return null;{const l=n||K.EMPTY_NODE;return pi(o,l)}}}else{const i=Rr(t.visibleWrites,e);if(!s&&eh(i))return n;if(!s&&n==null&&!Zd(i,le()))return null;{const o=function(u){return(u.visible||s)&&(!r||!~r.indexOf(u.writeId))&&(Zt(u.path,e)||Zt(e,u.path))},l=y_(t.allWrites,o,e),c=n||K.EMPTY_NODE;return pi(l,c)}}}function f1(t,e,n){let r=K.EMPTY_NODE;const s=Is(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(we,(i,o)=>{r=r.updateImmediateChild(i,o)}),r;if(n){const i=Rr(t.visibleWrites,e);return n.forEachChild(we,(o,l)=>{const c=pi(Rr(i,new ce(o)),l);r=r.updateImmediateChild(o,c)}),dg(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const i=Rr(t.visibleWrites,e);return dg(i).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function p1(t,e,n,r,s){O(r||s,"Either existingEventSnap or existingServerSnap must exist");const i=Te(e,n);if(Zd(t.visibleWrites,i))return null;{const o=Rr(t.visibleWrites,i);return eh(o)?s.getChild(n):pi(o,s.getChild(n))}}function m1(t,e,n,r){const s=Te(e,n),i=Is(t.visibleWrites,s);if(i!=null)return i;if(r.isCompleteForChild(n)){const o=Rr(t.visibleWrites,s);return pi(o,r.getNode().getImmediateChild(n))}else return null}function g1(t,e){return Is(t.visibleWrites,e)}function y1(t,e,n,r,s,i,o){let l;const c=Rr(t.visibleWrites,e),u=Is(c,le());if(u!=null)l=u;else if(n!=null)l=pi(c,n);else return[];if(l=l.withIndex(o),!l.isEmpty()&&!l.isLeafNode()){const d=[],h=o.getCompare(),f=i?l.getReverseIteratorFrom(r,o):l.getIteratorFrom(r,o);let g=f.getNext();for(;g&&d.length<s;)h(g,r)!==0&&d.push(g),g=f.getNext();return d}else return[]}function v1(){return{visibleWrites:gn.empty(),allWrites:[],lastWriteId:-1}}function $l(t,e,n,r){return v_(t.writeTree,t.treePath,e,n,r)}function Pf(t,e){return f1(t.writeTree,t.treePath,e)}function hg(t,e,n,r){return p1(t.writeTree,t.treePath,e,n,r)}function Bl(t,e){return g1(t.writeTree,Te(t.treePath,e))}function _1(t,e,n,r,s,i){return y1(t.writeTree,t.treePath,e,n,r,s,i)}function Rf(t,e,n){return m1(t.writeTree,t.treePath,e,n)}function __(t,e){return w_(Te(t.treePath,e),t.writeTree)}function w_(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(r!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(r);if(s){const i=s.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(r,Mo(r,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(r,Lo(r,s.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(r,hi(r,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(r,Mo(r,e.snapshotNode,s.oldSnap));else throw wi("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const x_=new x1;class Af{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new Ur(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Rf(this.writes_,e,r)}}getChildAfterChild(e,n,r){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:ms(this.viewCache_),i=_1(this.writes_,s,n,1,r,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(t){return{filter:t}}function S1(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function E1(t,e,n,r,s){const i=new w1;let o,l;if(n.type===hn.OVERWRITE){const u=n;u.source.fromUser?o=th(t,e,u.path,u.snap,r,s,i):(O(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered()&&!te(u.path),o=Vl(t,e,u.path,u.snap,r,s,l,i))}else if(n.type===hn.MERGE){const u=n;u.source.fromUser?o=N1(t,e,u.path,u.children,r,s,i):(O(u.source.fromServer,"Unknown source."),l=u.source.tagged||e.serverCache.isFiltered(),o=nh(t,e,u.path,u.children,r,s,l,i))}else if(n.type===hn.ACK_USER_WRITE){const u=n;u.revert?o=k1(t,e,u.path,r,s,i):o=C1(t,e,u.path,u.affectedTree,r,s,i)}else if(n.type===hn.LISTEN_COMPLETE)o=T1(t,e,n.path,r,i);else throw wi("Unknown operation type: "+n.type);const c=i.getChanges();return I1(e,o,c),{viewCache:o,changes:c}}function I1(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const s=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=Ul(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(p_(Ul(e)))}}function b_(t,e,n,r,s,i){const o=e.eventCache;if(Bl(r,n)!=null)return e;{let l,c;if(te(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=ms(e),d=u instanceof K?u:K.EMPTY_NODE,h=Pf(r,d);l=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const u=$l(r,ms(e));l=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=ee(n);if(u===".priority"){O(Fr(n)===1,"Can't have a priority with additional path components");const d=o.getNode();c=e.serverCache.getNode();const h=hg(r,n,d,c);h!=null?l=t.filter.updatePriority(d,h):l=o.getNode()}else{const d=ge(n);let h;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();const f=hg(r,n,o.getNode(),c);f!=null?h=o.getNode().getImmediateChild(u).updateChild(d,f):h=o.getNode().getImmediateChild(u)}else h=Rf(r,u,e.serverCache);h!=null?l=t.filter.updateChild(o.getNode(),u,h,d,s,i):l=o.getNode()}}return ao(e,l,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function Vl(t,e,n,r,s,i,o,l){const c=e.serverCache;let u;const d=o?t.filter:t.filter.getIndexedFilter();if(te(n))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){const g=c.getNode().updateChild(n,r);u=d.updateFullNode(c.getNode(),g,null)}else{const g=ee(n);if(!c.isCompleteForPath(n)&&Fr(n)>1)return e;const _=ge(n),M=c.getNode().getImmediateChild(g).updateChild(_,r);g===".priority"?u=d.updatePriority(c.getNode(),M):u=d.updateChild(c.getNode(),g,M,_,x_,null)}const h=m_(e,u,c.isFullyInitialized()||te(n),d.filtersNodes()),f=new Af(s,h,i);return b_(t,h,n,s,f,l)}function th(t,e,n,r,s,i,o){const l=e.eventCache;let c,u;const d=new Af(s,e,i);if(te(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=ao(e,u,!0,t.filter.filtersNodes());else{const h=ee(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=ao(e,u,l.isFullyInitialized(),l.isFiltered());else{const f=ge(n),g=l.getNode().getImmediateChild(h);let _;if(te(f))_=r;else{const x=d.getCompleteChild(h);x!=null?_f(f)===".priority"&&x.getChild(a_(f)).isEmpty()?_=x:_=x.updateChild(f,r):_=K.EMPTY_NODE}if(g.equals(_))c=e;else{const x=t.filter.updateChild(l.getNode(),h,_,f,d,o);c=ao(e,x,l.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function fg(t,e){return t.eventCache.isCompleteForChild(e)}function N1(t,e,n,r,s,i,o){let l=e;return r.foreach((c,u)=>{const d=Te(n,c);fg(e,ee(d))&&(l=th(t,l,d,u,s,i,o))}),r.foreach((c,u)=>{const d=Te(n,c);fg(e,ee(d))||(l=th(t,l,d,u,s,i,o))}),l}function pg(t,e,n){return n.foreach((r,s)=>{e=e.updateChild(r,s)}),e}function nh(t,e,n,r,s,i,o,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;te(n)?u=r:u=new ve(null).setTree(n,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((h,f)=>{if(d.hasChild(h)){const g=e.serverCache.getNode().getImmediateChild(h),_=pg(t,g,f);c=Vl(t,c,new ce(h),_,s,i,o,l)}}),u.children.inorderTraversal((h,f)=>{const g=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!d.hasChild(h)&&!g){const _=e.serverCache.getNode().getImmediateChild(h),x=pg(t,_,f);c=Vl(t,c,new ce(h),x,s,i,o,l)}}),c}function C1(t,e,n,r,s,i,o){if(Bl(s,n)!=null)return e;const l=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(te(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Vl(t,e,n,c.getNode().getChild(n),s,i,l,o);if(te(n)){let u=new ve(null);return c.getNode().forEachChild(Tn,(d,h)=>{u=u.set(new ce(d),h)}),nh(t,e,n,u,s,i,l,o)}else return e}else{let u=new ve(null);return r.foreach((d,h)=>{const f=Te(n,d);c.isCompleteForPath(f)&&(u=u.set(d,c.getNode().getChild(f)))}),nh(t,e,n,u,s,i,l,o)}}function T1(t,e,n,r,s){const i=e.serverCache,o=m_(e,i.getNode(),i.isFullyInitialized()||te(n),i.isFiltered());return b_(t,o,n,r,x_,s)}function k1(t,e,n,r,s,i){let o;if(Bl(r,n)!=null)return e;{const l=new Af(r,e,s),c=e.eventCache.getNode();let u;if(te(n)||ee(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=$l(r,ms(e));else{const h=e.serverCache.getNode();O(h instanceof K,"serverChildren would be complete if leaf node"),d=Pf(r,h)}d=d,u=t.filter.updateFullNode(c,d,i)}else{const d=ee(n);let h=Rf(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?u=t.filter.updateChild(c,d,h,ge(n),l,i):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,K.EMPTY_NODE,ge(n),l,i):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=$l(r,ms(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||Bl(r,le())!=null,ao(e,u,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,s=new If(r.getIndex()),i=zN(r);this.processor_=b1(i);const o=n.serverCache,l=n.eventCache,c=s.updateFullNode(K.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(K.EMPTY_NODE,l.getNode(),null),d=new Ur(c,o.isFullyInitialized(),s.filtersNodes()),h=new Ur(u,l.isFullyInitialized(),i.filtersNodes());this.viewCache_=xc(h,d),this.eventGenerator_=new t1(this.query_)}get query(){return this.query_}}function R1(t){return t.viewCache_.serverCache.getNode()}function A1(t){return Ul(t.viewCache_)}function D1(t,e){const n=ms(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(ee(e)).isEmpty())?n.getChild(e):null}function mg(t){return t.eventRegistrations_.length===0}function j1(t,e){t.eventRegistrations_.push(e)}function gg(t,e,n){const r=[];if(n){O(e==null,"A cancel should cancel all event registrations.");const s=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,s);o&&r.push(o)})}if(e){let s=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))s.push(o);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function yg(t,e,n,r){e.type===hn.MERGE&&e.source.queryId!==null&&(O(ms(t.viewCache_),"We should always have a full cache before handling merges"),O(Ul(t.viewCache_),"Missing event cache, even though we have a server cache"));const s=t.viewCache_,i=E1(t.processor_,s,e,n,r);return S1(t.processor_,i.viewCache),O(i.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,S_(t,i.changes,i.viewCache.eventCache.getNode(),null)}function O1(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(we,(i,o)=>{r.push(hi(i,o))}),n.isFullyInitialized()&&r.push(p_(n.getNode())),S_(t,r,n.getNode(),e)}function S_(t,e,n,r){const s=r?[r]:t.eventRegistrations_;return n1(t.eventGenerator_,e,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wl;class E_{constructor(){this.views=new Map}}function L1(t){O(!Wl,"__referenceConstructor has already been defined"),Wl=t}function M1(){return O(Wl,"Reference.ts has not been loaded"),Wl}function F1(t){return t.views.size===0}function Df(t,e,n,r){const s=e.source.queryId;if(s!==null){const i=t.views.get(s);return O(i!=null,"SyncTree gave us an op for an invalid query."),yg(i,e,n,r)}else{let i=[];for(const o of t.views.values())i=i.concat(yg(o,e,n,r));return i}}function I_(t,e,n,r,s){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let l=$l(n,s?r:null),c=!1;l?c=!0:r instanceof K?(l=Pf(n,r),c=!1):(l=K.EMPTY_NODE,c=!1);const u=xc(new Ur(l,c,!1),new Ur(r,s,!1));return new P1(e,u)}return o}function U1(t,e,n,r,s,i){const o=I_(t,e,r,s,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),j1(o,n),O1(o,n)}function $1(t,e,n,r){const s=e._queryIdentifier,i=[];let o=[];const l=$r(t);if(s==="default")for(const[c,u]of t.views.entries())o=o.concat(gg(u,n,r)),mg(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||i.push(u.query));else{const c=t.views.get(s);c&&(o=o.concat(gg(c,n,r)),mg(c)&&(t.views.delete(s),c.query._queryParams.loadsAllData()||i.push(c.query)))}return l&&!$r(t)&&i.push(new(M1())(e._repo,e._path)),{removed:i,events:o}}function N_(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ar(t,e){let n=null;for(const r of t.views.values())n=n||D1(r,e);return n}function C_(t,e){if(e._queryParams.loadsAllData())return Sc(t);{const r=e._queryIdentifier;return t.views.get(r)}}function T_(t,e){return C_(t,e)!=null}function $r(t){return Sc(t)!=null}function Sc(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl;function B1(t){O(!zl,"__referenceConstructor has already been defined"),zl=t}function V1(){return O(zl,"Reference.ts has not been loaded"),zl}let W1=1;class vg{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ve(null),this.pendingWriteTree_=v1(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function jf(t,e,n,r,s){return o1(t.pendingWriteTree_,e,n,r,s),s?Ii(t,new ps(Cf(),e,n)):[]}function z1(t,e,n,r){a1(t.pendingWriteTree_,e,n,r);const s=ve.fromObject(n);return Ii(t,new fi(Cf(),e,s))}function wr(t,e,n=!1){const r=l1(t.pendingWriteTree_,e);if(c1(t.pendingWriteTree_,e)){let i=new ve(null);return r.snap!=null?i=i.set(le(),!0):tt(r.children,o=>{i=i.set(new ce(o),!0)}),Ii(t,new Fl(r.path,i,n))}else return[]}function na(t,e,n){return Ii(t,new ps(Tf(),e,n))}function H1(t,e,n){const r=ve.fromObject(n);return Ii(t,new fi(Tf(),e,r))}function G1(t,e){return Ii(t,new Uo(Tf(),e))}function q1(t,e,n){const r=Of(t,n);if(r){const s=Lf(r),i=s.path,o=s.queryId,l=yt(i,e),c=new Uo(kf(o),l);return Mf(t,i,c)}else return[]}function Hl(t,e,n,r,s=!1){const i=e._path,o=t.syncPointTree_.get(i);let l=[];if(o&&(e._queryIdentifier==="default"||T_(o,e))){const c=$1(o,e,n,r);F1(o)&&(t.syncPointTree_=t.syncPointTree_.remove(i));const u=c.removed;if(l=c.events,!s){const d=u.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(i,(f,g)=>$r(g));if(d&&!h){const f=t.syncPointTree_.subtree(i);if(!f.isEmpty()){const g=Q1(f);for(let _=0;_<g.length;++_){const x=g[_],M=x.query,m=A_(t,x);t.listenProvider_.startListening(co(M),$o(t,M),m.hashFn,m.onComplete)}}}!h&&u.length>0&&!r&&(d?t.listenProvider_.stopListening(co(e),null):u.forEach(f=>{const g=t.queryToTagMap.get(Ic(f));t.listenProvider_.stopListening(co(f),g)}))}J1(t,u)}return l}function k_(t,e,n,r){const s=Of(t,r);if(s!=null){const i=Lf(s),o=i.path,l=i.queryId,c=yt(o,e),u=new ps(kf(l),c,n);return Mf(t,o,u)}else return[]}function K1(t,e,n,r){const s=Of(t,r);if(s){const i=Lf(s),o=i.path,l=i.queryId,c=yt(o,e),u=ve.fromObject(n),d=new fi(kf(l),c,u);return Mf(t,o,d)}else return[]}function rh(t,e,n,r=!1){const s=e._path;let i=null,o=!1;t.syncPointTree_.foreachOnPath(s,(f,g)=>{const _=yt(f,s);i=i||Ar(g,_),o=o||$r(g)});let l=t.syncPointTree_.get(s);l?(o=o||$r(l),i=i||Ar(l,le())):(l=new E_,t.syncPointTree_=t.syncPointTree_.set(s,l));let c;i!=null?c=!0:(c=!1,i=K.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((g,_)=>{const x=Ar(_,le());x&&(i=i.updateImmediateChild(g,x))}));const u=T_(l,e);if(!u&&!e._queryParams.loadsAllData()){const f=Ic(e);O(!t.queryToTagMap.has(f),"View does not exist, but we have a tag");const g=X1();t.queryToTagMap.set(f,g),t.tagToQueryMap.set(g,f)}const d=bc(t.pendingWriteTree_,s);let h=U1(l,e,n,d,i,c);if(!u&&!o&&!r){const f=C_(l,e);h=h.concat(Z1(t,e,f))}return h}function Ec(t,e,n){const s=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,l)=>{const c=yt(o,e),u=Ar(l,c);if(u)return u});return v_(s,e,i,n,!0)}function Y1(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{const h=yt(u,n);r=r||Ar(d,h)});let s=t.syncPointTree_.get(n);s?r=r||Ar(s,le()):(s=new E_,t.syncPointTree_=t.syncPointTree_.set(n,s));const i=r!=null,o=i?new Ur(r,!0,!1):null,l=bc(t.pendingWriteTree_,e._path),c=I_(s,e,l,i?o.getNode():K.EMPTY_NODE,i);return A1(c)}function Ii(t,e){return P_(e,t.syncPointTree_,null,bc(t.pendingWriteTree_,le()))}function P_(t,e,n,r){if(te(t.path))return R_(t,e,n,r);{const s=e.get(le());n==null&&s!=null&&(n=Ar(s,le()));let i=[];const o=ee(t.path),l=t.operationForChild(o),c=e.children.get(o);if(c&&l){const u=n?n.getImmediateChild(o):null,d=__(r,o);i=i.concat(P_(l,c,u,d))}return s&&(i=i.concat(Df(s,t,r,n))),i}}function R_(t,e,n,r){const s=e.get(le());n==null&&s!=null&&(n=Ar(s,le()));let i=[];return e.children.inorderTraversal((o,l)=>{const c=n?n.getImmediateChild(o):null,u=__(r,o),d=t.operationForChild(o);d&&(i=i.concat(R_(d,l,c,u)))}),s&&(i=i.concat(Df(s,t,r,n))),i}function A_(t,e){const n=e.query,r=$o(t,n);return{hashFn:()=>(R1(e)||K.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return r?q1(t,n._path,r):G1(t,n._path);{const i=zI(s,n);return Hl(t,n,null,i)}}}}function $o(t,e){const n=Ic(e);return t.queryToTagMap.get(n)}function Ic(t){return t._path.toString()+"$"+t._queryIdentifier}function Of(t,e){return t.tagToQueryMap.get(e)}function Lf(t){const e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ce(t.substr(0,e))}}function Mf(t,e,n){const r=t.syncPointTree_.get(e);O(r,"Missing sync point for query tag that we're tracking");const s=bc(t.pendingWriteTree_,e);return Df(r,n,s,null)}function Q1(t){return t.fold((e,n,r)=>{if(n&&$r(n))return[Sc(n)];{let s=[];return n&&(s=N_(n)),tt(r,(i,o)=>{s=s.concat(o)}),s}})}function co(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(V1())(t._repo,t._path):t}function J1(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const s=Ic(r),i=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(i)}}}function X1(){return W1++}function Z1(t,e,n){const r=e._path,s=$o(t,e),i=A_(t,n),o=t.listenProvider_.startListening(co(e),s,i.hashFn,i.onComplete),l=t.syncPointTree_.subtree(r);if(s)O(!$r(l.value),"If we're adding a query, it shouldn't be shadowed");else{const c=l.fold((u,d,h)=>{if(!te(u)&&d&&$r(d))return[Sc(d).query];{let f=[];return d&&(f=f.concat(N_(d).map(g=>g.query))),tt(h,(g,_)=>{f=f.concat(_)}),f}});for(let u=0;u<c.length;++u){const d=c[u];t.listenProvider_.stopListening(co(d),$o(t,d))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ff(n)}node(){return this.node_}}class Uf{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Te(this.path_,e);return new Uf(this.syncTree_,n)}node(){return Ec(this.syncTree_,this.path_)}}const eC=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},_g=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return tC(t[".sv"],e,n);if(typeof t[".sv"]=="object")return nC(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},tC=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},nC=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&O(!1,"Unexpected increment value: "+r);const s=e.node();if(O(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return r;const o=s.getValue();return typeof o!="number"?r:o+r},D_=function(t,e,n,r){return Bf(e,new Uf(n,t),r)},$f=function(t,e,n){return Bf(t,new Ff(e),n)};function Bf(t,e,n){const r=t.getPriority().val(),s=_g(r,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,l=_g(o.getValue(),e,n);return l!==o.getValue()||s!==o.getPriority().val()?new Ke(l,Re(s)):t}else{const o=t;return i=o,s!==o.getPriority().val()&&(i=i.updatePriority(new Ke(s))),o.forEachChild(we,(l,c)=>{const u=Bf(c,e.getImmediateChild(l),n);u!==c&&(i=i.updateImmediateChild(l,u))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function Nc(t,e){let n=e instanceof ce?e:new ce(e),r=t,s=ee(n);for(;s!==null;){const i=hs(r.node.children,s)||{children:{},childCount:0};r=new Vf(s,r,i),n=ge(n),s=ee(n)}return r}function Ns(t){return t.node.value}function Wf(t,e){t.node.value=e,sh(t)}function j_(t){return t.node.childCount>0}function rC(t){return Ns(t)===void 0&&!j_(t)}function Cc(t,e){tt(t.node.children,(n,r)=>{e(new Vf(n,t,r))})}function O_(t,e,n,r){n&&!r&&e(t),Cc(t,s=>{O_(s,e,!0,r)}),n&&r&&e(t)}function sC(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ra(t){return new ce(t.parent===null?t.name:ra(t.parent)+"/"+t.name)}function sh(t){t.parent!==null&&iC(t.parent,t.name,t)}function iC(t,e,n){const r=rC(n),s=vn(t.node.children,e);r&&s?(delete t.node.children[e],t.node.childCount--,sh(t)):!r&&!s&&(t.node.children[e]=n.node,t.node.childCount++,sh(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=/[\[\].#$\/\u0000-\u001F\u007F]/,aC=/[\[\].#$\u0000-\u001F\u007F]/,Du=10*1024*1024,Tc=function(t){return typeof t=="string"&&t.length!==0&&!oC.test(t)},L_=function(t){return typeof t=="string"&&t.length!==0&&!aC.test(t)},lC=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),L_(t)},Bo=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!vc(t)||t&&typeof t=="object"&&vn(t,".sv")},Rn=function(t,e,n,r){r&&e===void 0||sa(fs(t,"value"),e,n)},sa=function(t,e,n){const r=n instanceof ce?new EN(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Yr(r));if(typeof e=="function")throw new Error(t+"contains a function "+Yr(r)+" with contents = "+e.toString());if(vc(e))throw new Error(t+"contains "+e.toString()+" "+Yr(r));if(typeof e=="string"&&e.length>Du/3&&mc(e)>Du)throw new Error(t+"contains a string greater than "+Du+" utf8 bytes "+Yr(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,i=!1;if(tt(e,(o,l)=>{if(o===".value")s=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Tc(o)))throw new Error(t+" contains an invalid key ("+o+") "+Yr(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);IN(r,o),sa(t,l,r),NN(r)}),s&&i)throw new Error(t+' contains ".value" child '+Yr(r)+" in addition to actual children.")}},cC=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];const i=Oo(r);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Tc(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(SN);let s=null;for(n=0;n<e.length;n++){if(r=e[n],s!==null&&Zt(s,r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}},M_=function(t,e,n,r){if(r&&e===void 0)return;const s=fs(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");const i=[];tt(e,(o,l)=>{const c=new ce(o);if(sa(s,l,Te(n,c)),_f(c)===".priority"&&!Bo(l))throw new Error(s+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),cC(s,i)},zf=function(t,e,n){if(!(n&&e===void 0)){if(vc(e))throw new Error(fs(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Bo(e))throw new Error(fs(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ia=function(t,e,n,r){if(!(r&&n===void 0)&&!Tc(n))throw new Error(fs(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Hf=function(t,e,n,r){if(!(r&&n===void 0)&&!L_(n))throw new Error(fs(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},uC=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Hf(t,e,n,r)},En=function(t,e){if(ee(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},F_=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Tc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!lC(n))throw new Error(fs(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function kc(t,e){let n=null;for(let r=0;r<e.length;r++){const s=e[r],i=s.getPath();n!==null&&!wf(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(s)}n&&t.eventLists_.push(n)}function U_(t,e,n){kc(t,n),$_(t,r=>wf(r,e))}function zt(t,e,n){kc(t,n),$_(t,r=>Zt(r,e)||Zt(e,r))}function $_(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const s=t.eventLists_[r];if(s){const i=s.path;e(i)?(hC(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function hC(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();is&&Xe("event: "+n.toString()),Si(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="repo_interrupt",fC=25;class pC{constructor(e,n,r,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new dC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ml(),this.transactionQueueTree_=new Vf,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function mC(t,e,n){if(t.stats_=yf(t.repoInfo_),t.forceRestClient_||KI())t.server_=new Ll(t.repoInfo_,(r,s,i,o)=>{wg(t,r,s,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>xg(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ge(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new nn(t.repoInfo_,e,(r,s,i,o)=>{wg(t,r,s,i,o)},r=>{xg(t,r)},r=>{gC(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=ZI(t.repoInfo_,()=>new e1(t.stats_,t.server_)),t.infoData_=new YN,t.infoSyncTree_=new vg({startListening:(r,s,i,o)=>{let l=[];const c=t.infoData_.getNode(r._path);return c.isEmpty()||(l=na(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),l},stopListening:()=>{}}),Gf(t,"connected",!1),t.serverSyncTree_=new vg({startListening:(r,s,i,o)=>(t.server_.listen(r,i,s,(l,c)=>{const u=o(l,c);zt(t.eventQueue_,r._path,u)}),[]),stopListening:(r,s)=>{t.server_.unlisten(r,s)}})}function V_(t){const n=t.infoData_.getNode(new ce(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function oa(t){return eC({timestamp:V_(t)})}function wg(t,e,n,r,s){t.dataUpdateCount++;const i=new ce(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(r){const c=Al(n,u=>Re(u));o=K1(t.serverSyncTree_,i,c,s)}else{const c=Re(n);o=k_(t.serverSyncTree_,i,c,s)}else if(r){const c=Al(n,u=>Re(u));o=H1(t.serverSyncTree_,i,c)}else{const c=Re(n);o=na(t.serverSyncTree_,i,c)}let l=i;o.length>0&&(l=mi(t,i)),zt(t.eventQueue_,l,o)}function xg(t,e){Gf(t,"connected",e),e===!1&&_C(t)}function gC(t,e){tt(e,(n,r)=>{Gf(t,n,r)})}function Gf(t,e,n){const r=new ce("/.info/"+e),s=Re(n);t.infoData_.updateSnapshot(r,s);const i=na(t.infoSyncTree_,r,s);zt(t.eventQueue_,r,i)}function Pc(t){return t.nextWriteId_++}function yC(t,e,n){const r=Y1(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(s=>{const i=Re(s).withIndex(e._queryParams.getIndex());rh(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=na(t.serverSyncTree_,e._path,i);else{const l=$o(t.serverSyncTree_,e);o=k_(t.serverSyncTree_,e._path,i,l)}return zt(t.eventQueue_,e._path,o),Hl(t.serverSyncTree_,e,n,null,!0),i},s=>(Ni(t,"get for query "+Ge(e)+" failed: "+s),Promise.reject(new Error(s))))}function qf(t,e,n,r,s){Ni(t,"set",{path:e.toString(),value:n,priority:r});const i=oa(t),o=Re(n,r),l=Ec(t.serverSyncTree_,e),c=$f(o,l,i),u=Pc(t),d=jf(t.serverSyncTree_,e,c,u,!0);kc(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(f,g)=>{const _=f==="ok";_||ft("set at "+e+" failed: "+f);const x=wr(t.serverSyncTree_,u,!_);zt(t.eventQueue_,e,x),Br(t,s,f,g)});const h=Yf(t,e);mi(t,h),zt(t.eventQueue_,h,[])}function vC(t,e,n,r){Ni(t,"update",{path:e.toString(),value:n});let s=!0;const i=oa(t),o={};if(tt(n,(l,c)=>{s=!1,o[l]=D_(Te(e,l),Re(c),t.serverSyncTree_,i)}),s)Xe("update() called with empty data.  Don't do anything."),Br(t,r,"ok",void 0);else{const l=Pc(t),c=z1(t.serverSyncTree_,e,o,l);kc(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{const h=u==="ok";h||ft("update at "+e+" failed: "+u);const f=wr(t.serverSyncTree_,l,!h),g=f.length>0?mi(t,e):e;zt(t.eventQueue_,g,f),Br(t,r,u,d)}),tt(n,u=>{const d=Yf(t,Te(e,u));mi(t,d)}),zt(t.eventQueue_,e,[])}}function _C(t){Ni(t,"onDisconnectEvents");const e=oa(t),n=Ml();Jd(t.onDisconnect_,le(),(s,i)=>{const o=D_(s,i,t.serverSyncTree_,e);Ei(n,s,o)});let r=[];Jd(n,le(),(s,i)=>{r=r.concat(na(t.serverSyncTree_,s,i));const o=Yf(t,s);mi(t,o)}),t.onDisconnect_=Ml(),zt(t.eventQueue_,le(),r)}function wC(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,s)=>{r==="ok"&&Qd(t.onDisconnect_,e),Br(t,n,r,s)})}function bg(t,e,n,r){const s=Re(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(i,o)=>{i==="ok"&&Ei(t.onDisconnect_,e,s),Br(t,r,i,o)})}function xC(t,e,n,r,s){const i=Re(n,r);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,l)=>{o==="ok"&&Ei(t.onDisconnect_,e,i),Br(t,s,o,l)})}function bC(t,e,n,r){if(Rl(n)){Xe("onDisconnect().update() called with empty data.  Don't do anything."),Br(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,i)=>{s==="ok"&&tt(n,(o,l)=>{const c=Re(l);Ei(t.onDisconnect_,Te(e,o),c)}),Br(t,r,s,i)})}function SC(t,e,n){let r;ee(e._path)===".info"?r=rh(t.infoSyncTree_,e,n):r=rh(t.serverSyncTree_,e,n),U_(t.eventQueue_,e._path,r)}function ih(t,e,n){let r;ee(e._path)===".info"?r=Hl(t.infoSyncTree_,e,n):r=Hl(t.serverSyncTree_,e,n),U_(t.eventQueue_,e._path,r)}function W_(t){t.persistentConnection_&&t.persistentConnection_.interrupt(B_)}function EC(t){t.persistentConnection_&&t.persistentConnection_.resume(B_)}function Ni(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Xe(n,...e)}function Br(t,e,n,r){e&&Si(()=>{if(n==="ok")e(null);else{const s=(n||"error").toUpperCase();let i=s;r&&(i+=": "+r);const o=new Error(i);o.code=s,e(o)}})}function IC(t,e,n,r,s,i){Ni(t,"transaction on "+e);const o={path:e,update:n,onComplete:r,status:null,order:Fv(),applyLocally:i,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=Kf(t,e,void 0);o.currentInputSnapshot=l;const c=o.update(l.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{sa("transaction failed: Data returned ",c,o.path),o.status=0;const u=Nc(t.transactionQueueTree_,e),d=Ns(u)||[];d.push(o),Wf(u,d);let h;typeof c=="object"&&c!==null&&vn(c,".priority")?(h=hs(c,".priority"),O(Bo(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Ec(t.serverSyncTree_,e)||K.EMPTY_NODE).getPriority().val();const f=oa(t),g=Re(c,h),_=$f(g,l,f);o.currentOutputSnapshotRaw=g,o.currentOutputSnapshotResolved=_,o.currentWriteId=Pc(t);const x=jf(t.serverSyncTree_,e,_,o.currentWriteId,o.applyLocally);zt(t.eventQueue_,e,x),Rc(t,t.transactionQueueTree_)}}function Kf(t,e,n){return Ec(t.serverSyncTree_,e,n)||K.EMPTY_NODE}function Rc(t,e=t.transactionQueueTree_){if(e||Ac(t,e),Ns(e)){const n=H_(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&NC(t,ra(e),n)}else j_(e)&&Cc(e,n=>{Rc(t,n)})}function NC(t,e,n){const r=n.map(u=>u.currentWriteId),s=Kf(t,e,r);let i=s;const o=s.hash();for(let u=0;u<n.length;u++){const d=n[u];O(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const h=yt(e,d.path);i=i.updateChild(h,d.currentOutputSnapshotRaw)}const l=i.val(!0),c=e;t.server_.put(c.toString(),l,u=>{Ni(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){const h=[];for(let f=0;f<n.length;f++)n[f].status=2,d=d.concat(wr(t.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&h.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();Ac(t,Nc(t.transactionQueueTree_,e)),Rc(t,t.transactionQueueTree_),zt(t.eventQueue_,e,d);for(let f=0;f<h.length;f++)Si(h[f])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{ft("transaction at "+c.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}mi(t,e)}},o)}function mi(t,e){const n=z_(t,e),r=ra(n),s=H_(t,n);return CC(t,s,r),r}function CC(t,e,n){if(e.length===0)return;const r=[];let s=[];const o=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const c=e[l],u=yt(n,c.path);let d=!1,h;if(O(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,s=s.concat(wr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=fC)d=!0,h="maxretry",s=s.concat(wr(t.serverSyncTree_,c.currentWriteId,!0));else{const f=Kf(t,c.path,o);c.currentInputSnapshot=f;const g=e[l].update(f.val());if(g!==void 0){sa("transaction failed: Data returned ",g,c.path);let _=Re(g);typeof g=="object"&&g!=null&&vn(g,".priority")||(_=_.updatePriority(f.getPriority()));const M=c.currentWriteId,m=oa(t),p=$f(_,f,m);c.currentOutputSnapshotRaw=_,c.currentOutputSnapshotResolved=p,c.currentWriteId=Pc(t),o.splice(o.indexOf(M),1),s=s.concat(jf(t.serverSyncTree_,c.path,p,c.currentWriteId,c.applyLocally)),s=s.concat(wr(t.serverSyncTree_,M,!0))}else d=!0,h="nodata",s=s.concat(wr(t.serverSyncTree_,c.currentWriteId,!0))}zt(t.eventQueue_,n,s),s=[],d&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(h==="nodata"?r.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):r.push(()=>e[l].onComplete(new Error(h),!1,null))))}Ac(t,t.transactionQueueTree_);for(let l=0;l<r.length;l++)Si(r[l]);Rc(t,t.transactionQueueTree_)}function z_(t,e){let n,r=t.transactionQueueTree_;for(n=ee(e);n!==null&&Ns(r)===void 0;)r=Nc(r,n),e=ge(e),n=ee(e);return r}function H_(t,e){const n=[];return G_(t,e,n),n.sort((r,s)=>r.order-s.order),n}function G_(t,e,n){const r=Ns(e);if(r)for(let s=0;s<r.length;s++)n.push(r[s]);Cc(e,s=>{G_(t,s,n)})}function Ac(t,e){const n=Ns(e);if(n){let r=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[r]=n[s],r++);n.length=r,Wf(e,n.length>0?n:void 0)}Cc(e,r=>{Ac(t,r)})}function Yf(t,e){const n=ra(z_(t,e)),r=Nc(t.transactionQueueTree_,e);return sC(r,s=>{ju(t,s)}),ju(t,r),O_(r,s=>{ju(t,s)}),n}function ju(t,e){const n=Ns(e);if(n){const r=[];let s=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),s=s.concat(wr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Wf(e,void 0):n.length=i+1,zt(t.eventQueue_,ra(e),s);for(let o=0;o<r.length;o++)Si(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let s=n[r];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function kC(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ft(`Invalid query segment '${n}' in query '${t}'`)}return e}const oh=function(t,e){const n=PC(t),r=n.namespace;n.domain==="firebase.com"&&Pn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Pn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||UI();const s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Xv(n.host,n.secure,r,s,e,"",r!==n.subdomain),path:new ce(n.pathString)}},PC=function(t){let e="",n="",r="",s="",i="",o=!0,l="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(d,h)),d<h&&(s=TC(t.substring(d,h)));const f=kC(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o=l==="https"||l==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;const g=e.slice(0,u);if(g.toLowerCase()==="localhost")n="localhost";else if(g.split(".").length<=2)n=g;else{const _=e.indexOf(".");r=e.substring(0,_).toLowerCase(),n=e.substring(_+1),i=r}"ns"in f&&(i=f.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:l,pathString:s,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sg="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",RC=function(){let t=0;const e=[];return function(n){const r=n===t;t=n;let s;const i=new Array(8);for(s=7;s>=0;s--)i[s]=Sg.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=i.join("");if(r){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)o+=Sg.charAt(e[s]);return O(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e,n,r,s){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ge(this.snapshot.exportVal())}}class K_{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Ft;return wC(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){En("OnDisconnect.remove",this._path);const e=new Ft;return bg(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){En("OnDisconnect.set",this._path),Rn("OnDisconnect.set",e,this._path,!1);const n=new Ft;return bg(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){En("OnDisconnect.setWithPriority",this._path),Rn("OnDisconnect.setWithPriority",e,this._path,!1),zf("OnDisconnect.setWithPriority",n,!1);const r=new Ft;return xC(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){En("OnDisconnect.update",this._path),M_("OnDisconnect.update",e,this._path,!1);const n=new Ft;return bC(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e,n,r,s){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=s}get key(){return te(this._path)?null:_f(this._path)}get ref(){return new _n(this._repo,this._path)}get _queryIdentifier(){const e=lg(this._queryParams),n=mf(e);return n==="{}"?"default":n}get _queryObject(){return lg(this._queryParams)}isEqual(e){if(e=H(e),!(e instanceof qt))return!1;const n=this._repo===e._repo,r=wf(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&r&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+bN(this._path)}}function Dc(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Hr(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Tn){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Mr)throw new Error(r);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Xn)throw new Error(r);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===we){if(e!=null&&!Bo(e)||n!=null&&!Bo(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof Sf||t.getIndex()===Ef,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function jc(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class _n extends qt{constructor(e,n){super(e,n,new Nf,!1)}get parent(){const e=a_(this._path);return e===null?null:new _n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class gs{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new ce(e),r=gi(this.ref,e);return new gs(this._node.getChild(n),r,we)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,s)=>e(new gs(s,gi(this.ref,r),we)))}hasChild(e){const n=new ce(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Z(t,e){return t=H(t),t._checkNotDeleted("ref"),e!==void 0?gi(t._root,e):t._root}function QA(t,e){t=H(t),t._checkNotDeleted("refFromURL");const n=oh(e,t._repo.repoInfo_.nodeAdmin);F_("refFromURL",n);const r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Pn("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Z(t,n.path.toString())}function gi(t,e){return t=H(t),ee(t._path)===null?uC("child","path",e,!1):Hf("child","path",e,!1),new _n(t._repo,Te(t._path,e))}function JA(t){return t=H(t),new AC(t._repo,t._path)}function Y_(t,e){t=H(t),En("push",t._path),Rn("push",e,t._path,!0);const n=V_(t._repo),r=RC(n),s=gi(t,r),i=gi(t,r);let o;return e!=null?o=Ye(i,e).then(()=>i):o=Promise.resolve(i),s.then=o.then.bind(o),s.catch=o.then.bind(o,void 0),s}function DC(t){return En("remove",t._path),Ye(t,null)}function Ye(t,e){t=H(t),En("set",t._path),Rn("set",e,t._path,!1);const n=new Ft;return qf(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function XA(t,e){t=H(t),En("setPriority",t._path),zf("setPriority",e,!1);const n=new Ft;return qf(t._repo,Te(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function ZA(t,e,n){if(En("setWithPriority",t._path),Rn("setWithPriority",e,t._path,!1),zf("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const r=new Ft;return qf(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function eD(t,e){M_("update",e,t._path,!1);const n=new Ft;return vC(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Le(t){t=H(t);const e=new Qf(()=>{}),n=new aa(e);return yC(t._repo,t,n).then(r=>new gs(r,new _n(t._repo,t._path),t._queryParams.getIndex()))}class aa{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new q_("value",this,new gs(e.snapshotNode,new _n(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new K_(this,e,n):null}matches(e){return e instanceof aa?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Oc{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new K_(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");const r=gi(new _n(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new q_(e.type,this,new gs(e.snapshotNode,r,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Oc?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function la(t,e,n,r,s){let i;if(typeof r=="object"&&(i=void 0,s=r),typeof r=="function"&&(i=r),s&&s.onlyOnce){const c=n,u=(d,h)=>{ih(t._repo,t,l),c(d,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}const o=new Qf(n,i||void 0),l=e==="value"?new aa(o):new Oc(e,o);return SC(t._repo,t,l),()=>ih(t._repo,t,l)}function ah(t,e,n,r){return la(t,"value",e,n,r)}function tD(t,e,n,r){return la(t,"child_added",e,n,r)}function nD(t,e,n,r){return la(t,"child_changed",e,n,r)}function rD(t,e,n,r){return la(t,"child_moved",e,n,r)}function sD(t,e,n,r){return la(t,"child_removed",e,n,r)}function iD(t,e,n){let r=null;const s=n?new Qf(n):null;e==="value"?r=new aa(s):e&&(r=new Oc(e,s)),ih(t._repo,t,r)}class wn{}class Q_ extends wn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Rn("endAt",this._value,e._path,!0);const n=Yd(e._queryParams,this._value,this._key);if(jc(n),Hr(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}}function oD(t,e){return ia("endAt","key",e,!0),new Q_(t,e)}class jC extends wn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Rn("endBefore",this._value,e._path,!1);const n=KN(e._queryParams,this._value,this._key);if(jc(n),Hr(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}}function aD(t,e){return ia("endBefore","key",e,!0),new jC(t,e)}class J_ extends wn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Rn("startAt",this._value,e._path,!0);const n=Kd(e._queryParams,this._value,this._key);if(jc(n),Hr(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}}function lD(t=null,e){return ia("startAt","key",e,!0),new J_(t,e)}class OC extends wn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Rn("startAfter",this._value,e._path,!1);const n=qN(e._queryParams,this._value,this._key);if(jc(n),Hr(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new qt(e._repo,e._path,n,e._orderByCalled)}}function cD(t,e){return ia("startAfter","key",e,!0),new OC(t,e)}class LC extends wn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new qt(e._repo,e._path,HN(e._queryParams,this._limit),e._orderByCalled)}}function uD(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new LC(t)}class MC extends wn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new qt(e._repo,e._path,GN(e._queryParams,this._limit),e._orderByCalled)}}function dD(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new MC(t)}class FC extends wn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Dc(e,"orderByChild");const n=new ce(this._path);if(te(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new Sf(n),s=wc(e._queryParams,r);return Hr(s),new qt(e._repo,e._path,s,!0)}}function hD(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Hf("orderByChild","path",t,!1),new FC(t)}class UC extends wn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Dc(e,"orderByKey");const n=wc(e._queryParams,Tn);return Hr(n),new qt(e._repo,e._path,n,!0)}}function fD(){return new UC}class $C extends wn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Dc(e,"orderByPriority");const n=wc(e._queryParams,we);return Hr(n),new qt(e._repo,e._path,n,!0)}}function pD(){return new $C}class BC extends wn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Dc(e,"orderByValue");const n=wc(e._queryParams,Ef);return Hr(n),new qt(e._repo,e._path,n,!0)}}function mD(){return new BC}class VC extends wn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Rn("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Q_(this._value,this._key)._apply(new J_(this._value,this._key)._apply(e))}}function gD(t,e){return ia("equalTo","key",e,!0),new VC(t,e)}function yD(t,...e){let n=H(t);for(const r of e)n=r._apply(n);return n}L1(_n);B1(_n);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="FIREBASE_DATABASE_EMULATOR_HOST",lh={};let X_=!1;function zC(t,e,n,r){const s=e.lastIndexOf(":"),i=e.substring(0,s),o=xi(i);t.repoInfo_=new Xv(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(t.authTokenProvider_=r)}function Z_(t,e,n,r,s){let i=r||t.options.databaseURL;i===void 0&&(t.options.projectId||Pn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Xe("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=oh(i,s),l=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[WC]),u?(c=!0,i=`http://${u}?ns=${l.namespace}`,o=oh(i,s),l=o.repoInfo):c=!o.repoInfo.secure;const d=s&&c?new Zs(Zs.OWNER):new QI(t.name,t.options,e);F_("Invalid Firebase Database URL",o),te(o.path)||Pn("Database URL must point to the root of a Firebase Database (not including a child path).");const h=GC(l,t,d,new YI(t,n));return new KC(h,t)}function HC(t,e){const n=lh[e];(!n||n[t.key]!==t)&&Pn(`Database ${e}(${t.repoInfo_}) has already been deleted.`),W_(t),delete n[t.key]}function GC(t,e,n,r){let s=lh[e.name];s||(s={},lh[e.name]=s);let i=s[t.toURLString()];return i&&Pn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new pC(t,X_,n,r),s[t.toURLString()]=i,i}function qC(t){X_=t}class KC{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(mC(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new _n(this._repo,le())),this._rootInternal}_delete(){return this._rootInternal!==null&&(HC(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pn("Cannot call "+e+" on a deleted database.")}}function ew(){di.IS_TRANSPORT_INITIALIZED&&ft("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function vD(){ew(),_r.forceDisallow()}function _D(){ew(),Jt.forceDisallow(),_r.forceAllow()}function YC(t=yc(),e){const n=Ss(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=cE("database");r&&QC(n,...r)}return n}function QC(t,e,n,r={}){t=H(t),t._checkNotDeleted("useEmulator");const s=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(s===t._repoInternal.repoInfo_.host&&Lr(r,i.repoInfo_.emulatorOptions))return;Pn("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Pn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Zs(Zs.OWNER);else if(r.mockUserToken){const l=typeof r.mockUserToken=="string"?r.mockUserToken:uE(r.mockUserToken,t.app.options.projectId);o=new Zs(l)}xi(e)&&(bv(e),Sv("Database",!0)),zC(i,s,r,o)}function wD(t){t=H(t),t._checkNotDeleted("goOffline"),W_(t._repo)}function xD(t){t=H(t),t._checkNotDeleted("goOnline"),EC(t._repo)}function bD(t,e){$v(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t){Lv(bi),kn(new Wt("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Z_(r,s,i,n)},"PUBLIC").setMultipleInstances(!0)),tn(Hm,Gm,t),tn(Hm,Gm,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC={".sv":"timestamp"};function SD(){return XC}function ED(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function ID(t,e,n){if(t=H(t),En("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(n==null?void 0:n.applyLocally)??!0,s=new Ft,i=(l,c,u)=>{let d=null;l?s.reject(l):(d=new gs(u,new _n(t._repo,t._path),we),s.resolve(new ZC(c,d)))},o=ah(t,()=>{});return IC(t._repo,t._path,e,i,o,r),s.promise}nn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};nn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};const ND=function(t){const e=nn.prototype.put;return nn.prototype.put=function(n,r,s,i){i!==void 0&&(i=t()),e.call(this,n,r,s,i)},function(){nn.prototype.put=e}},CD=function(t){qC(t)};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:s,nodeAdmin:i=!1}){Lv(n);const o=new Tv("database-standalone"),l=new Fd("auth-internal",o);let c;return s&&(c=new Fd("app-check-internal",o),c.setComponent(new Wt("app-check-internal",()=>s,"PRIVATE"))),l.setComponent(new Wt("auth-internal",()=>r,"PRIVATE")),Z_(t,l,c,e,i)}JC();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD={PHONE:"phone",TOTP:"totp"},PD={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},RD={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},AD={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},DD={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function tw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jD=eT,tT=tw,nw=new xs("auth","Firebase",tw()),OD={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type",INVALID_HOSTING_LINK_DOMAIN:"auth/invalid-hosting-link-domain"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl=new gc("@firebase/auth");function nT(t,...e){Gl.logLevel<=fe.WARN&&Gl.warn(`Auth (${bi}): ${t}`,...e)}function el(t,...e){Gl.logLevel<=fe.ERROR&&Gl.error(`Auth (${bi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ot(t,...e){throw Xf(t,...e)}function _t(t,...e){return Xf(t,...e)}function Jf(t,e,n){const r={...tT(),[e]:n};return new xs("auth","Firebase",r).create(e,{appName:t.name})}function et(t){return Jf(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ci(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ot(t,"argument-error"),Jf(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nw.create(t,...e)}function j(t,e,...n){if(!t)throw Xf(e,...n)}function In(t){const e="INTERNAL ASSERTION FAILED: "+t;throw el(e),new Error(e)}function Zn(t,e){t||In(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vo(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function Zf(){return Eg()==="http:"||Eg()==="https:"}function Eg(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Zf()||df()||"connection"in navigator)?navigator.onLine:!0}function sT(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{constructor(e,n){this.shortDelay=e,this.longDelay=n,Zn(n>e,"Short delay should be less than long delay!"),this.isMobile=uf()||Ev()}get(){return rT()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;In("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;In("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;In("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aT=new ca(3e4,6e4);function Ee(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ie(t,e,n,r,s={}){return sw(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=bs({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:c,...i};return fE()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&xi(t.emulatorConfig.host)&&(u.credentials="include"),rw.fetch()(await iw(t,t.config.apiHost,n,l),u)})}async function sw(t,e,n){t._canInitEmulator=!1;const r={...iT,...e};try{const s=new cT(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ki(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ki(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ki(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ki(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Jf(t,d,u);Ot(t,d)}}catch(s){if(s instanceof An)throw s;Ot(t,"network-request-failed",{message:String(s)})}}async function rr(t,e,n,r,s={}){const i=await Ie(t,e,n,r,s);return"mfaPendingCredential"in i&&Ot(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function iw(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ep(t.config,s):`${t.config.apiScheme}://${s}`;return oT.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function lT(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class cT{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(_t(this.auth,"network-request-failed")),aT.get())})}}function Ki(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=_t(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t){return t!==void 0&&t.getResponse!==void 0}function Ng(t){return t!==void 0&&t.enterprise!==void 0}class ow{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return lT(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uT(t){return(await Ie(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function aw(t,e){return Ie(t,"GET","/v2/recaptchaConfig",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dT(t,e){return Ie(t,"POST","/v1/accounts:delete",e)}async function hT(t,e){return Ie(t,"POST","/v1/accounts:update",e)}async function ql(t,e){return Ie(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(t,e=!1){return H(t).getIdToken(e)}async function fT(t,e=!1){const n=H(t),r=await n.getIdToken(e),s=Lc(r);j(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:uo(Ou(s.auth_time)),issuedAtTime:uo(Ou(s.iat)),expirationTime:uo(Ou(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ou(t){return Number(t)*1e3}function Lc(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return el("JWT malformed, contained fewer than 3 sections"),null;try{const s=Pl(n);return s?JSON.parse(s):(el("Failed to decode base64 JWT payload"),null)}catch(s){return el("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Cg(t){const e=Lc(t);return j(e,"internal-error"),j(typeof e.exp<"u","internal-error"),j(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function er(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof An&&pT(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function pT({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=uo(this.lastLoginAt),this.creationTime=uo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t){var h;const e=t.auth,n=await t.getIdToken(),r=await er(t,ql(e,{idToken:n}));j(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(h=s.providerUserInfo)!=null&&h.length?lw(s.providerUserInfo):[],o=yT(t.providerData,i),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ch(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(t,d)}async function gT(t){const e=H(t);await Wo(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yT(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function lw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vT(t,e){const n=await sw(t,{},async()=>{const r=bs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await iw(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:r};return t.emulatorConfig&&xi(t.emulatorConfig.host)&&(c.credentials="include"),rw.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function _T(t,e){return Ie(t,"POST","/v2/accounts:revokeToken",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){j(e.idToken,"internal-error"),j(typeof e.idToken<"u","internal-error"),j(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){j(e.length!==0,"internal-error");const n=Cg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(j(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await vT(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new ei;return r&&(j(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(j(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(j(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ei,this.toJSON())}_performRefresh(){return In("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(t,e){j(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new mT(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ch(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await er(this,this.stsTokenManager.getToken(this.auth,e));return j(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return fT(this,e)}reload(){return gT(this)}_assign(e){this!==e&&(j(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Wo(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ae(this.auth.app))return Promise.reject(et(this.auth));const e=await this.getIdToken();return await er(this,dT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,l=n.tenantId??void 0,c=n._redirectEventId??void 0,u=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:h,emailVerified:f,isAnonymous:g,providerData:_,stsTokenManager:x}=n;j(h&&x,e,"internal-error");const M=ei.fromJSON(this.name,x);j(typeof h=="string",e,"internal-error"),lr(r,e.name),lr(s,e.name),j(typeof f=="boolean",e,"internal-error"),j(typeof g=="boolean",e,"internal-error"),lr(i,e.name),lr(o,e.name),lr(l,e.name),lr(c,e.name),lr(u,e.name),lr(d,e.name);const m=new fn({uid:h,auth:e,email:s,emailVerified:f,displayName:r,isAnonymous:g,photoURL:o,phoneNumber:i,tenantId:l,stsTokenManager:M,createdAt:u,lastLoginAt:d});return _&&Array.isArray(_)&&(m.providerData=_.map(p=>({...p}))),c&&(m._redirectEventId=c),m}static async _fromIdTokenResponse(e,n,r=!1){const s=new ei;s.updateFromServerResponse(n);const i=new fn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Wo(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];j(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?lw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new ei;l.updateFromIdToken(r);const c=new fn({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ch(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tg=new Map;function Wn(t){Zn(t instanceof Function,"Expected a class definition");let e=Tg.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Tg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}cw.type="NONE";const kg=cw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tl(t,e,n){return`firebase:${t}:${e}:${n}`}class ti{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=tl(this.userKey,s.apiKey,i),this.fullPersistenceKey=tl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ql(this.auth,{idToken:e}).catch(()=>{});return n?fn._fromGetAccountInfoResponse(this.auth,n,e):null}return fn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ti(Wn(kg),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Wn(kg);const o=tl(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await ql(e,{idToken:d}).catch(()=>{});if(!f)break;h=await fn._fromGetAccountInfoResponse(e,f,d)}else h=fn._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ti(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new ti(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mw(e))return"Blackberry";if(gw(e))return"Webos";if(dw(e))return"Safari";if((e.includes("chrome/")||hw(e))&&!e.includes("edge/"))return"Chrome";if(pw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function uw(t=wt()){return/firefox\//i.test(t)}function dw(t=wt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hw(t=wt()){return/crios\//i.test(t)}function fw(t=wt()){return/iemobile/i.test(t)}function pw(t=wt()){return/android/i.test(t)}function mw(t=wt()){return/blackberry/i.test(t)}function gw(t=wt()){return/webos/i.test(t)}function tp(t=wt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wT(t=wt()){var e;return tp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function xT(){return pE()&&document.documentMode===10}function yw(t=wt()){return tp(t)||pw(t)||gw(t)||mw(t)||/windows phone/i.test(t)||fw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t,e=[]){let n;switch(t){case"Browser":n=Pg(wt());break;case"Worker":n=`${Pg(wt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${bi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e={}){return Ie(t,"GET","/v2/passwordPolicy",Ee(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET=6;class IT{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ET,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rg(this),this.idTokenSubscription=new Rg(this),this.beforeStateQueue=new bT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wn(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ti.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ql(this,{idToken:e}),r=await fn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Ae(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return j(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Wo(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sT()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ae(this.app))return Promise.reject(et(this));const n=e?H(e):null;return n&&j(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&j(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ae(this.app)?Promise.reject(et(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ae(this.app)?Promise.reject(et(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ST(this),n=new IT(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xs("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await _T(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wn(e)||this._popupRedirectResolver;j(n,this,"argument-error"),this.redirectPersistenceManager=await ti.create(this,[Wn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(j(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=vw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Ae(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&nT(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Fe(t){return H(t)}class Rg{constructor(e){this.auth=e,this.observer=null,this.addObserver=xE(n=>this.observer=n)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ua={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CT(t){ua=t}function np(t){return ua.loadJS(t)}function TT(){return ua.recaptchaV2Script}function kT(){return ua.recaptchaEnterpriseScript}function PT(){return ua.gapiScript}function _w(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=500,AT=6e4,Fa=1e12;class DT{constructor(e){this.auth=e,this.counter=Fa,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new LT(e,this.auth.name,n||{})),this.counter++,r}reset(e){var r;const n=e||Fa;(r=this._widgets.get(n))==null||r.delete(),this._widgets.delete(n)}getResponse(e){var r;const n=e||Fa;return((r=this._widgets.get(n))==null?void 0:r.getResponse())||""}async execute(e){var r;const n=e||Fa;return(r=this._widgets.get(n))==null||r.execute(),""}}class jT{constructor(){this.enterprise=new OT}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class OT{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class LT{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;j(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=MT(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},AT)},RT))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function MT(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}const FT="recaptcha-enterprise",ho="NO_RECAPTCHA";class ww{constructor(e){this.type=FT,this.auth=Fe(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{aw(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new ow(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;Ng(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(ho)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jT().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&Ng(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=kT();c.length!==0&&(c+=l),np(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function Bi(t,e,n,r=!1,s=!1){const i=new ww(t);let o;if(s)o=ho;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Dr(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Bi(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Bi(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if((o=t._getRecaptchaConfig())!=null&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await Bi(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())==null?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await Bi(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await Bi(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}async function xw(t){const e=Fe(t),n=await aw(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new ow(n);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new ww(e).verify()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(t,e){const n=Ss(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Lr(i,e??{}))return s;Ot(s,"already-initialized")}return n.initialize({options:e})}function $T(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function BT(t,e,n){const r=Fe(t);j(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=bw(e),{host:o,port:l}=VT(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){j(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),j(Lr(u,r.config.emulator)&&Lr(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,xi(o)?(bv(`${i}//${o}${c}`),Sv("Auth",!0)):s||WT()}function bw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function VT(t){const e=bw(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Ag(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Ag(o)}}}function Ag(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function WT(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return In("not implemented")}_getIdTokenResponse(e){return In("not implemented")}_linkToIdToken(e,n){return In("not implemented")}_getReauthenticationResolver(e){return In("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sw(t,e){return Ie(t,"POST","/v1/accounts:resetPassword",Ee(t,e))}async function zT(t,e){return Ie(t,"POST","/v1/accounts:update",e)}async function HT(t,e){return Ie(t,"POST","/v1/accounts:signUp",e)}async function GT(t,e){return Ie(t,"POST","/v1/accounts:update",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qT(t,e){return rr(t,"POST","/v1/accounts:signInWithPassword",Ee(t,e))}async function Mc(t,e){return Ie(t,"POST","/v1/accounts:sendOobCode",Ee(t,e))}async function KT(t,e){return Mc(t,e)}async function YT(t,e){return Mc(t,e)}async function QT(t,e){return Mc(t,e)}async function JT(t,e){return Mc(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XT(t,e){return rr(t,"POST","/v1/accounts:signInWithEmailLink",Ee(t,e))}async function ZT(t,e){return rr(t,"POST","/v1/accounts:signInWithEmailLink",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends da{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new zo(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new zo(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dr(e,n,"signInWithPassword",qT,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return XT(e,{email:this._email,oobCode:this._password});default:Ot(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Dr(e,r,"signUpPassword",HT,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return ZT(e,{idToken:n,email:this._email,oobCode:this._password});default:Ot(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gn(t,e){return rr(t,"POST","/v1/accounts:signInWithIdp",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek="http://localhost";class tr extends da{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new tr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ot("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new tr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Gn(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Gn(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Gn(e,n)}buildRequest(){const e={requestUri:ek,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=bs(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dg(t,e){return Ie(t,"POST","/v1/accounts:sendVerificationCode",Ee(t,e))}async function tk(t,e){return rr(t,"POST","/v1/accounts:signInWithPhoneNumber",Ee(t,e))}async function nk(t,e){const n=await rr(t,"POST","/v1/accounts:signInWithPhoneNumber",Ee(t,e));if(n.temporaryProof)throw Ki(t,"account-exists-with-different-credential",n);return n}const rk={USER_NOT_FOUND:"user-not-found"};async function sk(t,e){const n={...e,operation:"REAUTH"};return rr(t,"POST","/v1/accounts:signInWithPhoneNumber",Ee(t,n),rk)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends da{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new os({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new os({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return tk(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return nk(e,{idToken:n,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return sk(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!n&&!s&&!i?null:new os({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ik(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ok(t){const e=Gi(qi(t)).link,n=e?Gi(qi(e)).deep_link_id:null,r=Gi(qi(t)).deep_link_id;return(r?Gi(qi(r)).link:null)||r||n||e||t}class ha{constructor(e){const n=Gi(qi(e)),r=n.apiKey??null,s=n.oobCode??null,i=ik(n.mode??null);j(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=ok(e);try{return new ha(n)}catch{return null}}}function MD(t){return ha.parseLink(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(){this.providerId=Cs.PROVIDER_ID}static credential(e,n){return zo._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ha.parseLink(n);return j(r,"argument-error"),zo._fromEmailAndCode(e,r.code,r.tenantId)}}Cs.PROVIDER_ID="password";Cs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Cs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends sr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class nl extends Ti{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return j("providerId"in n&&"signInMethod"in n,"argument-error"),tr._fromParams(n)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return j(e.idToken||e.accessToken,"argument-error"),tr._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return nl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return nl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:l}=e;if(!r&&!s&&!n&&!i||!l)return null;try{return new nl(l)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr extends Ti{constructor(){super("facebook.com")}static credential(e){return tr._fromParams({providerId:pr.PROVIDER_ID,signInMethod:pr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return pr.credential(e.oauthAccessToken)}catch{return null}}}pr.FACEBOOK_SIGN_IN_METHOD="facebook.com";pr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un extends Ti{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return tr._fromParams({providerId:Un.PROVIDER_ID,signInMethod:Un.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Un.credentialFromTaggedObject(e)}static credentialFromError(e){return Un.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Un.credential(n,r)}catch{return null}}}Un.GOOGLE_SIGN_IN_METHOD="google.com";Un.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr extends Ti{constructor(){super("github.com")}static credential(e){return tr._fromParams({providerId:mr.PROVIDER_ID,signInMethod:mr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mr.credentialFromTaggedObject(e)}static credentialFromError(e){return mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mr.credential(e.oauthAccessToken)}catch{return null}}}mr.GITHUB_SIGN_IN_METHOD="github.com";mr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak="http://localhost";class Ho extends da{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Gn(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Gn(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Gn(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=n;return!r||!s||!i||r!==s?null:new Ho(r,i)}static _create(e,n){return new Ho(e,n)}buildRequest(){return{requestUri:ak,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk="saml.";class uh extends sr{constructor(e){j(e.startsWith(lk),"argument-error"),super(e)}static credentialFromResult(e){return uh.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return uh.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Ho.fromJSON(e);return j(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Ho._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr extends Ti{constructor(){super("twitter.com")}static credential(e,n){return tr._fromParams({providerId:gr.PROVIDER_ID,signInMethod:gr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return gr.credentialFromTaggedObject(e)}static credentialFromError(e){return gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return gr.credential(n,r)}catch{return null}}}gr.TWITTER_SIGN_IN_METHOD="twitter.com";gr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ew(t,e){return rr(t,"POST","/v1/accounts:signUp",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await fn._fromIdTokenResponse(e,r,s),o=jg(r);return new on({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=jg(r);return new on({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function jg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FD(t){var s;if(Ae(t.app))return Promise.reject(et(t));const e=Fe(t);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new on({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await Ew(e,{returnSecureToken:!0}),r=await on._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl extends An{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Kl.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Kl(e,n,r,s)}}function Iw(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Kl._fromErrorAndOperation(t,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UD(t,e){const n=H(t);await Fc(!0,n,e);const{providerUserInfo:r}=await hT(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),s=Nw(r||[]);return n.providerData=n.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function rp(t,e,n=!1){const r=await er(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return on._forOperation(t,"link",r)}async function Fc(t,e,n){await Wo(e);const r=Nw(e.providerData),s=t===!1?"provider-already-linked":"no-such-provider";j(r.has(n)===t,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cw(t,e,n=!1){const{auth:r}=t;if(Ae(r.app))return Promise.reject(et(r));const s="reauthenticate";try{const i=await er(t,Iw(r,s,e,t),n);j(i.idToken,r,"internal-error");const o=Lc(i.idToken);j(o,r,"internal-error");const{sub:l}=o;return j(t.uid===l,r,"user-mismatch"),on._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ot(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tw(t,e,n=!1){if(Ae(t.app))return Promise.reject(et(t));const r="signIn",s=await Iw(t,r,e),i=await on._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function sp(t,e){return Tw(Fe(t),e)}async function ck(t,e){const n=H(t);return await Fc(!1,n,e.providerId),rp(n,e)}async function uk(t,e){return Cw(H(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(t,e){return rr(t,"POST","/v1/accounts:signInWithCustomToken",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $D(t,e){if(Ae(t.app))return Promise.reject(et(t));const n=Fe(t),r=await dk(n,{token:e,returnSecureToken:!0}),s=await on._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?ip._fromServerResponse(e,n):"totpInfo"in n?op._fromServerResponse(e,n):Ot(e,"internal-error")}}class ip extends fa{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new ip(n)}}class op extends fa{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new op(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(t,e,n){var r;j(((r=n.url)==null?void 0:r.length)>0,t,"invalid-continue-uri"),j(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),j(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(j(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(j(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ap(t){const e=Fe(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function hk(t,e,n){const r=Fe(t),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};n&&Uc(r,s,n),await Dr(r,s,"getOobCode",YT,"EMAIL_PASSWORD_PROVIDER")}async function BD(t,e,n){await Sw(H(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ap(t),r})}async function VD(t,e){await GT(H(t),{oobCode:e})}async function fk(t,e){const n=H(t),r=await Sw(n,{oobCode:e}),s=r.requestType;switch(j(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":j(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":j(r.mfaInfo,n,"internal-error");default:j(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=fa._fromServerResponse(Fe(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function WD(t,e){const{data:n}=await fk(H(t),e);return n.email}async function pk(t,e,n){if(Ae(t.app))return Promise.reject(et(t));const r=Fe(t),o=await Dr(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ew,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&ap(t),c}),l=await on._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function mk(t,e,n){return Ae(t.app)?Promise.reject(et(t)):sp(H(t),Cs.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ap(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zD(t,e,n){const r=Fe(t),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,l){j(l.handleCodeInApp,r,"argument-error"),l&&Uc(r,o,l)}i(s,n),await Dr(r,s,"getOobCode",QT,"EMAIL_PASSWORD_PROVIDER")}function HD(t,e){const n=ha.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function GD(t,e,n){if(Ae(t.app))return Promise.reject(et(t));const r=H(t),s=Cs.credentialWithLink(e,n||Vo());return j(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),sp(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gk(t,e){return Ie(t,"POST","/v1/accounts:createAuthUri",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(t,e){const n=Zf()?Vo():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await gk(H(t),r);return s||[]}async function yk(t,e){const n=H(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&Uc(n.auth,s,e);const{email:i}=await KT(n.auth,s);i!==t.email&&await t.reload()}async function KD(t,e,n){const r=H(t),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&Uc(r.auth,i,n);const{email:o}=await JT(r.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vk(t,e){return Ie(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=H(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await er(r,vk(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function QD(t,e){const n=H(t);return Ae(n.auth.app)?Promise.reject(et(n.auth)):kw(n,e,null)}function JD(t,e){return kw(H(t),null,e)}async function kw(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await er(t,zT(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t){var s,i;if(!t)return null;const{providerId:e}=t,n=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},r=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&(t!=null&&t.idToken)){const o=(i=(s=Lc(t.idToken))==null?void 0:s.firebase)==null?void 0:i.sign_in_provider;if(o){const l=o!=="anonymous"&&o!=="custom"?o:null;return new ni(r,l)}}if(!e)return null;switch(e){case"facebook.com":return new wk(r,n);case"github.com":return new xk(r,n);case"google.com":return new bk(r,n);case"twitter.com":return new Sk(r,n,t.screenName||null);case"custom":case"anonymous":return new ni(r,null);default:return new ni(r,e,n)}}class ni{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class Pw extends ni{constructor(e,n,r,s){super(e,n,r),this.username=s}}class wk extends ni{constructor(e,n){super(e,"facebook.com",n)}}class xk extends Pw{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class bk extends ni{constructor(e,n){super(e,"google.com",n)}}class Sk extends Pw{constructor(e,n,r){super(e,"twitter.com",n,r)}}function XD(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:_k(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t,e){return H(t).setPersistence(e)}function ZD(t){return xw(t)}async function e2(t,e){return Fe(t).validatePassword(e)}function Ik(t,e,n,r){return H(t).onIdTokenChanged(e,n,r)}function Nk(t,e,n){return H(t).beforeAuthStateChanged(e,n)}function t2(t,e,n,r){return H(t).onAuthStateChanged(e,n,r)}function n2(t){H(t).useDeviceLanguage()}function r2(t,e){return H(t).updateCurrentUser(e)}function s2(t){return H(t).signOut()}function i2(t,e){return Fe(t).revokeAccessToken(e)}async function o2(t){return H(t).delete()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e,n,r){this.type=e,this.credential=n,this.user=r}static _fromIdtoken(e,n){return new es("enroll",e,n)}static _fromMfaPendingCredential(e){return new es("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if((n=e.multiFactorSession)!=null&&n.pendingCredential)return es._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if((r=e.multiFactorSession)!=null&&r.idToken)return es._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Fe(e),s=n.customData._serverResponse,i=(s.mfaInfo||[]).map(l=>fa._fromServerResponse(r,l));j(s.mfaPendingCredential,r,"internal-error");const o=es._fromMfaPendingCredential(s.mfaPendingCredential);return new lp(o,i,async l=>{const c=await l._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const u={...s,idToken:c.idToken,refreshToken:c.refreshToken};switch(n.operationType){case"signIn":const d=await on._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return j(n.user,r,"internal-error"),on._forOperation(n.user,n.operationType,u);default:Ot(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function a2(t,e){var s;const n=H(t),r=e;return j(e.customData.operationType,n,"argument-error"),j((s=r.customData._serverResponse)==null?void 0:s.mfaPendingCredential,n,"argument-error"),lp._fromError(n,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Og(t,e){return Ie(t,"POST","/v2/accounts/mfaEnrollment:start",Ee(t,e))}function Ck(t,e){return Ie(t,"POST","/v2/accounts/mfaEnrollment:finalize",Ee(t,e))}function Tk(t,e){return Ie(t,"POST","/v2/accounts/mfaEnrollment:start",Ee(t,e))}function kk(t,e){return Ie(t,"POST","/v2/accounts/mfaEnrollment:finalize",Ee(t,e))}function Pk(t,e){return Ie(t,"POST","/v2/accounts/mfaEnrollment:withdraw",Ee(t,e))}class cp{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>fa._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new cp(e)}async getSession(){return es._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,n){const r=e,s=await this.getSession(),i=await er(this.user,r._process(this.user.auth,s,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await er(this.user,Pk(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==n),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const Lu=new WeakMap;function l2(t){const e=H(t);return Lu.has(e)||Lu.set(e,cp._fromUser(e)),Lu.get(e)}const Yl="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Yl,"1"),this.storage.removeItem(Yl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rk=1e3,Ak=10;class Aw extends Rw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=yw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);xT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Ak):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Rk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Aw.type="LOCAL";const Dw=Aw;/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dk=1e3;function Mu(t){var r;const e=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${e}=([^;]+)`);return((r=document.cookie.match(n))==null?void 0:r[1])??null}function Fu(t){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${t.split(":")[3]}`}class jw{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;const n=new URL(`${window.location.origin}/__cookies__`);return n.searchParams.set("finalTarget",e),n}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,n){}async _get(e){if(!this._isAvailable())return null;const n=Fu(e);if(window.cookieStore){const r=await window.cookieStore.get(n);return r==null?void 0:r.value}return Mu(n)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;const r=Fu(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,n){if(!this._isAvailable())return;const r=Fu(e);if(window.cookieStore){const l=u=>{const d=u.changed.find(f=>f.name===r);d&&n(d.value),u.deleted.find(f=>f.name===r)&&n(null)},c=()=>window.cookieStore.removeEventListener("change",l);return this.listenerUnsubscribes.set(n,c),window.cookieStore.addEventListener("change",l)}let s=Mu(r);const i=setInterval(()=>{const l=Mu(r);l!==s&&(n(l),s=l)},Dk),o=()=>clearInterval(i);this.listenerUnsubscribes.set(n,o)}_removeListener(e,n){const r=this.listenerUnsubscribes.get(n);r&&(r(),this.listenerUnsubscribes.delete(n))}}jw.type="COOKIE";const c2=jw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow extends Rw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Ow.type="SESSION";const Lw=Ow;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new $c(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await jk(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$c.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=Bc("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Be(){return window}function Lk(t){Be().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(){return typeof Be().WorkerGlobalScope<"u"&&typeof Be().importScripts=="function"}async function Mk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Uk(){return up()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mw="firebaseLocalStorageDb",$k=1,Ql="firebaseLocalStorage",Fw="fbase_key";class pa{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Vc(t,e){return t.transaction([Ql],e?"readwrite":"readonly").objectStore(Ql)}function Bk(){const t=indexedDB.deleteDatabase(Mw);return new pa(t).toPromise()}function dh(){const t=indexedDB.open(Mw,$k);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ql,{keyPath:Fw})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ql)?e(r):(r.close(),await Bk(),e(await dh()))})})}async function Lg(t,e,n){const r=Vc(t,!0).put({[Fw]:e,value:n});return new pa(r).toPromise()}async function Vk(t,e){const n=Vc(t,!1).get(e),r=await new pa(n).toPromise();return r===void 0?null:r.value}function Mg(t,e){const n=Vc(t,!0).delete(e);return new pa(n).toPromise()}const Wk=800,zk=3;class Uw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await dh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>zk)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return up()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$c._getInstance(Uk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Mk(),!this.activeServiceWorker)return;this.sender=new Ok(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await dh();return await Lg(e,Yl,"1"),await Mg(e,Yl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Lg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Vk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Vc(s,!1).getAll();return new pa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Uw.type="LOCAL";const Hk=Uw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t,e){return Ie(t,"POST","/v2/accounts/mfaSignIn:start",Ee(t,e))}function Gk(t,e){return Ie(t,"POST","/v2/accounts/mfaSignIn:finalize",Ee(t,e))}function qk(t,e){return Ie(t,"POST","/v2/accounts/mfaSignIn:finalize",Ee(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=_w("rcb"),Kk=new ca(3e4,6e4);class Yk{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!((e=Be().grecaptcha)!=null&&e.render)}load(e,n=""){return j(Qk(n),e,"argument-error"),this.shouldResolveImmediately(n)&&Ig(Be().grecaptcha)?Promise.resolve(Be().grecaptcha):new Promise((r,s)=>{const i=Be().setTimeout(()=>{s(_t(e,"network-request-failed"))},Kk.get());Be()[Uu]=()=>{Be().clearTimeout(i),delete Be()[Uu];const l=Be().grecaptcha;if(!l||!Ig(l)){s(_t(e,"internal-error"));return}const c=l.render;l.render=(u,d)=>{const h=c(u,d);return this.counter++,h},this.hostLanguage=n,r(l)};const o=`${TT()}?${bs({onload:Uu,render:"explicit",hl:n})}`;np(o).catch(()=>{clearTimeout(i),s(_t(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!((n=Be().grecaptcha)!=null&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Qk(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class Jk{async load(e){return new DT(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="recaptcha",Xk={theme:"light",type:"image"};class u2{constructor(e,n,r={...Xk}){this.parameters=r,this.type=fo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Fe(e),this.isInvisible=this.parameters.size==="invisible",j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof n=="string"?document.getElementById(n):n;j(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Jk:new Yk,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){j(!this.parameters.sitekey,this.auth,"argument-error"),j(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=Be()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){j(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){j(Zf()&&!up(),this.auth,"internal-error"),await Zk(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await uT(this.auth);j(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return j(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function Zk(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=os._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function d2(t,e,n){if(Ae(t.app))return Promise.reject(et(t));const r=Fe(t),s=await Wc(r,e,H(n));return new dp(s,i=>sp(r,i))}async function h2(t,e,n){const r=H(t);await Fc(!1,r,"phone");const s=await Wc(r.auth,e,H(n));return new dp(s,i=>ck(r,i))}async function f2(t,e,n){const r=H(t);if(Ae(r.auth.app))return Promise.reject(et(r.auth));const s=await Wc(r.auth,e,H(n));return new dp(s,i=>uk(r,i))}async function Wc(t,e,n){var r;if(!t._getRecaptchaConfig())try{await xw(t)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){const i=s.session;if("phoneNumber"in s){j(i.type==="enroll",t,"internal-error");const o={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Dr(t,o,"mfaSmsEnrollment",async(d,h)=>{if(h.phoneEnrollmentInfo.captchaResponse===ho){j((n==null?void 0:n.type)===fo,d,"argument-error");const f=await $u(d,h,n);return Og(d,f)}return Og(d,h)},"PHONE_PROVIDER").catch(d=>Promise.reject(d))).phoneSessionInfo.sessionInfo}else{j(i.type==="signin",t,"internal-error");const o=((r=s.multiFactorHint)==null?void 0:r.uid)||s.multiFactorUid;j(o,t,"missing-multi-factor-info");const l={mfaPendingCredential:i.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Dr(t,l,"mfaSmsSignIn",async(h,f)=>{if(f.phoneSignInInfo.captchaResponse===ho){j((n==null?void 0:n.type)===fo,h,"argument-error");const g=await $u(h,f,n);return Fg(h,g)}return Fg(h,f)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneResponseInfo.sessionInfo}}else{const i={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Dr(t,i,"sendVerificationCode",async(u,d)=>{if(d.captchaResponse===ho){j((n==null?void 0:n.type)===fo,u,"argument-error");const h=await $u(u,d,n);return Dg(u,h)}return Dg(u,d)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).sessionInfo}}finally{n==null||n._reset()}}async function p2(t,e){const n=H(t);if(Ae(n.auth.app))return Promise.reject(et(n.auth));await rp(n,e)}async function $u(t,e,n){j(n.type===fo,t,"argument-error");const r=await n.verify();j(typeof r=="string",t,"argument-error");const s={...e};if("phoneEnrollmentInfo"in s){const i=s.phoneEnrollmentInfo.phoneNumber,o=s.phoneEnrollmentInfo.captchaResponse,l=s.phoneEnrollmentInfo.clientType,c=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:i,recaptchaToken:r,captchaResponse:o,clientType:l,recaptchaVersion:c}}),s}else if("phoneSignInInfo"in s){const i=s.phoneSignInInfo.captchaResponse,o=s.phoneSignInInfo.clientType,l=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:i,clientType:o,recaptchaVersion:l}}),s}else return Object.assign(s,{recaptchaToken:r}),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.providerId=ri.PROVIDER_ID,this.auth=Fe(e)}verifyPhoneNumber(e,n){return Wc(this.auth,e,H(n))}static credential(e,n){return os._fromVerification(e,n)}static credentialFromResult(e){const n=e;return ri.credentialFromTaggedObject(n)}static credentialFromError(e){return ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?os._fromTokenResponse(n,r):null}}ri.PROVIDER_ID="phone";ri.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(t,e){return e?Wn(e):(j(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp extends da{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gn(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Gn(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Gn(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eP(t){return Tw(t.auth,new hp(t),t.bypassAuthState)}function tP(t){const{auth:e,user:n}=t;return j(n,e,"internal-error"),Cw(n,new hp(t),t.bypassAuthState)}async function nP(t){const{auth:e,user:n}=t;return j(n,e,"internal-error"),rp(n,new hp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eP;case"linkViaPopup":case"linkViaRedirect":return nP;case"reauthViaPopup":case"reauthViaRedirect":return tP;default:Ot(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=new ca(2e3,1e4);async function sP(t,e,n){if(Ae(t.app))return Promise.reject(_t(t,"operation-not-supported-in-this-environment"));const r=Fe(t);Ci(t,e,sr);const s=Ts(r,n);return new zn(r,"signInViaPopup",e,s).executeNotNull()}async function m2(t,e,n){const r=H(t);if(Ae(r.auth.app))return Promise.reject(_t(r.auth,"operation-not-supported-in-this-environment"));Ci(r.auth,e,sr);const s=Ts(r.auth,n);return new zn(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function g2(t,e,n){const r=H(t);Ci(r.auth,e,sr);const s=Ts(r.auth,n);return new zn(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class zn extends $w{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,zn.currentPopupAction&&zn.currentPopupAction.cancel(),zn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return j(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=Bc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(_t(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(_t(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_t(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rP.get())};e()}}zn.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iP="pendingRedirect",rl=new Map;class oP extends $w{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=rl.get(this.auth._key());if(!e){try{const r=await aP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}rl.set(this.auth._key(),e)}return this.bypassAuthState||rl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aP(t,e){const n=Vw(e),r=Bw(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}async function fp(t,e){return Bw(t)._set(Vw(e),"true")}function lP(t,e){rl.set(t._key(),e)}function Bw(t){return Wn(t._redirectPersistence)}function Vw(t){return tl(iP,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t,e,n){return cP(t,e,n)}async function cP(t,e,n){if(Ae(t.app))return Promise.reject(et(t));const r=Fe(t);Ci(t,e,sr),await r._initializationPromise;const s=Ts(r,n);return await fp(s,r),s._openRedirect(r,e,"signInViaRedirect")}function v2(t,e,n){return uP(t,e,n)}async function uP(t,e,n){const r=H(t);if(Ci(r.auth,e,sr),Ae(r.auth.app))return Promise.reject(et(r.auth));await r.auth._initializationPromise;const s=Ts(r.auth,n);await fp(s,r.auth);const i=await zw(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function _2(t,e,n){return dP(t,e,n)}async function dP(t,e,n){const r=H(t);Ci(r.auth,e,sr),await r.auth._initializationPromise;const s=Ts(r.auth,n);await Fc(!1,r,e.providerId),await fp(s,r.auth);const i=await zw(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function w2(t,e){return await Fe(t)._initializationPromise,Ww(t,e,!1)}async function Ww(t,e,n=!1){if(Ae(t.app))return Promise.reject(et(t));const r=Fe(t),s=Ts(r,e),o=await new oP(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function zw(t){const e=Bc(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hP=10*60*1e3;class fP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Hw(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(_t(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hP&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ug(e))}saveEventToCache(e){this.cachedEventUids.add(Ug(e)),this.lastProcessedEventTime=Date.now()}}function Ug(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Hw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mP(t,e={}){return Ie(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yP=/^https?/;async function vP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mP(t);for(const n of e)try{if(_P(n))return}catch{}Ot(t,"unauthorized-domain")}function _P(t){const e=Vo(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!yP.test(n))return!1;if(gP.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=new ca(3e4,6e4);function $g(){const t=Be().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function xP(t){return new Promise((e,n)=>{var s,i,o;function r(){$g(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$g(),n(_t(t,"network-request-failed"))},timeout:wP.get()})}if((i=(s=Be().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Be().gapi)!=null&&o.load)r();else{const l=_w("iframefcb");return Be()[l]=()=>{gapi.load?r():n(_t(t,"network-request-failed"))},np(`${PT()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw sl=null,e})}let sl=null;function bP(t){return sl=sl||xP(t),sl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SP=new ca(5e3,15e3),EP="__/auth/iframe",IP="emulator/auth/iframe",NP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TP(t){const e=t.config;j(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ep(e,IP):`https://${t.config.authDomain}/${EP}`,r={apiKey:e.apiKey,appName:t.name,v:bi},s=CP.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${bs(r).slice(1)}`}async function kP(t){const e=await bP(t),n=Be().gapi;return j(n,t,"internal-error"),e.open({where:document.body,url:TP(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:NP,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=_t(t,"network-request-failed"),l=Be().setTimeout(()=>{i(o)},SP.get());function c(){Be().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RP=500,AP=600,DP="_blank",jP="http://localhost";class Bg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OP(t,e,n,r=RP,s=AP){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c={...PP,width:r.toString(),height:s.toString(),top:i,left:o},u=wt().toLowerCase();n&&(l=hw(u)?DP:n),uw(u)&&(e=e||jP,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[g,_])=>`${f}${g}=${_},`,"");if(wT(u)&&l!=="_self")return LP(e||"",l),new Bg(null);const h=window.open(e||"",l,d);j(h,t,"popup-blocked");try{h.focus()}catch{}return new Bg(h)}function LP(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="__/auth/handler",FP="emulator/auth/handler",UP=encodeURIComponent("fac");async function Vg(t,e,n,r,s,i){j(t.config.authDomain,t,"auth-domain-config-required"),j(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:bi,eventId:s};if(e instanceof sr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Rl(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Ti){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${UP}=${encodeURIComponent(c)}`:"";return`${$P(t)}?${bs(l).slice(1)}${u}`}function $P({config:t}){return t.emulator?ep(t,FP):`https://${t.authDomain}/${MP}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu="webStorageSupport";class BP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lw,this._completeRedirectFn=Ww,this._overrideRedirectResult=lP}async _openPopup(e,n,r,s){var o;Zn((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Vg(e,n,r,Vo(),s);return OP(e,i,Bc())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Vg(e,n,r,Vo(),s);return Lk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Zn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await kP(e),r=new fP(e);return n.register("authEvent",s=>(j(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Bu,{type:Bu},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Bu];i!==void 0&&n(!!i),Ot(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=vP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return yw()||dw()||tp()}}const VP=BP;class Gw{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return In("unexpected MultiFactorSessionType")}}}class pp extends Gw{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new pp(e)}_finalizeEnroll(e,n,r){return Ck(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return Gk(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class WP{constructor(){}static assertion(e){return pp._fromCredential(e)}}WP.FACTOR_ID="phone";class zP{static assertionForEnrollment(e,n){return Go._fromSecret(e,n)}static assertionForSignIn(e,n){return Go._fromEnrollmentId(e,n)}static async generateSecret(e){var s;const n=e;j(typeof((s=n.user)==null?void 0:s.auth)<"u","internal-error");const r=await Tk(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return mp._fromStartTotpMfaEnrollmentResponse(r,n.user.auth)}}zP.FACTOR_ID="totp";class Go extends Gw{constructor(e,n,r){super("totp"),this.otp=e,this.enrollmentId=n,this.secret=r}static _fromSecret(e,n){return new Go(n,void 0,e)}static _fromEnrollmentId(e,n){return new Go(n,e)}async _finalizeEnroll(e,n,r){return j(typeof this.secret<"u",e,"argument-error"),kk(e,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,n){j(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");const r={verificationCode:this.otp};return qk(e,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}}class mp{constructor(e,n,r,s,i,o,l){this.sessionInfo=o,this.auth=l,this.secretKey=e,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=s,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,n){return new mp(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,n){var s;let r=!1;return(Ua(e)||Ua(n))&&(r=!0),r&&(Ua(e)&&(e=((s=this.auth.currentUser)==null?void 0:s.email)||"unknownuser"),Ua(n)&&(n=this.auth.name)),`otpauth://totp/${n}:${e}?secret=${this.secretKey}&issuer=${n}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Ua(t){return typeof t>"u"||(t==null?void 0:t.length)===0}var Wg="@firebase/auth",zg="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qP(t){kn(new Wt("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;j(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:vw(t)},u=new NT(r,s,i,c);return $T(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),kn(new Wt("auth-internal",e=>{const n=Fe(e.getProvider("auth").getImmediate());return(r=>new HP(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),tn(Wg,zg,GP(t)),tn(Wg,zg,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP=5*60,YP=xv("authIdTokenMaxAge")||KP;let Hg=null;const QP=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>YP)return;const s=n==null?void 0:n.token;Hg!==s&&(Hg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function JP(t=yc()){const e=Ss(t,"auth");if(e.isInitialized())return e.getImmediate();const n=UT(t,{popupRedirectResolver:VP,persistence:[Hk,Dw,Lw]}),r=xv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=QP(i.toString());Nk(n,o,()=>o(n.currentUser)),Ik(n,l=>o(l))}}const s=_v("auth");return s&&BT(n,`http://${s}`),n}function XP(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}CT({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=_t("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",XP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qP("Browser");const qw="@firebase/installations",gp="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw=1e4,Yw=`w:${gp}`,Qw="FIS_v2",ZP="https://firebaseinstallations.googleapis.com/v1",eR=60*60*1e3,tR="installations",nR="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ys=new xs(tR,nR,rR);function Jw(t){return t instanceof An&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw({projectId:t}){return`${ZP}/projects/${t}/installations`}function Zw(t){return{token:t.token,requestStatus:2,expiresIn:iR(t.expiresIn),creationTime:Date.now()}}async function ex(t,e){const r=(await e.json()).error;return ys.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function tx({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function sR(t,{refreshToken:e}){const n=tx(t);return n.append("Authorization",oR(e)),n}async function nx(t){const e=await t();return e.status>=500&&e.status<600?t():e}function iR(t){return Number(t.replace("s","000"))}function oR(t){return`${Qw} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Xw(t),s=tx(t),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={fid:n,authVersion:Qw,appId:t.appId,sdkVersion:Yw},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await nx(()=>fetch(r,l));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:Zw(u.authToken)}}else throw await ex("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR=/^[cdef][\w-]{21}$/,hh="";function uR(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=dR(t);return cR.test(n)?n:hh}catch{return hh}}function dR(t){return lR(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zc(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx=new Map;function ix(t,e){const n=zc(t);ox(n,e),hR(n,e)}function ox(t,e){const n=sx.get(t);if(n)for(const r of n)r(e)}function hR(t,e){const n=fR();n&&n.postMessage({key:t,fid:e}),pR()}let ts=null;function fR(){return!ts&&"BroadcastChannel"in self&&(ts=new BroadcastChannel("[Firebase] FID Change"),ts.onmessage=t=>{ox(t.data.key,t.data.fid)}),ts}function pR(){sx.size===0&&ts&&(ts.close(),ts=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR="firebase-installations-database",gR=1,vs="firebase-installations-store";let Vu=null;function yp(){return Vu||(Vu=Rv(mR,gR,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(vs)}}})),Vu}async function Jl(t,e){const n=zc(t),s=(await yp()).transaction(vs,"readwrite"),i=s.objectStore(vs),o=await i.get(n);return await i.put(e,n),await s.done,(!o||o.fid!==e.fid)&&ix(t,e.fid),e}async function ax(t){const e=zc(t),r=(await yp()).transaction(vs,"readwrite");await r.objectStore(vs).delete(e),await r.done}async function Hc(t,e){const n=zc(t),s=(await yp()).transaction(vs,"readwrite"),i=s.objectStore(vs),o=await i.get(n),l=e(o);return l===void 0?await i.delete(n):await i.put(l,n),await s.done,l&&(!o||o.fid!==l.fid)&&ix(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vp(t){let e;const n=await Hc(t.appConfig,r=>{const s=yR(r),i=vR(t,s);return e=i.registrationPromise,i.installationEntry});return n.fid===hh?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function yR(t){const e=t||{fid:uR(),registrationStatus:0};return lx(e)}function vR(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(ys.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=_R(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:wR(t)}:{installationEntry:e}}async function _R(t,e){try{const n=await aR(t,e);return Jl(t.appConfig,n)}catch(n){throw Jw(n)&&n.customData.serverCode===409?await ax(t.appConfig):await Jl(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function wR(t){let e=await Gg(t.appConfig);for(;e.registrationStatus===1;)await rx(100),e=await Gg(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await vp(t);return r||n}return e}function Gg(t){return Hc(t,e=>{if(!e)throw ys.create("installation-not-found");return lx(e)})}function lx(t){return xR(t)?{fid:t.fid,registrationStatus:0}:t}function xR(t){return t.registrationStatus===1&&t.registrationTime+Kw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bR({appConfig:t,heartbeatServiceProvider:e},n){const r=SR(t,n),s=sR(t,n),i=e.getImmediate({optional:!0});if(i){const u=await i.getHeartbeatsHeader();u&&s.append("x-firebase-client",u)}const o={installation:{sdkVersion:Yw,appId:t.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await nx(()=>fetch(r,l));if(c.ok){const u=await c.json();return Zw(u)}else throw await ex("Generate Auth Token",c)}function SR(t,{fid:e}){return`${Xw(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _p(t,e=!1){let n;const r=await Hc(t.appConfig,i=>{if(!cx(i))throw ys.create("not-registered");const o=i.authToken;if(!e&&NR(o))return i;if(o.requestStatus===1)return n=ER(t,e),i;{if(!navigator.onLine)throw ys.create("app-offline");const l=TR(i);return n=IR(t,l),l}});return n?await n:r.authToken}async function ER(t,e){let n=await qg(t.appConfig);for(;n.authToken.requestStatus===1;)await rx(100),n=await qg(t.appConfig);const r=n.authToken;return r.requestStatus===0?_p(t,e):r}function qg(t){return Hc(t,e=>{if(!cx(e))throw ys.create("not-registered");const n=e.authToken;return kR(n)?{...e,authToken:{requestStatus:0}}:e})}async function IR(t,e){try{const n=await bR(t,e),r={...e,authToken:n};return await Jl(t.appConfig,r),n}catch(n){if(Jw(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await ax(t.appConfig);else{const r={...e,authToken:{requestStatus:0}};await Jl(t.appConfig,r)}throw n}}function cx(t){return t!==void 0&&t.registrationStatus===2}function NR(t){return t.requestStatus===2&&!CR(t)}function CR(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+eR}function TR(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function kR(t){return t.requestStatus===1&&t.requestTime+Kw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PR(t){const e=t,{installationEntry:n,registrationPromise:r}=await vp(e);return r?r.catch(console.error):_p(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RR(t,e=!1){const n=t;return await AR(n),(await _p(n,e)).token}async function AR(t){const{registrationPromise:e}=await vp(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(t){if(!t||!t.options)throw Wu("App Configuration");if(!t.name)throw Wu("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Wu(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Wu(t){return ys.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux="installations",jR="installations-internal",OR=t=>{const e=t.getProvider("app").getImmediate(),n=DR(e),r=Ss(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},LR=t=>{const e=t.getProvider("app").getImmediate(),n=Ss(e,ux).getImmediate();return{getId:()=>PR(n),getToken:s=>RR(n,s)}};function MR(){kn(new Wt(ux,OR,"PUBLIC")),kn(new Wt(jR,LR,"PRIVATE"))}MR();tn(qw,gp);tn(qw,gp,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl="analytics",FR="firebase_id",UR="origin",$R=60*1e3,BR="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",wp="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt=new gc("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Bt=new xs("analytics","Analytics",VR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(t){if(!t.startsWith(wp)){const e=Bt.create("invalid-gtag-resource",{gtagURL:t});return jt.warn(e.message),""}return t}function dx(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function zR(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function HR(t,e){const n=zR("firebase-js-sdk-policy",{createScriptURL:WR}),r=document.createElement("script"),s=`${wp}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function GR(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function qR(t,e,n,r,s,i){const o=r[s];try{if(o)await e[o];else{const c=(await dx(n)).find(u=>u.measurementId===s);c&&await e[c.appId]}}catch(l){jt.error(l)}t("config",s,i)}async function KR(t,e,n,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const l=await dx(n);for(const c of o){const u=l.find(h=>h.measurementId===c),d=u&&e[u.appId];if(d)i.push(d);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",r,s||{})}catch(i){jt.error(i)}}function YR(t,e,n,r){async function s(i,...o){try{if(i==="event"){const[l,c]=o;await KR(t,e,n,l,c)}else if(i==="config"){const[l,c]=o;await qR(t,e,n,r,l,c)}else if(i==="consent"){const[l,c]=o;t("consent",l,c)}else if(i==="get"){const[l,c,u]=o;t("get",l,c,u)}else if(i==="set"){const[l]=o;t("set",l)}else t(i,...o)}catch(l){jt.error(l)}}return s}function QR(t,e,n,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=YR(i,t,e,n),{gtagCore:i,wrappedGtag:window[s]}}function JR(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(wp)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XR=30,ZR=1e3;class eA{constructor(e={},n=ZR){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const hx=new eA;function tA(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function nA(t){var o;const{appId:e,apiKey:n}=t,r={method:"GET",headers:tA(n)},s=BR.replace("{app-id}",e),i=await fetch(s,r);if(i.status!==200&&i.status!==304){let l="";try{const c=await i.json();(o=c.error)!=null&&o.message&&(l=c.error.message)}catch{}throw Bt.create("config-fetch-failed",{httpStatus:i.status,responseMessage:l})}return i.json()}async function rA(t,e=hx,n){const{appId:r,apiKey:s,measurementId:i}=t.options;if(!r)throw Bt.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Bt.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new oA;return setTimeout(async()=>{l.abort()},n!==void 0?n:$R),fx({appId:r,apiKey:s,measurementId:i},o,l,e)}async function fx(t,{throttleEndTimeMillis:e,backoffCount:n},r,s=hx){var l;const{appId:i,measurementId:o}=t;try{await sA(r,e)}catch(c){if(o)return jt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:o};throw c}try{const c=await nA(t);return s.deleteThrottleMetadata(i),c}catch(c){const u=c;if(!iA(u)){if(s.deleteThrottleMetadata(i),o)return jt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:i,measurementId:o};throw c}const d=Number((l=u==null?void 0:u.customData)==null?void 0:l.httpStatus)===503?Lm(n,s.intervalMillis,XR):Lm(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return s.setThrottleMetadata(i,h),jt.debug(`Calling attemptFetch again in ${d} millis`),fx(t,h,r,s)}}function sA(t,e){return new Promise((n,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(i),r(Bt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function iA(t){if(!(t instanceof An)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class oA{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function aA(t,e,n,r,s){if(s&&s.global){t("event",n,r);return}else{const i=await e,o={...r,send_to:i};t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lA(){if(hf())try{await ff()}catch(t){return jt.warn(Bt.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return jt.warn(Bt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function cA(t,e,n,r,s,i,o){const l=rA(t);l.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&jt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>jt.error(f)),e.push(l);const c=lA().then(f=>{if(f)return r.getId()}),[u,d]=await Promise.all([l,c]);JR(i)||HR(i,u.measurementId),s("js",new Date);const h=(o==null?void 0:o.config)??{};return h[UR]="firebase",h.update=!0,d!=null&&(h[FR]=d),s("config",u.measurementId,h),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e){this.app=e}_delete(){return delete po[this.app.options.appId],Promise.resolve()}}let po={},Kg=[];const Yg={};let zu="dataLayer",dA="gtag",Qg,px,Jg=!1;function hA(){const t=[];if(df()&&t.push("This is a browser extension environment."),Nv()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,s)=>`(${s+1}) ${r}`).join(" "),n=Bt.create("invalid-analytics-context",{errorInfo:e});jt.warn(n.message)}}function fA(t,e,n){hA();const r=t.options.appId;if(!r)throw Bt.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)jt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Bt.create("no-api-key");if(po[r]!=null)throw Bt.create("already-exists",{id:r});if(!Jg){GR(zu);const{wrappedGtag:i,gtagCore:o}=QR(po,Kg,Yg,zu,dA);px=i,Qg=o,Jg=!0}return po[r]=cA(t,Kg,Yg,e,Qg,zu,n),new uA(t)}function pA(t=yc()){t=H(t);const e=Ss(t,Xl);return e.isInitialized()?e.getImmediate():mA(t)}function mA(t,e={}){const n=Ss(t,Xl);if(n.isInitialized()){const s=n.getImmediate();if(Lr(e,n.getOptions()))return s;throw Bt.create("already-initialized")}return n.initialize({options:e})}async function gA(){if(df()||!Nv()||!hf())return!1;try{return await ff()}catch{return!1}}function yA(t,e,n,r){t=H(t),aA(px,po[t.app.options.appId],e,n,r).catch(s=>jt.error(s))}const Xg="@firebase/analytics",Zg="0.10.18";function vA(){kn(new Wt(Xl,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return fA(r,s,n)},"PUBLIC")),kn(new Wt("analytics-internal",t,"PRIVATE")),tn(Xg,Zg),tn(Xg,Zg,"esm2020");function t(e){try{const n=e.getProvider(Xl).getImmediate();return{logEvent:(r,s,i)=>yA(n,r,s,i)}}catch(n){throw Bt.create("interop-component-reg-failed",{reason:n})}}}vA();const mx={apiKey:"AIzaSyAdJ3lRxhgZWhnqH8SNQsT1bTFB8E0-cDg",authDomain:"quitarena-a97de.firebaseapp.com",databaseURL:"https://quitarena-a97de-default-rtdb.europe-west1.firebasedatabase.app",projectId:"quitarena-a97de",storageBucket:"quitarena-a97de.firebasestorage.app",messagingSenderId:"693525963288",appId:"1:693525963288:web:a175e9a8bd56fffb35596d",measurementId:"G-H2CCRXYY74"},xp=EI().length?yc():Av(mx),W=YC(xp,mx.databaseURL),ns=JP(xp);Ek(ns,Dw).then(()=>{console.log("Firebase Auth persistence configured for 30 days")}).catch(t=>{console.error("Error setting auth persistence:",t)});let _A=null;(async()=>{try{await gA()&&(_A=pA(xp))}catch(t){console.debug("Analytics not initialized:",t==null?void 0:t.message)}})();class bp{constructor(e,n){this.db=e,this.userUID=n,this.userRef=Z(e,`users/${n}`),this.statsRef=Z(e,`users/${n}/stats`),this.profileRef=Z(e,`users/${n}/profile`),this.behaviorLogRef=Z(e,`users/${n}/behaviorLog`)}async updateStat(e,n,r=""){try{const s=await Le(this.statsRef);if(!s.exists())return!1;const i=s.val(),o=i[e]||0,l=Math.max(0,Math.min(100,o+n));return await Ye(this.statsRef,{...i,[e]:l}),await this.logBehavior(e,n,r),this.showStatNotification(e,n,r),console.log(`${e}: ${n>0?"+":""}${n} (${r})`),!0}catch(s){return console.error(`Error updating ${e}:`,s),!1}}async updateAddictionFromCleanTime(){try{const e=await Le(Z(this.db,`users/${this.userUID}/profile/relapseDate`)),n=await Le(this.userRef);if(!n.exists())return;const r=n.val(),s=e.exists()?new Date(e.val()):new Date(r.quitDate||Date.now()),o=Math.floor((new Date-s)/(1e3*60*60*24*7));if(o>=1){const l=o*2;await this.updateStat("addictionLevel",-l,`Clean time: ${o} week(s)`),o>=1&&await this.resetRelapsePenaltyLevel()}}catch(e){console.error("Error updating addiction from clean time:",e)}}async handleRelapse(){try{const e=new Date,n=await Le(Z(this.db,`users/${this.userUID}/profile/relapseDate`));let r=1;if(n.exists()){const i=new Date(n.val()),o=Math.floor((e-i)/(1e3*60*60*24));o<=3?r=3:o<=7?r=2:r=1}let s=0;switch(r){case 1:s=4;break;case 2:s=6;break;case 3:s=8;break}return await Promise.all([this.updateStat("addictionLevel",s,`Relapse penalty level ${r}`),this.updateStat("mentalStrength",-3,"Relapse setback"),this.updateStat("triggerDefense",-3,"Relapse to known trigger")]),await Ye(Z(this.db,`users/${this.userUID}/profile/relapseDate`),e.toISOString()),await this.logBehavior("relapse",r,`Penalty level ${r} - ${s} addiction, -3 mental, -3 trigger defense`),!0}catch(e){return console.error("Error handling relapse:",e),!1}}async resetRelapsePenaltyLevel(){try{await Ye(Z(this.db,`users/${this.userUID}/profile/relapsePenaltyLevel`),1),console.log("Relapse penalty level reset")}catch(e){console.error("Error resetting relapse penalty level:",e)}}async handleCravingResistance(){try{return await Promise.all([this.updateStat("mentalStrength",1,"Successful craving resistance"),this.updateStat("triggerDefense",3,"Surviving trigger situation")]),await this.trackAppUsageDuringCravings(),!0}catch(e){return console.error("Error handling craving resistance:",e),!1}}async handleBreathingExercise(){try{const e=new Date().toDateString();return await Ye(Z(this.db,`users/${this.userUID}/profile/daily/${e}/breathing`),!0),await this.checkBreathingStreak()>=3&&await this.updateStat("mentalStrength",1,"3-day breathing exercise streak"),!0}catch(e){return console.error("Error handling breathing exercise:",e),!1}}async handleHydrationUpdate(e){try{const n=new Date().toDateString();return await Ye(Z(this.db,`users/${this.userUID}/profile/daily/${n}/water`),e),await this.checkHydrationStreak()>=3&&await this.updateStat("mentalStrength",1,"3-day hydration streak"),!0}catch(n){return console.error("Error handling hydration update:",n),!1}}async checkMilestoneBonuses(){try{const e=await Le(Z(this.db,`users/${this.userUID}/profile/relapseDate`)),n=await Le(this.userRef);if(!n.exists())return;const r=n.val(),s=e.exists()?new Date(e.val()):new Date(r.quitDate||Date.now()),o=Math.floor((new Date-s)/(1e3*60*60*24)),l=[{days:7,bonus:5,name:"First week"},{days:30,bonus:10,name:"First month"},{days:90,bonus:15,name:"Three months"}];for(const c of l)if(o>=c.days){const u=`milestone_${c.days}`;(await Le(Z(this.db,`users/${this.userUID}/profile/${u}`))).exists()||await Promise.all([this.updateStat("mentalStrength",c.bonus,`${c.name} milestone bonus`),Ye(Z(this.db,`users/${this.userUID}/profile/${u}`),!0)])}}catch(e){console.error("Error checking milestone bonuses:",e)}}async trackLoggingActivity(){try{const e=new Date().toDateString();return await Ye(Z(this.db,`users/${this.userUID}/profile/daily/${e}/logged`),!0),await this.checkWeeklyLoggingFrequency()>=3&&await this.updateStat("motivation",2,"Regular logging (3+ days this week)"),await this.checkInactivityPenalty(),!0}catch(e){return console.error("Error tracking logging activity:",e),!1}}async handleAchievementShare(){try{return await this.updateStat("motivation",3,"Sharing achievement"),!0}catch(e){return console.error("Error handling achievement share:",e),!1}}async checkMoneyMilestones(){var e;try{const n=await Le(Z(this.db,`users/${this.userUID}/profile/relapseDate`)),r=await Le(this.userRef);if(!r.exists())return;const s=r.val(),i=n.exists()?new Date(n.val()):new Date(s.quitDate||Date.now()),u=Math.floor((new Date-i)/(1e3*60*60*24))*10,d=[50,100,200,500,1e3];for(const h of d)if(u>=h){const f=`moneyMilestone_${h}`;(await Le(Z(this.db,`users/${this.userUID}/profile/${f}`))).exists()||await Promise.all([this.updateStat("motivation",2,`$${h} saved milestone`),Ye(Z(this.db,`users/${this.userUID}/profile/${f}`),!0)])}await this.updateStat("moneySaved",u-(((e=r.val().stats)==null?void 0:e.moneySaved)||0),"Money saved calculation")}catch(n){console.error("Error checking money milestones:",n)}}async handleTriggerPlanning(){try{return await this.updateStat("triggerDefense",1,"Pre-planning for known triggers"),!0}catch(e){return console.error("Error handling trigger planning:",e),!1}}async handleTriggerListUpdate(){try{return await this.updateStat("triggerDefense",1,"Updating trigger list"),!0}catch(e){return console.error("Error handling trigger list update:",e),!1}}async handleUnpreparedTrigger(){try{return await this.updateStat("triggerDefense",-1,"Entering trigger situation unprepared"),!0}catch(e){return console.error("Error handling unprepared trigger:",e),!1}}async checkBreathingStreak(){try{let e=0;for(let n=0;n<7;n++){const r=new Date;r.setDate(r.getDate()-n);const s=r.toDateString(),i=await Le(Z(this.db,`users/${this.userUID}/profile/daily/${s}/breathing`));if(i.exists()&&i.val())e++;else break}return e}catch(e){return console.error("Error checking breathing streak:",e),0}}async checkHydrationStreak(){try{let e=0;for(let n=0;n<7;n++){const r=new Date;r.setDate(r.getDate()-n);const s=r.toDateString(),i=await Le(Z(this.db,`users/${this.userUID}/profile/daily/${s}/water`));if(i.exists()&&i.val()>0)e++;else break}return e}catch(e){return console.error("Error checking hydration streak:",e),0}}async checkWeeklyLoggingFrequency(){try{let e=0;for(let n=0;n<7;n++){const r=new Date;r.setDate(r.getDate()-n);const s=r.toDateString(),i=await Le(Z(this.db,`users/${this.userUID}/profile/daily/${s}/logged`));i.exists()&&i.val()&&e++}return e}catch(e){return console.error("Error checking weekly logging frequency:",e),0}}async checkInactivityPenalty(){try{let e=null;for(let n=0;n<10;n++){const r=new Date;r.setDate(r.getDate()-n);const s=r.toDateString(),i=await Le(Z(this.db,`users/${this.userUID}/profile/daily/${s}/logged`));if(i.exists()&&i.val()){e=n;break}}(e===null||e>=7)&&await this.updateStat("motivation",-3,"Long period inactive (7+ days)")}catch(e){console.error("Error checking inactivity penalty:",e)}}async trackAppUsageDuringCravings(){try{const n=`appUsage_${new Date().toDateString()}`,r=await Le(Z(this.db,`users/${this.userUID}/profile/${n}`));let s=r.exists()?r.val():0;s++,await Ye(Z(this.db,`users/${this.userUID}/profile/${n}`),s),s===3&&await this.updateStat("mentalStrength",1,"Using app during cravings (3 times, no relapse)")}catch(e){console.error("Error tracking app usage during cravings:",e)}}async logBehavior(e,n,r){try{const s={timestamp:Date.now(),statName:e,change:n,reason:r,date:new Date().toISOString()};await Y_(Z(this.db,`users/${this.userUID}/behaviorLog`),s)}catch(s){console.error("Error logging behavior:",s)}}showStatNotification(e,n,r){const s=document.createElement("div");s.className=`fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-500 transform translate-x-full ${n>0?"bg-green-500 text-white":"bg-red-500 text-white"}`,s.innerHTML=`
      <div class="flex items-center gap-2">
        <span class="text-lg">${n>0?"↗":"↘"}</span>
        <span class="font-bold">${e}</span>
        <span class="text-xl">${n>0?"+":""}${n}</span>
      </div>
      <div class="text-sm opacity-90">${r}</div>
    `,document.body.appendChild(s),setTimeout(()=>{s.classList.remove("translate-x-full")},100),setTimeout(()=>{s.classList.add("translate-x-full"),setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},500)},3e3)}async runDailyUpdates(){try{await Promise.all([this.updateAddictionFromCleanTime(),this.checkMilestoneBonuses(),this.checkMoneyMilestones(),this.checkInactivityPenalty()])}catch(e){console.error("Error running daily updates:",e)}}async initialize(){try{setInterval(()=>{this.runDailyUpdates()},24*60*60*1e3),await this.runDailyUpdates(),console.log("StatManager initialized successfully")}catch(e){console.error("Error initializing StatManager:",e)}}}class wA{constructor(e){this.db=e,this.matchingPoolRef=Z(e,"matchingPool"),this.buddyPairsRef=Z(e,"buddyPairs"),this.usersRef=Z(e,"users")}async addToMatchingPool(e,n){var r;try{const s={userId:e,quitStartDate:n.quitDate||new Date().toISOString(),addictionLevel:((r=n.stats)==null?void 0:r.addictionLevel)||50,triggers:n.triggers||[],timezone:n.timezone||"UTC",quitExperience:n.quitExperience||"first-timer",availableForMatching:!0,lastActive:new Date().toISOString(),createdAt:new Date().toISOString(),archetype:n.archetype||"DETERMINED",dailyPatterns:n.dailyPatterns||[],copingStrategies:n.copingStrategies||[],confidence:n.confidence||5,preferredContactMethod:"chat",availabilityHours:n.availabilityHours||"anytime",language:n.language||"en"};return await Ye(Z(this.db,`matchingPool/${e}`),s),console.log(`✅ User ${e} added to matching pool`),!0}catch(s){return console.error("❌ Error adding user to matching pool:",s),!1}}async removeFromMatchingPool(e){try{return await DC(Z(this.db,`matchingPool/${e}`)),console.log(`✅ User ${e} removed from matching pool`),!0}catch(n){return console.error("❌ Error removing user from matching pool:",n),!1}}async updateMatchingAvailability(e,n){try{return await Ye(Z(this.db,`matchingPool/${e}/availableForMatching`),n),await Ye(Z(this.db,`matchingPool/${e}/lastActive`),new Date().toISOString()),console.log(`✅ User ${e} matching availability updated to: ${n}`),!0}catch(r){return console.error("❌ Error updating matching availability:",r),!1}}async updateLastActive(e){try{return await Ye(Z(this.db,`matchingPool/${e}/lastActive`),new Date().toISOString()),!0}catch(n){return console.error("❌ Error updating last active:",n),!1}}async findCompatibleMatches(e,n=5){try{const r=await Le(Z(this.db,`matchingPool/${e}`));if(!r.exists())return console.log("❌ User not found in matching pool"),[];const s=r.val(),i=await Le(this.matchingPoolRef);if(!i.exists())return console.log("❌ No users in matching pool"),[];const o=i.val(),l=[];for(const[c,u]of Object.entries(o)){if(c===e||!u.availableForMatching)continue;const d=this.calculateCompatibilityScore(s,u);d>=.1&&l.push({userId:c,profile:u,compatibilityScore:d,matchReasons:this.getMatchReasons(s,u)})}return l.sort((c,u)=>u.compatibilityScore-c.compatibilityScore),l.slice(0,n)}catch(r){return console.error("❌ Error finding compatible matches:",r),[]}}calculateCompatibilityScore(e,n){let r=0,s=0;const i=new Date(e.quitStartDate),o=new Date(n.quitStartDate),l=Math.abs(i-o)/(1e3*60*60*24),c=Math.max(0,1-l/30);r+=c*.3,s+=.3;const u=Math.abs(e.addictionLevel-n.addictionLevel),d=Math.max(0,1-u/100);r+=d*.25,s+=.25;const h=e.timezone===n.timezone?1:.5;r+=h*.2,s+=.2;const f=e.quitExperience===n.quitExperience?1:.7;r+=f*.15,s+=.15;const g=e.triggers.filter(x=>n.triggers.includes(x)).length,_=Math.min(1,g/Math.max(e.triggers.length,1));return r+=_*.1,s+=.1,r/s}getMatchReasons(e,n){const r=[],s=new Date(e.quitStartDate),i=new Date(n.quitStartDate),o=Math.abs(s-i)/(1e3*60*60*24);o<=7?r.push("Started quitting around the same time"):o<=30&&r.push("Similar quit journey timeline"),Math.abs(e.addictionLevel-n.addictionLevel)<=10&&r.push("Similar addiction levels"),e.timezone===n.timezone&&r.push("Same timezone for easy communication"),e.quitExperience===n.quitExperience&&r.push(`Both ${e.quitExperience}s`);const c=e.triggers.filter(u=>n.triggers.includes(u));return c.length>0&&r.push(`Shared triggers: ${c.join(", ")}`),r}async createBuddyPair(e,n,r={}){try{const s=Y_(this.buddyPairsRef).key,i={pairId:s,users:[e,n],matchedAt:new Date().toISOString(),compatibilityScore:r.compatibilityScore||0,matchReasons:r.matchReasons||[],status:"active",lastMessageAt:new Date().toISOString(),user1RemovedFromPool:!1,user2RemovedFromPool:!1};return await Ye(Z(this.db,`buddyPairs/${s}`),i),await Promise.all([this.removeFromMatchingPool(e),this.removeFromMatchingPool(n)]),await Promise.all([Ye(Z(this.db,`users/${e}/buddyInfo`),{hasBuddy:!0,buddyId:n,pairId:s,matchedAt:i.matchedAt}),Ye(Z(this.db,`users/${n}/buddyInfo`),{hasBuddy:!0,buddyId:e,pairId:s,matchedAt:i.matchedAt})]),console.log(`✅ Buddy pair created between ${e} and ${n}`),!0}catch(s){return console.error("❌ Error creating buddy pair:",s),!1}}async getUserBuddyInfo(e){try{const n=await Le(Z(this.db,`users/${e}/buddyInfo`));return n.exists()?n.val():null}catch(n){return console.error("❌ Error getting user buddy info:",n),null}}async getBuddyPairInfo(e){try{const n=await Le(Z(this.db,`buddyPairs/${e}`));return n.exists()?n.val():null}catch(n){return console.error("❌ Error getting buddy pair info:",n),null}}async forceMatchUsers(e,n){try{console.log(`🔧 Force matching users ${e} and ${n}`);const r={compatibilityScore:.95,matchReasons:["Force matched for testing","High compatibility detected"],matchedAt:Date.now()},s=await this.createBuddyPair(e,n,r);return s&&console.log(`✅ Force match successful between ${e} and ${n}`),s}catch(r){return console.error("❌ Error force matching users:",r),!1}}async cleanupInactiveUsers(e=30){try{const n=await Le(this.matchingPoolRef);if(!n.exists())return 0;const r=n.val(),s=new Date;s.setDate(s.getDate()-e);let i=0;for(const[o,l]of Object.entries(r))new Date(l.lastActive)<s&&(await this.removeFromMatchingPool(o),i++);return console.log(`✅ Cleaned up ${i} inactive users from matching pool`),i}catch(n){return console.error("❌ Error cleaning up inactive users:",n),0}}async getMatchingPoolStats(){try{const e=await Le(this.matchingPoolRef);if(!e.exists())return{totalUsers:0,availableUsers:0,averageAddictionLevel:0,topTriggers:[],timezoneDistribution:{}};const n=e.val(),r=Object.values(n);return{totalUsers:r.length,availableUsers:r.filter(i=>i.availableForMatching).length,averageAddictionLevel:r.reduce((i,o)=>i+(o.addictionLevel||0),0)/r.length,topTriggers:this.getTopTriggers(r),timezoneDistribution:this.getTimezoneDistribution(r),quitExperienceDistribution:this.getQuitExperienceDistribution(r)}}catch(e){return console.error("❌ Error getting matching pool stats:",e),null}}getTopTriggers(e){const n={};return e.forEach(r=>{var s;(s=r.triggers)==null||s.forEach(i=>{n[i]=(n[i]||0)+1})}),Object.entries(n).sort(([,r],[,s])=>s-r).slice(0,5).map(([r,s])=>({trigger:r,count:s}))}getTimezoneDistribution(e){const n={};return e.forEach(r=>{const s=r.timezone||"Unknown";n[s]=(n[s]||0)+1}),n}getQuitExperienceDistribution(e){const n={};return e.forEach(r=>{const s=r.quitExperience||"unknown";n[s]=(n[s]||0)+1}),n}listenToMatchingPoolStatus(e,n){const r=Z(this.db,`matchingPool/${e}`);return ah(r,i=>{i.exists()?n(i.val()):n(null)})}listenToBuddyPair(e,n){const r=Z(this.db,`buddyPairs/${e}`);return ah(r,i=>{i.exists()?n(i.val()):n(null)})}async getAllMatchingPoolUsers(){try{const e=await Le(this.matchingPoolRef);if(!e.exists())return console.log("❌ No users in matching pool"),[];const n=e.val(),r=Object.entries(n).map(([s,i])=>({id:s,...i}));return console.log("📊 Matching pool users:",r),r}catch(e){return console.error("❌ Error getting matching pool users:",e),[]}}async forceMatchUsers(e,n){try{console.log(`🔧 Force matching users ${e} and ${n}`);const r={compatibilityScore:.95,matchReasons:["Force matched for testing","High compatibility detected"],matchedAt:Date.now()},s=await this.createBuddyPair(e,n,r);return s&&console.log(`✅ Force match successful between ${e} and ${n}`),s}catch(r){return console.error("❌ Error force matching users:",r),!1}}}const xA=({onAuthSuccess:t,isNewUser:e})=>{const[n,r]=N.useState("signin"),[s,i]=N.useState(""),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,h]=N.useState(!1),[f,g]=N.useState(!1),[_,x]=N.useState(""),[M,m]=N.useState(""),[p,y]=N.useState(!1);N.useEffect(()=>()=>{f&&g(!1)},[f]);const b=new Un;b.addScope("email"),b.addScope("profile"),b.setCustomParameters({prompt:"select_account",access_type:"offline",include_granted_scopes:"true"});const P=()=>{i(""),l(""),u(""),x(""),m("")},C=async()=>{h(!0),g(!0),x("");try{console.log("Starting Google sign-in process..."),console.log("Opening Google authentication popup..."),console.log("Google provider configuration:",{scopes:b.scopes,customParameters:b.customParameters});const S=sP(ns,b),v=new Promise((A,U)=>{setTimeout(()=>U(new Error("Popup timeout - please try again")),6e4)}),E=await Promise.race([S,v]);if(E&&E.user){const A=E.user;console.log("Google sign-in successful for:",A.email,"UID:",A.uid),console.log("User display name:",A.displayName),console.log("User photo URL:",A.photoURL),await new Promise(U=>setTimeout(U,800)),t(A)}else throw new Error("No user data received from Google authentication")}catch(S){console.error("Google sign-in error:",S),S.code==="auth/popup-closed-by-user"?x("Google sign-in was cancelled. Please try again and complete the account selection in the popup window."):S.code==="auth/popup-blocked"?x("Google sign-in popup was blocked by your browser. Please allow popups for this site and try again."):S.code==="auth/cancelled-popup-request"?x("Google sign-in was cancelled. Please try again and complete the authentication process."):S.code==="auth/account-exists-with-different-credential"?x("An account already exists with this email using a different sign-in method. Please use email/password instead."):S.message==="Popup timeout - please try again"?x("Google sign-in popup timed out. Please try again and complete the account selection quickly."):S.code==="auth/network-request-failed"?x("Network error during Google sign-in. Please check your internet connection and try again."):S.code==="auth/operation-not-allowed"?x("Google sign-in is not enabled for this app. Please contact support."):x(w(S.code))}finally{h(!1),g(!1)}},R=async S=>{S.preventDefault(),h(!0),x("");try{const E=(await mk(ns,s,o)).user;console.log("Email sign-in successful for:",E.email),t(E)}catch(v){console.error("Email sign-in error:",v),x(w(v.code))}finally{h(!1)}},T=async S=>{if(S.preventDefault(),h(!0),x(""),o!==c){x("Passwords do not match"),h(!1);return}if(o.length<6){x("Password must be at least 6 characters long"),h(!1);return}try{const E=(await pk(ns,s,o)).user;console.log("Email sign-up successful for:",E.email),await yk(E),t(E)}catch(v){console.error("Email sign-up error:",v),x(w(v.code))}finally{h(!1)}},L=async S=>{if(S.preventDefault(),!s){x("Please enter your email address");return}h(!0),x("");try{await hk(ns,s),m("Password reset email sent! Check your inbox.")}catch(v){console.error("Password reset error:",v),x(w(v.code))}finally{h(!1)}},w=S=>{switch(S){case"auth/user-not-found":return"No account found with this email address";case"auth/wrong-password":return"Incorrect password";case"auth/email-already-in-use":return"An account with this email already exists";case"auth/weak-password":return"Password is too weak. Use at least 6 characters";case"auth/invalid-email":return"Invalid email address";case"auth/popup-closed-by-user":return"Google sign-in was cancelled. Please try again and complete the account selection.";case"auth/popup-blocked":return"Google sign-in popup was blocked. Please allow popups for this site and try again.";case"auth/cancelled-popup-request":return"Google sign-in was cancelled. Please try again.";case"auth/account-exists-with-different-credential":return"An account already exists with this email using a different sign-in method.";case"auth/network-request-failed":return"Network error. Please check your connection";case"auth/operation-not-allowed":return"Google sign-in is not enabled. Please contact support.";case"auth/too-many-requests":return"Too many sign-in attempts. Please try again later.";default:return"Authentication failed. Please try again"}};return p?a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-white",children:"Reset Password"}),a.jsx("p",{className:"mt-2 text-gray-400",children:"Enter your email to receive a reset link"})]}),a.jsxs("form",{onSubmit:L,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email Address"}),a.jsx("input",{id:"email",type:"email",value:s,onChange:S=>i(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),_&&a.jsx("div",{className:"text-red-400 text-sm",children:_}),M&&a.jsx("div",{className:"text-green-400 text-sm",children:M}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsx("button",{type:"button",onClick:()=>{y(!1),x(""),m("")},className:"flex-1 px-4 py-2 border border-gray-600 rounded-md text-gray-300 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Back to Login"}),a.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 border border-transparent rounded-md text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:d?"Sending...":"Send Reset Link"})]})]})]})}):a.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"QuitCard Arena"}),a.jsx("p",{className:"text-gray-400",children:"Your journey to quit starts here"})]}),a.jsxs("div",{children:[f&&a.jsx("div",{className:"mb-3 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-center text-blue-300 text-sm",children:[a.jsx("div",{className:"animate-pulse mr-2",children:"🔐"}),"Google popup is open - please complete your account selection"]})}),a.jsx("button",{onClick:C,disabled:d,className:"w-full flex items-center justify-center px-4 py-3 border border-gray-600 rounded-md text-white bg-gray-800 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Opening Google Sign-in..."]}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:f?a.jsx("span",{className:"text-blue-400 font-medium",children:"🔐 Google popup is open - please complete account selection"}):"Click to open Google account selection popup"}),_&&a.jsxs("div",{className:"mt-3 p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:[a.jsx("div",{className:"text-red-300 text-sm mb-2",children:_}),_.includes("Google sign-in")&&!f&&a.jsx("button",{onClick:C,disabled:d,className:"w-full px-3 py-2 bg-red-600 hover:bg-red-700 text-white text-sm rounded-md transition-colors disabled:opacity-50",children:d?"Retrying...":"Try Google Sign-in Again"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("div",{className:"w-full border-t border-gray-600"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-gray-900 text-gray-400",children:"Or continue with email"})})]}),a.jsxs("div",{className:"flex space-x-1 bg-gray-800 p-1 rounded-lg",children:[a.jsx("button",{onClick:()=>{r("signin"),P()},className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${n==="signin"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"Sign In"}),a.jsx("button",{onClick:()=>{r("signup"),P()},className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${n==="signup"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"Sign Up"})]}),n==="signin"&&a.jsxs("form",{onSubmit:R,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"signin-email",className:"block text-sm font-medium text-gray-300",children:"Email Address"}),a.jsx("input",{id:"signin-email",type:"email",value:s,onChange:S=>i(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"signin-password",className:"block text-sm font-medium text-gray-300",children:"Password"}),a.jsx("input",{id:"signin-password",type:"password",value:o,onChange:S=>l(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your password"})]}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("button",{type:"button",onClick:()=>y(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"Forgot your password?"})}),_&&a.jsx("div",{className:"text-red-400 text-sm",children:_}),a.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:d?"Signing in...":"Sign In"})]}),n==="signup"&&a.jsxs("form",{onSubmit:T,className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"signup-email",className:"block text-sm font-medium text-gray-300",children:"Email Address"}),a.jsx("input",{id:"signup-email",type:"email",value:s,onChange:S=>i(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"signup-password",className:"block text-sm font-medium text-gray-300",children:"Password"}),a.jsx("input",{id:"signup-password",type:"password",value:o,onChange:S=>l(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Create a password (min 6 characters)"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-300",children:"Confirm Password"}),a.jsx("input",{id:"confirm-password",type:"password",value:c,onChange:S=>u(S.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Confirm your password"})]}),_&&a.jsx("div",{className:"text-red-400 text-sm",children:_}),M&&a.jsx("div",{className:"text-green-400 text-sm",children:M}),a.jsx("button",{type:"submit",disabled:d,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:d?"Creating account...":"Create Account"})]})]})})},bA=()=>{const[t,e]=N.useState(navigator.onLine),[n,r]=N.useState(!1);return N.useEffect(()=>{const s=()=>{e(!0),r(!1),console.log("🌐 Connection restored")},i=()=>{e(!1),r(!0),console.log("📡 Connection lost")};return window.addEventListener("online",s),window.addEventListener("offline",i),e(navigator.onLine),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",i)}},[]),t?null:a.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-yellow-600 text-white p-3 text-center shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("svg",{className:"w-5 h-5 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),a.jsx("span",{className:"font-medium",children:"You're offline. Some features may be limited."}),a.jsx("button",{onClick:()=>r(!1),className:"ml-2 text-white hover:text-yellow-200 transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n&&a.jsxs("div",{className:"mt-2 text-sm bg-yellow-700 p-2 rounded",children:[a.jsx("p",{className:"mb-2",children:"While offline, you can:"}),a.jsxs("ul",{className:"text-left space-y-1 ml-4",children:[a.jsx("li",{children:"• View your current stats and progress"}),a.jsx("li",{children:"• Track habits and cravings"}),a.jsx("li",{children:"• Play distraction games"}),a.jsx("li",{children:"• View your profile information"})]}),a.jsx("p",{className:"mt-2 text-yellow-200",children:"Changes will sync when you're back online."})]})]})};var SA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const EA=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IA=(t,e)=>{const n=N.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>N.createElement("svg",{ref:u,...SA,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${EA(t)}`,...c},[...e.map(([d,h])=>N.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n};var St=IA;const NA=St("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),CA=St("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),gx=St("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),yx=St("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),TA=St("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),kA=St("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Yi=St("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),vx=St("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),qo=St("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),PA=St("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),_x=St("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),RA=St("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]),wx=St("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),xx=St("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),bx=St("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),dr=(t,e="adventurer")=>{const n="https://api.dicebear.com/7.x",r={seed:t||Math.random().toString(36).substring(7),backgroundColor:["b6e3f4","c0aede","ffdfbf","ffd5dc"],radius:50,size:200},s=new URLSearchParams(r).toString();return`${n}/${e}/svg?${s}`},$a=t=>{const e=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"],n=e[t.charCodeAt(0)%e.length],r=t.substring(0,2).toUpperCase();return`data:image/svg+xml,${encodeURIComponent(`
    <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
      <rect width="200" height="200" fill="${n}"/>
      <text x="100" y="120" font-family="Arial, sans-serif" font-size="80" font-weight="bold" text-anchor="middle" fill="white">${r}</text>
    </svg>
  `)}`},AA=({onComplete:t,authUser:e})=>{const[n,r]=N.useState(1),[s,i]=N.useState({heroName:"",archetype:"",avatar:null,avatarSeed:Math.random().toString(36).substring(7),triggers:[],dailyPatterns:[],copingStrategies:[],vapePodsPerWeek:0,nicotineStrength:"",quitAttempts:"",confidence:5}),[o,l]=N.useState(!1),[c,u]=N.useState(!1),[d,h]=N.useState(null),[f,g]=N.useState(null),_=[{id:"DETERMINED",name:"The Determined",description:"Unstoppable willpower and determination",color:"bg-red-500",icon:qo},{id:"SOCIAL_FIGHTER",name:"The Social Fighter",description:"Thrives on community support",color:"bg-blue-500",icon:bx},{id:"HEALTH_WARRIOR",name:"The Health Warrior",description:"Focused on physical and mental wellness",color:"bg-green-500",icon:yx},{id:"MONEY_SAVER",name:"The Money Saver",description:"Motivated by financial freedom",color:"bg-yellow-500",icon:gx}],x=["Stress/anxiety","Social situations","Boredom","After meals","Drinking alcohol","Work breaks","Driving"],M=["Morning routine","Work breaks","After meals","Evening wind-down","Social events","Throughout the day"],m=["Breathing exercises","Nicotine replacement therapy","Exercise/physical activity","Distraction techniques","Nothing - this is new to me"],p=()=>{console.log("Calculating stats with userData:",s);let w=40;s.vapePodsPerWeek<=1?w+=5:s.vapePodsPerWeek<=3?w+=15:s.vapePodsPerWeek<=5?w+=25:s.vapePodsPerWeek<=7?w+=35:w+=40;const S=s.nicotineStrength||"",v=parseInt(S.replace("mg",""))||0;v<=5?w+=0:v<=11?w+=10:v<=20?w+=20:w+=25,s.dailyPatterns.includes("Throughout the day")?w+=20:s.dailyPatterns.length>2?w+=10:w+=0,w=Math.min(w,100);let E=25;s.confidence>=9?E+=35:s.confidence>=7?E+=25:s.confidence>=4?E+=15:E+=0,s.quitAttempts==="first"?E+=15:parseInt(s.quitAttempts)<=3?E+=10:E+=5,s.copingStrategies.length>=3?E+=15:s.copingStrategies.length>=1?E+=10:E+=0,E=Math.min(E,80);let A=35;A+={DETERMINED:20,HEALTH_WARRIOR:15,SOCIAL_FIGHTER:15,MONEY_SAVER:10}[s.archetype]||0,s.confidence>=8?A+=25:s.confidence>=5?A+=15:A+=0,s.quitAttempts==="first"?A+=10:parseInt(s.quitAttempts)<=3?A+=5:A+=15,A=Math.min(A,90);let G=15;s.triggers.length<=2?G+=15:s.triggers.length<=4?G+=10:G+=5;const Q=s.triggers.includes("Drinking alcohol"),k=s.triggers.includes("Social situations");return Q&&k?G+=0:s.triggers.length>3?G+=5:G+=10,s.copingStrategies.length>=3?G+=25:s.copingStrategies.length>=1?G+=15:G+=0,s.dailyPatterns.includes("Throughout the day")?G+=0:s.dailyPatterns.length>2?G+=5:G+=10,G=Math.min(G,60),{addictionLevel:w,mentalStrength:E,motivation:A,triggerDefense:G}},y=w=>{const S=w.target.files[0];if(S){h(S);const v=new FileReader;v.onload=E=>g(E.target.result),v.readAsDataURL(S)}},b=async()=>{if(d){u(!0);try{const w=document.createElement("canvas"),S=w.getContext("2d"),v=new Image;v.onload=()=>{w.width=200,w.height=200,S.filter="contrast(1.2) saturate(1.3) brightness(1.1)",S.drawImage(v,0,0,200,200),S.globalCompositeOperation="overlay",S.fillStyle="rgba(255, 200, 200, 0.1)",S.fillRect(0,0,200,200);const E=w.toDataURL("image/png"),A={...s,avatar:E};i(A),L(A,3),u(!1)},v.src=f}catch(w){console.error("Photo processing failed:",w);const S=$a(s.avatarSeed);i(v=>({...v,avatar:S})),u(!1)}}},P=()=>{l(!0);const w=Math.random().toString(36).substring(7);(async()=>{try{const v=dr(w),E={...s,avatarSeed:w,avatar:v};i(E),L(E,3)}catch{const E=$a(w),A={...s,avatarSeed:w,avatar:E};i(A),L(A,3)}})(),setTimeout(()=>l(!1),500)},C=async()=>{if(n<10)await L(s,n),r(n+1);else try{console.log("Completing onboarding with userData:",s);const w=p();console.log("Calculated stats:",w);const S={...s,stats:{...w,streakDays:0,moneySaved:0,experiencePoints:0},achievements:[],quitDate:new Date};await L(S,10),console.log("Final user data:",S),t(S)}catch(w){console.error("Error completing onboarding:",w);const v={...s,stats:{...{addictionLevel:50,mentalStrength:50,motivation:50,triggerDefense:30},streakDays:0,moneySaved:0,experiencePoints:0},achievements:[],quitDate:new Date};try{await L(v,10)}catch(E){console.error("Failed to save fallback data to Firebase:",E)}console.log("Using fallback stats:",v),t(v)}},R=()=>{n>1&&r(n-1)},T=()=>{switch(n){case 1:return s.heroName.trim().length>0;case 2:return s.archetype!=="";case 3:return s.avatar!==null;case 4:return s.triggers.length>0;case 5:return s.dailyPatterns.length>0;case 6:return s.copingStrategies.length>0;case 7:return s.vapePodsPerWeek>0;case 8:return s.nicotineStrength!=="";case 9:return s.quitAttempts!=="";case 10:return s.confidence>0;default:return!1}},L=async(w,S)=>{if(e)try{const{ref:v,set:E}=await ye(()=>import("./index.esm-b358409e.js"),[]),A=v(W,`users/${e.uid}/onboarding`);await E(v(W,`users/${e.uid}/onboarding/step${S}`),{...w,stepNumber:S,timestamp:Date.now()}),await E(v(W,`users/${e.uid}/onboarding/progress`),{currentStep:S,completedSteps:Array.from({length:S},(U,G)=>G+1),lastUpdated:Date.now()}),console.log(`Step ${S} saved to Firebase successfully`)}catch(v){console.error(`Error saving step ${S} to Firebase:`,v)}};return N.useEffect(()=>{if(!s.avatar){const w=dr(s.avatarSeed);i(S=>({...S,avatar:w}))}},[]),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-slate-800/80 backdrop-blur-sm rounded-2xl p-8 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsx("div",{className:"flex justify-between items-center mb-8 overflow-x-auto",children:[1,2,3,4,5,6,7,8,9,10].map(w=>a.jsxs("div",{className:"flex items-center flex-shrink-0",children:[a.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${w<=n?"bg-blue-500 text-white":"bg-slate-600 text-gray-400"}`,children:w<n?"✓":w}),w<10&&a.jsx("div",{className:`w-4 h-1 mx-1 ${w<n?"bg-blue-500":"bg-slate-600"}`})]},w))}),n===1&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(PA,{className:"w-10 h-10 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Welcome to QuitCard Arena"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Your journey to freedom starts here. Let's create your hero identity."}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-left text-white text-sm font-medium mb-2",children:"What's your hero name?"}),a.jsx("input",{type:"text",value:s.heroName,onChange:w=>{const S={...s,heroName:w.target.value};i(S),w.target.value.trim().length>0&&L(S,1)},placeholder:"e.g., FreedomSeeker, HealthGuardian",className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),n===2&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(qo,{className:"w-10 h-10 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Choose Your Archetype"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Select the warrior type that resonates with your journey."}),a.jsx("div",{className:"space-y-3 mb-6",children:_.map(w=>{const S=w.icon;return a.jsx("button",{onClick:()=>{const v={...s,archetype:w.id};i(v),L(v,2)},className:`w-full p-4 rounded-lg border-2 transition-all duration-300 text-left ${s.archetype===w.id?"border-blue-500 bg-blue-500/20":"border-slate-600 bg-slate-700 hover:border-slate-500"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 ${w.color} rounded-lg flex items-center justify-center`,children:a.jsx(S,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-white font-semibold",children:w.name}),a.jsx("p",{className:"text-gray-400 text-sm",children:w.description})]})]})},w.id)})})]}),n===3&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-purple-400 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(xx,{className:"w-10 h-10 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Create Your Avatar"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Choose your battle card identity in the arena."}),a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full overflow-hidden border-4 border-slate-600 bg-slate-700",children:s.avatar?a.jsx("img",{src:s.avatar,alt:"Avatar",className:"w-full h-full object-cover",onError:()=>{i(w=>({...w,avatar:$a(w.avatarSeed)}))}}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(Yi,{className:"w-8 h-8 text-gray-400 animate-spin"})})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-white text-sm font-medium mb-2",children:"Upload Your Photo"}),a.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden",id:"photo-upload"}),a.jsx("label",{htmlFor:"photo-upload",className:"w-full px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2 justify-center cursor-pointer",children:"📷 Upload Photo"})]}),f&&a.jsx("div",{className:"mb-4",children:a.jsx("button",{onClick:b,disabled:c,className:"w-full px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 text-white rounded-lg transition-colors flex items-center gap-2 justify-center",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Yi,{className:"w-4 h-4 animate-spin"}),"Converting to Anime..."]}):a.jsx(a.Fragment,{children:"✨ Convert to Anime"})})}),a.jsx("div",{className:"text-gray-400 text-sm",children:"- OR -"}),a.jsx("button",{onClick:P,disabled:o,className:"w-full px-6 py-3 bg-slate-600 hover:bg-slate-500 disabled:bg-slate-700 text-white rounded-lg transition-colors flex items-center gap-2 justify-center",children:o?a.jsxs(a.Fragment,{children:[a.jsx(Yi,{className:"w-4 h-4 animate-spin"}),"Generate Random Avatar"]}):a.jsxs(a.Fragment,{children:[a.jsx(Yi,{className:"w-4 h-4"}),"Generate Random Avatar"]})}),a.jsx("button",{onClick:()=>{const w=$a(s.avatarSeed),S={...s,avatar:w};i(S),L(S,3)},className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Use Fallback Avatar"})]})]})]}),n===4&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"🎯"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Trigger Identification"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"What usually makes you want to vape? (Select all that apply)"}),a.jsx("div",{className:"space-y-3 mb-6",children:x.map(w=>a.jsx("button",{onClick:()=>{const S={...s,triggers:s.triggers.includes(w)?s.triggers.filter(v=>v!==w):[...s.triggers,w]};i(S),L(S,4)},className:`w-full p-4 rounded-lg border-2 transition-all duration-300 text-left ${s.triggers.includes(w)?"border-blue-500 bg-blue-500/20":"border-slate-600 bg-slate-700 hover:border-slate-500"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center ${s.triggers.includes(w)?"bg-blue-500 border-blue-500":"border-gray-400"}`,children:s.triggers.includes(w)&&a.jsx("span",{className:"text-white text-sm",children:"✓"})}),a.jsx("span",{className:"text-white font-semibold",children:w})]})},w))})]}),n===5&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-indigo-400 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"📅"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Daily Routine"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"When do you vape most? (Select all that apply)"}),a.jsx("div",{className:"space-y-3 mb-6",children:M.map(w=>a.jsx("button",{onClick:()=>{const S={...s,dailyPatterns:s.dailyPatterns.includes(w)?s.dailyPatterns.filter(v=>v!==w):[...s.dailyPatterns,w]};i(S),L(S,5)},className:`w-full p-4 rounded-lg border-2 transition-all duration-300 text-left ${s.dailyPatterns.includes(w)?"border-blue-500 bg-blue-500/20":"border-slate-600 bg-slate-700 hover:border-slate-500"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center ${s.dailyPatterns.includes(w)?"bg-blue-500 border-blue-500":"border-gray-400"}`,children:s.dailyPatterns.includes(w)&&a.jsx("span",{className:"text-white text-sm",children:"✓"})}),a.jsx("span",{className:"text-white font-semibold",children:w})]})},w))})]}),n===6&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-teal-400 to-teal-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"🛡️"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Coping Experience"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"Have you tried any of these strategies before? (Select all that apply)"}),a.jsx("div",{className:"space-y-3 mb-6",children:m.map(w=>a.jsx("button",{onClick:()=>{const S={...s,copingStrategies:s.copingStrategies.includes(w)?s.copingStrategies.filter(v=>v!==w):[...s.copingStrategies,w]};i(S),L(S,6)},className:`w-full p-4 rounded-lg border-2 transition-all duration-300 text-left ${s.copingStrategies.includes(w)?"border-blue-500 bg-blue-500/20":"border-slate-600 bg-slate-700 hover:border-slate-500"}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center ${s.copingStrategies.includes(w)?"bg-blue-500 border-blue-500":"border-gray-400"}`,children:s.copingStrategies.includes(w)&&a.jsx("span",{className:"text-white text-sm",children:"✓"})}),a.jsx("span",{className:"text-white font-semibold",children:w})]})},w))})]}),n===7&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-red-400 to-red-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"🚬"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Vape Usage"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"How many vape pods do you typically use per week?"}),a.jsx("div",{className:"mb-6",children:a.jsxs("select",{value:s.vapePodsPerWeek,onChange:w=>{const S={...s,vapePodsPerWeek:parseFloat(w.target.value)||0};i(S),S.vapePodsPerWeek>0&&L(S,7)},className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select pods per week"}),a.jsx("option",{value:"0.5",children:"0.5 pods"}),a.jsx("option",{value:"1",children:"1 pod"}),a.jsx("option",{value:"2",children:"2 pods"}),a.jsx("option",{value:"3",children:"3 pods"}),a.jsx("option",{value:"4",children:"4 pods"}),a.jsx("option",{value:"5",children:"5 pods"}),a.jsx("option",{value:"6",children:"6 pods"}),a.jsx("option",{value:"7",children:"7 pods"}),a.jsx("option",{value:"8",children:"8+ pods"})]})})]}),n===8&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"⚡"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Nicotine Strength"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"What nicotine strength do you typically use?"}),a.jsx("div",{className:"mb-6",children:a.jsxs("select",{value:s.nicotineStrength,onChange:w=>{const S={...s,nicotineStrength:w.target.value};i(S),S.nicotineStrength&&L(S,8)},className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select nicotine strength"}),a.jsx("option",{value:"3mg",children:"3mg"}),a.jsx("option",{value:"6mg",children:"6mg"}),a.jsx("option",{value:"12mg",children:"12mg"}),a.jsx("option",{value:"18mg",children:"18mg"}),a.jsx("option",{value:"20mg",children:"20mg"}),a.jsx("option",{value:"50mg",children:"50mg"})]})})]}),n===9&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"📚"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Previous Attempts"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"How many times have you tried to quit before?"}),a.jsx("div",{className:"mb-6",children:a.jsxs("select",{value:s.quitAttempts,onChange:w=>{const S={...s,quitAttempts:w.target.value};i(S),S.quitAttempts&&L(S,9)},className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"Select option"}),a.jsx("option",{value:"first",children:"This is my first attempt"}),a.jsx("option",{value:"1",children:"Once before"}),a.jsx("option",{value:"2",children:"Twice before"}),a.jsx("option",{value:"3",children:"3-5 times"}),a.jsx("option",{value:"5",children:"More than 5 times"})]})})]}),n===10&&a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx("span",{className:"text-2xl",children:"🎯"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Confidence Level"}),a.jsx("p",{className:"text-gray-300 mb-6",children:"How confident are you this time? (1-10 scale)"}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-gray-400 text-sm",children:"1"}),a.jsx("input",{type:"range",min:"1",max:"10",value:s.confidence,onChange:w=>{const S={...s,confidence:parseInt(w.target.value)};i(S),L(S,10)},className:"flex-1 h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer slider"}),a.jsx("span",{className:"text-gray-400 text-sm",children:"10"})]}),a.jsxs("div",{className:"text-center mt-2",children:[a.jsx("span",{className:"text-white font-bold text-lg",children:s.confidence}),a.jsx("span",{className:"text-gray-400 text-sm ml-2",children:"/ 10"})]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[n>1&&a.jsx("button",{onClick:R,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:"Back"}),a.jsxs("button",{onClick:C,disabled:!T(),className:`ml-auto px-6 py-3 rounded-lg transition-colors flex items-center gap-2 ${T()?"bg-blue-600 hover:bg-blue-700 text-white":"bg-slate-700 text-gray-400 cursor-not-allowed"}`,children:[n===10?"Start Journey":"Next",a.jsx(NA,{className:"w-4 h-4"})]})]})]})})},ey={DETERMINED:{name:"The Determined",color:"bg-red-500",icon:qo},SOCIAL_FIGHTER:{name:"The Social Fighter",color:"bg-blue-500",icon:bx},HEALTH_WARRIOR:{name:"The Health Warrior",color:"bg-green-500",icon:yx},MONEY_SAVER:{name:"The Money Saver",color:"bg-yellow-500",icon:gx}},DA={COMMON:{name:"Common",color:"border-gray-400",glow:"",days:0},UNCOMMON:{name:"Uncommon",color:"border-gray-300",glow:"shadow-lg",days:7},RARE:{name:"Rare",color:"border-yellow-400",glow:"shadow-yellow-400/50 shadow-lg",days:14},EPIC:{name:"Epic",color:"border-purple-400",glow:"shadow-purple-400/50 shadow-xl",days:30},LEGENDARY:{name:"Legendary",color:"border-orange-400",glow:"shadow-orange-400/50 shadow-2xl animate-pulse",days:90}},ty={WEEK_WARRIOR:{name:"Week Warrior",icon:CA,description:"7 days clean"},MONTH_MASTER:{name:"Month Master",icon:wx,description:"30 days clean"},LEGEND:{name:"Legend",icon:_x,description:"90 days clean"}},jA=t=>t>=90?"LEGENDARY":t>=30?"EPIC":t>=14?"RARE":t>=7?"UNCOMMON":"COMMON",OA=({isOpen:t,onClose:e,statType:n})=>{if(!t)return null;const s={addiction:{title:"Addiction",description:"Time since last vape - decreases as your body heals",impacts:["What decreases it:","• Clean time: -2 points per week (standard recovery)","• Cold turkey approach: -3 points per week (faster healing)","• Tapering approach: -1.5 points per week (gentler decline)","","What increases it:","• First relapse (after clean period): +4 points","• Second relapse (within 7 days): +6 additional points","• Third relapse and on (within 3 days): +8 additional points","• Reset: Penalty level resets after 7 clean days"]},mentalStrength:{title:"Mental Strength",description:"Your ability to resist urges and stay strong",impacts:["What increases it:","• Successful craving resistance: +1 point","• Using app during cravings every 3 times with no relapse: +1 point","• Completing breathing exercises 3 days straight: +1 point","• Staying hydrated for 3 days straight: +1 point","• Milestone bonuses: First 7 days +5 points, 30 days +10 points, 90 days +15 points","","What decreases it:","• Giving in to cravings: -3 points","• Each relapse: -3 points"]},motivation:{title:"Motivation",description:"Your drive to quit - boosted by staying engaged",impacts:["What increases it:","• Regular logging (3+ days per week): +2 points (weekly)","• Sharing achievements: +3 points per share (weekly)","• Reaching money saved milestones: +2 points","","What decreases it:","• Long periods inactive (7+ days no logging): -3 points"]},triggerDefense:{title:"Trigger Defense",description:"Protection against your personal vaping triggers",impacts:["What increases it:","• Surviving trigger situations without vaping: +3 points","• Pre-planning for known triggers: +1 point","• Updating your trigger list: +1 point","","What decreases it:","• Relapsing to known triggers: -3 points","• Entering trigger situations unprepared: -1 point"]}}[n];return s?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s.title}),a.jsx("p",{className:"text-gray-300 text-sm",children:s.description})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-white font-semibold mb-3 text-left",children:"What impacts it:"}),a.jsx("ul",{className:"space-y-2 text-left",children:s.impacts.map((i,o)=>a.jsxs("li",{className:"text-gray-300 text-sm flex items-start",children:[a.jsx("span",{className:"text-blue-400 mr-2",children:"•"}),i]},o))})]}),a.jsx("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition-all duration-300",children:"Got it"})]})}):null},Ba=({label:t,value:e,max:n,color:r,statType:s,onInfoClick:i})=>{const o=Math.min(e,n);return a.jsxs("div",{className:"mb-2",children:[a.jsxs("div",{className:"flex justify-between text-white text-xs mb-1",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{children:t}),s&&i&&a.jsx("button",{onClick:()=>i(s),className:"w-4 h-4 bg-blue-600 hover:bg-blue-700 rounded-full flex items-center justify-center text-white text-xs font-bold transition-colors",title:`Learn about ${t}`,children:"i"})]}),a.jsxs("span",{children:[o,"/",n]})]}),a.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:`${r} h-2 rounded-full transition-all duration-500`,style:{width:`${o/n*100}%`}})})]})},ny=({user:t,isNemesis:e=!1,showComparison:n=!1,nemesisUser:r=null,onInfoClick:s})=>{const[i,o]=N.useState(!1),[l,c]=N.useState(null);if(t.isEmpty)return a.jsx("div",{className:"w-80 h-[520px] bg-slate-800 rounded-xl border-2 border-slate-600 p-4 text-white text-center mx-auto flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-24 h-24 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-4xl text-slate-400",children:"🔍"})}),a.jsx("h3",{className:"text-slate-300 text-lg font-semibold mb-2",children:"Looking for Buddy"}),a.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"We are searching for a suitable quit buddy for you. This may take a few minutes."}),a.jsx("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg",children:a.jsx("p",{className:"text-slate-300 text-xs",children:"💡 Tip: Complete your profile to help us find better matches"})})]})});if(!t||!t.archetype||!t.stats)return a.jsx("div",{className:"w-80 h-[520px] bg-slate-800 rounded-xl border-2 border-gray-400 p-4 text-white text-center mx-auto flex items-center justify-center",children:a.jsx("div",{className:"animate-pulse",children:"Loading Card..."})});const u=ey[t.archetype];if(!u)return console.error("Invalid archetype:",t.archetype,"Available:",Object.keys(ey)),a.jsx("div",{className:"w-80 h-[520px] bg-slate-800 rounded-xl border-2 border-red-400 p-4 text-white text-center mx-auto flex items-center justify-center",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-red-400 mb-2",children:"Invalid Archetype"}),a.jsx("p",{className:"text-gray-300 text-sm",children:t.archetype})]})});const d=DA[jA(t.stats.streakDays)],h=u.icon,f=async b=>{let P=null;if(b.uid)try{const{ref:T,get:L}=await ye(()=>import("./index.esm-b358409e.js"),[]),w=T(W,`users/${b.uid}/specialFeatures`),S=await L(w);S.exists()&&(P=S.val())}catch(T){console.error("Error fetching special features from Firebase:",T)}if(!P){const T=`specialFeatures_${b.heroName||b.id||"default"}`,L=localStorage.getItem(T);L&&(P=JSON.parse(L))}if(P)return P;const C=[];for(b.triggers&&b.triggers.length>0&&b.triggers.forEach(T=>{switch(T){case"Stress/anxiety":C.push("Stress Vaper");break;case"Social situations":C.push("Social Vaper");break;case"Boredom":C.push("Boredom Vaper");break;case"After meals":C.push("Habit Vaper");break;case"Drinking alcohol":C.push("Party Vaper");break;case"Work breaks":C.push("Break Vaper");break;case"Driving":C.push("Driving Vaper");break}}),b.dailyPatterns&&b.dailyPatterns.length>0&&b.dailyPatterns.forEach(T=>{switch(T){case"Morning routine":C.push("Morning Struggler");break;case"Evening wind-down":C.push("Late Night Lurker");break;case"Throughout the day":C.push("All-Day Addict");break}}),b.copingStrategies&&b.copingStrategies.length>0&&(b.copingStrategies.includes("Nothing - this is new to me")?C.push("First Timer"):b.copingStrategies.length>2&&C.push("Veteran Quitter"));C.length<4;){const T=["Nicotine Fighter","Health Seeker","Freedom Chaser","Willpower Warrior"],L=T[Math.floor(Math.random()*T.length)];C.includes(L)||C.push(L)}const R=C.slice(0,4);if(b.uid)try{const{ref:T,set:L}=await ye(()=>import("./index.esm-b358409e.js"),[]),w=T(W,`users/${b.uid}/specialFeatures`);await L(w,R),console.log("Special features saved to Firebase successfully")}catch(T){console.error("Error saving special features to Firebase:",T);const L=`specialFeatures_${b.heroName||b.id||"default"}`;localStorage.setItem(L,JSON.stringify(R))}else{const T=`specialFeatures_${b.heroName||b.id||"default"}`;localStorage.setItem(T,JSON.stringify(R))}return R},[g,_]=N.useState([]);N.useEffect(()=>{(async()=>{if(t&&t.uid){const P=await f(t);_(P)}})()},[t]);const x=t.stats.addictionLevel||50,M=t.stats.mentalStrength||50,m=t.stats.motivation||50,p=t.stats.triggerDefense||30;t.stats.nemesisVictories||(Math.floor(Math.random()*8)+1,Math.floor(Math.random()*5)+1);const y=b=>{c(b),o(!0)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`relative w-80 h-[520px] rounded-xl ${d.color} border-4 ${d.glow} bg-gradient-to-br from-slate-800 to-slate-900 p-4 transform transition-all duration-300 hover:scale-105 mx-auto overflow-hidden`,children:[a.jsxs("div",{className:"text-center mb-3",children:[a.jsx("h3",{className:"text-white font-bold text-lg leading-tight break-words px-1",children:t.heroName}),a.jsx("p",{className:"text-gray-300 text-base",children:u.name})]}),a.jsx("div",{className:"w-24 h-24 mx-auto mb-4 rounded-full overflow-hidden bg-slate-700 flex items-center justify-center ring-2 ring-blue-400/50",children:t.avatar?a.jsx("img",{src:t.avatar,alt:"Avatar",className:"w-full h-full object-cover",onError:()=>{console.log("Avatar failed to load, using fallback")}}):a.jsx("div",{className:`w-full h-full ${u.color} flex items-center justify-center`,children:a.jsx(h,{className:"w-12 h-12 text-white"})})}),a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsx(Ba,{label:"Addiction",value:x,max:100,color:"bg-red-500",statType:e?null:"addiction",onInfoClick:e?null:y}),a.jsx(Ba,{label:"Mental Strength",value:M,max:100,color:"bg-blue-500",statType:e?null:"mentalStrength",onInfoClick:e?null:y}),a.jsx(Ba,{label:"Motivation",value:m,max:100,color:"bg-green-500",statType:e?null:"motivation",onInfoClick:e?null:y}),a.jsx(Ba,{label:"Trigger Defense",value:p,max:100,color:"bg-orange-500",statType:e?null:"triggerDefense",onInfoClick:e?null:y})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h4",{className:"text-white text-xs font-semibold mb-2 text-center",children:"Special Features"}),a.jsx("div",{className:"flex flex-wrap gap-1 justify-center",children:g.map((b,P)=>a.jsx("div",{className:"px-2 py-1 bg-blue-600/80 text-white text-xs rounded-full font-medium",title:b,children:b},P))})]}),a.jsxs("div",{className:"bg-black/30 rounded-lg p-3 space-y-2 mb-3 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex justify-between text-white text-sm",children:[a.jsx("span",{className:"text-gray-300",children:"Streak:"}),a.jsxs("span",{className:"font-bold text-green-400 flex items-center gap-1",children:[t.stats.streakDays," days",t.stats.streakDays>0&&a.jsx("span",{className:"text-xs",children:"🔥"})]})]}),a.jsxs("div",{className:"flex justify-between text-white text-sm",children:[a.jsx("span",{className:"text-gray-300",children:"Cravings Resisted:"}),a.jsxs("span",{className:"font-bold text-blue-400 flex items-center gap-1",children:[t.stats.cravingsResisted||0,a.jsx("span",{className:"text-xs",children:"💪"})]})]})]}),t.achievements&&t.achievements.length>0&&a.jsxs("div",{className:"flex flex-wrap gap-1 justify-center",children:[t.achievements.slice(0,4).map((b,P)=>{var R,T;const C=((R=ty[b])==null?void 0:R.icon)||_x;return a.jsx("div",{className:"w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center shadow-lg",title:(T=ty[b])==null?void 0:T.description,children:a.jsx(C,{className:"w-3 h-3 text-white"})},P)}),t.achievements.length>4&&a.jsxs("div",{className:"w-6 h-6 bg-gray-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:["+",t.achievements.length-4]})]})]}),a.jsx(OA,{isOpen:i,onClose:()=>o(!1),statType:l})]})},LA=({activeTab:t,onTabChange:e,dataLoadingState:n,onRefreshData:r,offlineManager:s})=>{const i=[{id:"arena",label:"Arena",icon:TA},{id:"craving-support",label:"Craving Support",icon:qo},{id:"profile",label:"Profile",icon:xx},{id:"buddy-chat",label:"Chat with Buddy",icon:kA},{id:"settings",label:"Explore",icon:vx}];return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed bottom-20 left-0 right-0 bg-slate-700/90 backdrop-blur-sm border-t border-slate-600 px-4 py-2 z-30",children:a.jsxs("div",{className:"flex justify-center items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-green-400",children:"🔐"}),a.jsx("span",{className:"text-white",children:"Session Active"}),a.jsx("span",{className:"text-gray-400",children:"•"}),a.jsx("span",{className:"text-gray-300",children:"30 days persistence"}),n&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-gray-400",children:"•"}),n.isComplete?a.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"✓"}),a.jsx("span",{children:"Synced"})]}):n.error?a.jsxs("span",{className:"text-red-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"⚠"}),a.jsx("span",{children:"Sync Error"})]}):a.jsxs("span",{className:"text-yellow-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"⟳"}),a.jsx("span",{children:"Syncing..."})]}),n.isComplete&&a.jsx("button",{onClick:r,className:"ml-2 px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",title:"Refresh data from server",children:"🔄"})]}),s&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-gray-400",children:"•"}),s.isOnline?a.jsxs("span",{className:"text-green-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"🌐"}),a.jsx("span",{children:"Online"})]}):a.jsxs("span",{className:"text-yellow-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"📡"}),a.jsx("span",{children:"Offline"})]}),s.syncQueue.length>0&&a.jsxs("span",{className:"text-blue-400 flex items-center gap-1",children:[a.jsx("span",{className:"text-xs",children:"📝"}),a.jsxs("span",{children:[s.syncQueue.length," pending"]})]})]})]})}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-slate-800 border-t border-slate-700 px-4 py-2 z-40",children:a.jsx("div",{className:"flex justify-around max-w-md mx-auto",children:i.map(o=>{const l=o.icon,c=t===o.id;return a.jsxs("button",{onClick:()=>e(o.id),className:`flex flex-col items-center transition-colors ${c?"text-blue-400":"text-gray-400 hover:text-blue-300"}`,children:[a.jsx(l,{className:"w-5 h-5"}),a.jsx("span",{className:"text-xs",children:o.label})]},o.id)})})})]})},MA=({user:t,nemesis:e,onBackToLogin:n,onResetForTesting:r,buddyLoading:s,buddyError:i,onRefreshBuddy:o,onAutoMatch:l,realBuddy:c})=>{const[u,d]=N.useState(!1),[h,f]=N.useState(null);N.useEffect(()=>{c&&console.log("🔍 Arena: Real buddy loaded:",c.heroName)},[c]),N.useEffect(()=>{if(t!=null&&t.uid&&!c&&!s&&o){console.log("🔍 Arena: Loading buddy data for user:",t.uid);try{o()}catch(v){console.error("❌ Error in Arena buddy loading:",v)}}},[t==null?void 0:t.uid]);const g=async()=>{h&&await h.handleAchievementShare()},_=async v=>{const E={...v.stats};if(!(v!=null&&v.uid)){const A=localStorage.getItem("quitCoachRelapseDate");if(A){const Q=new Date(A),$=new Date().getTime()-Q.getTime(),B=Math.floor($/(1e3*3600*24));E.streakDays=B}else{const Q=v.quitDate?new Date(v.quitDate):new Date,$=new Date().getTime()-Q.getTime();E.streakDays=Math.floor($/(1e3*3600*24))}const U=parseInt(localStorage.getItem("cravingWins")||0);E.cravingsResisted=U,new Date().toDateString();let G=0;for(let Q=0;Q<7;Q++){const k=new Date;k.setDate(k.getDate()-Q);const $=k.toDateString(),B=localStorage.getItem(`water_${$}`);if(B&&parseInt(B)>0)G++;else break}return G>=3&&(E.mentalStrength=Math.min(80,(E.mentalStrength||50)+1)),E}try{const{ref:A,get:U}=await ye(()=>import("./index.esm-b358409e.js"),[]),G=A(W,`users/${v.uid}/profile/relapseDate`),Q=await U(G);if(Q.exists()){const q=new Date(Q.val()),xe=new Date().getTime()-q.getTime(),re=Math.floor(xe/(1e3*3600*24));E.streakDays=re}else{const q=v.quitDate?new Date(v.quitDate):new Date,xe=new Date().getTime()-q.getTime();E.streakDays=Math.floor(xe/(1e3*3600*24))}const k=A(W,`users/${v.uid}/profile/cravingsResisted`),$=await U(k);E.cravingsResisted=$.exists()?$.val():0;const B=new Date().toDateString();let Y=0;for(let q=0;q<7;q++){const ue=new Date;ue.setDate(ue.getDate()-q);const xe=ue.toDateString(),re=A(W,`users/${v.uid}/profile/daily/${xe}/water`),he=await U(re);if(he.exists()&&he.val()>0)Y++;else break}Y>=3&&(E.mentalStrength=Math.min(80,(E.mentalStrength||50)+1))}catch(A){console.error("Error fetching profile data from Firebase:",A);const U=localStorage.getItem("quitCoachRelapseDate");if(U){const k=new Date(U),B=new Date().getTime()-k.getTime(),Y=Math.floor(B/(1e3*3600*24));E.streakDays=Y}else{const k=v.quitDate?new Date(v.quitDate):new Date,B=new Date().getTime()-k.getTime();E.streakDays=Math.floor(B/(1e3*3600*24))}const G=parseInt(localStorage.getItem("cravingWins")||0);E.cravingsResisted=G,new Date().toDateString();let Q=0;for(let k=0;k<7;k++){const $=new Date;$.setDate($.getDate()-k);const B=$.toDateString(),Y=localStorage.getItem(`water_${B}`);if(Y&&parseInt(Y)>0)Q++;else break}Q>=3&&(E.mentalStrength=Math.min(80,(E.mentalStrength||50)+1))}return E},[x,M]=N.useState({...t==null?void 0:t.stats}),[m,p]=N.useState({...e==null?void 0:e.stats});N.useEffect(()=>{if(!(t!=null&&t.uid))return;const v=async()=>{try{const U=new bp(W,t.uid);await U.initialize(),f(U)}catch(U){console.error("Error initializing StatManager:",U)}},E=async()=>{try{const U=new wA(W);setBuddyMatchingService(U),console.log("✅ BuddyMatchingService initialized successfully")}catch(U){console.error("Error initializing BuddyMatchingService:",U)}};v(),E(),(async()=>{if(t){const U=await _(t);M(U)}if(e){const U=await _(e);p(U)}})()},[t,e]);const y=v=>{const E=v.stats.mentalStrength||50,A=v.stats.motivation||50,U=v.stats.triggerDefense||30,G=v.stats.addictionLevel||50;return E*1.5+A*1+U*1.2-G*1},b=y({...t,stats:x}),P=y({...e,stats:m}),C=b>P?"WINNING":b===P?"TIED":"LOSING",R=()=>{if(C==="WINNING")return null;const v=P-b+1,E=[],A=x.mentalStrength||50,U=x.motivation||50,G=x.triggerDefense||30,Q=x.addictionLevel||50,k=m.mentalStrength||50,$=m.motivation||50;m.triggerDefense;const B=m.addictionLevel||50,Y=k-A,q=$-U,ue=Q-B,xe=[{name:"Mental Strength",multiplier:1.5,gap:Y,current:A,max:100},{name:"Trigger Defense",multiplier:1.2,gap:q,current:G,max:100},{name:"Motivation",multiplier:1,gap:q,current:U,max:100},{name:"Addiction",multiplier:1,gap:ue,current:Q,min:0,isReduction:!0}];if(xe.sort((re,he)=>re.multiplier!==he.multiplier?he.multiplier-re.multiplier:Math.abs(he.gap)-Math.abs(re.gap)),xe.forEach(re=>{if(re.isReduction){const he=Math.min(re.current-re.min,50),ot=he*re.multiplier;ot>0&&E.push({stat:re.name,change:he,action:T(he),priority:ot,canWin:ot>=v,isReduction:!0,efficiency:re.multiplier,gap:re.gap})}else{const he=Math.min(re.max-re.current,50),ot=he*re.multiplier;ot>0&&E.push({stat:re.name,change:he,action:L(re.name,he),priority:ot,canWin:ot>=v,efficiency:re.multiplier,gap:re.gap})}}),E.sort((re,he)=>he.priority-re.priority),E.length>0&&!E.some(re=>re.canWin)){const re=w(E,v);re&&E.unshift(re)}return E.slice(0,3)},T=v=>v>=30?"Stay completely clean, avoid all triggers, use nicotine replacement therapy":v>=20?"Reduce nicotine intake significantly, avoid high-risk situations":v>=10?"Cut back on vaping frequency, identify and avoid main triggers":"Small reduction in nicotine intake, practice trigger avoidance",L=(v,E)=>{switch(v){case"Mental Strength":return E>=30?"Complete daily breathing exercises, stay hydrated for 3+ days, practice meditation":E>=20?"Complete breathing exercises 3 days straight, stay hydrated, use stress management":"Complete breathing exercises, stay hydrated for 3 days straight";case"Motivation":return E>=30?"Log progress daily, share achievements weekly, track money saved milestones":E>=20?"Log progress 5+ days per week, share achievements, track progress":"Regular logging (3+ days per week), share achievements, reach milestones";case"Trigger Defense":return E>=30?"Survive multiple trigger situations, pre-plan for all triggers, update trigger list":E>=20?"Survive trigger situations, pre-plan for known triggers, practice coping":"Survive trigger situations without vaping, pre-plan for known triggers";default:return"Focus on improving this stat through consistent practice"}},w=(v,E)=>{let A=0;const U=[];for(const G of v){if(A>=E)break;const Q=E-A,k=Math.min(G.priority,Q);k>0&&(U.push({stat:G.stat,change:Math.ceil(k/G.efficiency),contribution:k}),A+=k)}return U.length>0?{stat:"Combination Strategy",change:Math.ceil(E),action:`Focus on: ${U.map(G=>`${G.stat} (+${G.change})`).join(", ")}`,priority:A,canWin:A>=E,isCombination:!0,strategy:U}:null},S=R();return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 py-8 pb-20",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[a.jsxs("div",{className:"flex justify-start mb-6 gap-3",children:[a.jsx("button",{onClick:n,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors flex items-center gap-2",children:"← Back to Login"}),!1]}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"text-xs text-slate-400 mb-2",children:"Buddy Matching: 🔄 Refresh | 🤝 Auto Match | 📊 Check Pool | ➕ Add to Pool | ⚡ Force Match | 🔍 Debug | 🧪 Test | 🚀 Force Load"}),a.jsxs("div",{className:"inline-flex items-center gap-4",children:[a.jsxs("div",{className:`inline-flex items-center px-6 py-3 rounded-full font-bold text-lg shadow-xl ${C==="WINNING"?"bg-green-600":C==="TIED"?"bg-yellow-600":"bg-red-600"} text-white`,children:[C==="WINNING"?a.jsx(wx,{className:"w-5 h-5 mr-2"}):C==="TIED"?a.jsx(qo,{className:"w-5 h-5 mr-2"}):a.jsx("span",{className:"mr-2",children:"📉"}),"You are ",C]}),a.jsx("button",{onClick:()=>d(!0),className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg",title:"Battle Algorithm Info",children:a.jsx("span",{className:"text-lg font-bold",children:"i"})}),a.jsx("button",{onClick:()=>{console.log("🔄 Manual refresh requested..."),loadRealBuddy()},disabled:s,className:"w-10 h-10 bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white rounded-full flex items-center justify-center transition-colors shadow-lg",title:"Refresh Buddy Data - Manual",children:s?a.jsx(Yi,{className:"w-5 h-5 animate-spin"}):a.jsx("span",{className:"text-lg",children:"🔄"})}),a.jsx("button",{onClick:l,disabled:s||c,className:"w-10 h-10 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 text-white rounded-full flex items-center justify-center transition-colors shadow-lg",title:"Auto Find Buddy Match",children:a.jsx("span",{className:"text-lg",children:"🤝"})}),a.jsx("button",{onClick:async()=>{try{console.log("🔍 Checking matching pool directly...");const{ref:v,get:E}=await ye(()=>import("./index.esm-b358409e.js"),[]),A=v(W,"matchingPool"),U=await E(A);if(!U.exists()){alert("❌ No matching pool found");return}const G=U.val(),Q=Object.keys(G),k=v(W,"buddyPairs"),$=await E(k);let B=0;$.exists()&&(B=Object.keys($.val()).length),console.log("📊 Matching Pool Status:",{usersInPool:Q.length,buddyPairs:B,poolUsers:Q}),alert(`📊 Matching Pool Status:

Users in Pool: ${Q.length}
Buddy Pairs: ${B}

Users: ${Q.join(", ")}`)}catch(v){console.error("❌ Error checking matching pool:",v),alert(`❌ Error: ${v.message}`)}},className:"w-10 h-10 bg-yellow-600 hover:bg-yellow-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Check Matching Pool - Direct Firebase",children:a.jsx("span",{className:"text-lg",children:"📊"})}),a.jsx("button",{onClick:async()=>{buddyMatchingService&&(t!=null&&t.uid)&&(console.log("🔧 Debug: Adding current user to matching pool..."),await buddyMatchingService.addToMatchingPool(t.uid,{quitDate:t.quitDate||new Date().toISOString(),stats:t.stats||{addictionLevel:50},triggers:t.triggers||["stress","social"],timezone:t.timezone||"UTC",quitExperience:t.quitExperience||"first-timer",archetype:t.archetype||"DETERMINED",dailyPatterns:t.dailyPatterns||["morning","evening"],copingStrategies:t.copingStrategies||["breathing","walking"],confidence:t.confidence||5})?(alert("✅ User added to matching pool!"),setTimeout(()=>l(),1e3)):alert("❌ Failed to add user to matching pool"))},className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Add to Matching Pool",children:a.jsx("span",{className:"text-lg",children:"➕"})}),a.jsx("button",{onClick:async()=>{try{console.log("🚀 Force Matching Users Directly...");const{ref:v,get:E,set:A,push:U}=await ye(()=>import("./index.esm-b358409e.js"),[]);console.log("🔍 Reading matching pool...");const G=v(W,"matchingPool"),Q=await E(G);if(!Q.exists()){alert("❌ No matching pool found");return}const k=Q.val(),$=Object.keys(k);if(console.log("📊 Users in matching pool:",$),$.length<2){alert("⚠️ Need at least 2 users for buddy matching");return}const B=$[0],Y=$[1];console.log(`🔗 Force matching users: ${B} + ${Y}`),console.log("🤝 Creating buddy pair...");const q=U(v(W,"buddyPairs")).key,ue={pairId:q,users:[B,Y],matchedAt:new Date().toISOString(),compatibilityScore:.95,matchReasons:["Force matched from app interface","High compatibility detected","Real users from pool"],status:"active",lastMessageAt:new Date().toISOString(),user1RemovedFromPool:!1,user2RemovedFromPool:!1};await A(v(W,`buddyPairs/${q}`),ue),console.log(`✅ Created buddy pair: ${q}`),console.log("👤 Updating user profiles..."),await A(v(W,`users/${B}/buddyInfo`),{hasBuddy:!0,buddyId:Y,pairId:q,matchedAt:ue.matchedAt}),await A(v(W,`users/${Y}/buddyInfo`),{hasBuddy:!0,buddyId:B,pairId:q,matchedAt:ue.matchedAt}),console.log("✅ Updated both users with buddy info"),console.log("🧹 Removing users from matching pool..."),await remove(v(W,`matchingPool/${B}`)),await remove(v(W,`matchingPool/${Y}`)),console.log("✅ Removed both users from matching pool"),await A(v(W,`buddyPairs/${q}/user1RemovedFromPool`),!0),await A(v(W,`buddyPairs/${q}/user2RemovedFromPool`),!0),console.log("✅ Updated buddy pair pool removal flags"),alert(`✅ Buddy pair created successfully!

Users: ${B} + ${Y}
Pair ID: ${q}

Users removed from matching pool.

Refreshing buddy data...`),o&&setTimeout(()=>o(),1e3)}catch(v){console.error("❌ Error force matching users:",v),alert(`❌ Error creating buddy pair: ${v.message}`)}},className:"w-10 h-10 bg-purple-600 hover:bg-purple-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Force Match Now - Direct Firebase",children:a.jsx("span",{className:"text-lg",children:"⚡"})}),a.jsx("button",{onClick:async()=>{var v,E;try{console.log("🔍 Debug: Checking buddy status..."),console.log("Current user UID:",t==null?void 0:t.uid),console.log("Real buddy state:",c),console.log("Buddy loading:",s),console.log("Buddy error:",i);const{ref:A,get:U}=await ye(()=>import("./index.esm-b358409e.js"),[]),G=A(W,"buddyPairs"),Q=await U(G);let k="No buddy pairs found";if(Q.exists()){const q=Q.val();k=`Found ${Object.keys(q).length} buddy pairs:
`;for(const[ue,xe]of Object.entries(q))k+=`
Pair ${ue}:
`,k+=`  Users: ${((v=xe.users)==null?void 0:v.join(", "))||"None"}
`,k+=`  Status: ${xe.status||"Unknown"}
`,k+=`  Current user in pair: ${(E=xe.users)!=null&&E.includes(t==null?void 0:t.uid)?"YES":"NO"}
`}const $=A(W,"matchingPool"),B=await U($);let Y="No matching pool found";B.exists()&&(Y=`Users in matching pool: ${Object.keys(B.val()).join(", ")}`),alert(`🔍 Buddy Debug Info:

Current User: ${t==null?void 0:t.uid}

Real Buddy: ${c?"YES":"NO"}
Buddy Loading: ${s}
Buddy Error: ${i||"None"}

${k}

${Y}`)}catch(A){console.error("❌ Error in buddy debug:",A),alert(`❌ Debug error: ${A.message}`)}},className:"w-10 h-10 bg-gray-600 hover:bg-gray-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Debug Buddy Status",children:a.jsx("span",{className:"text-lg",children:"🔍"})}),a.jsx("button",{onClick:async()=>{try{console.log("🧪 Test Buddy Loading..."),console.log("Current user UID:",t==null?void 0:t.uid);const{ref:v,get:E}=await ye(()=>import("./index.esm-b358409e.js"),[]);console.log("🔍 Step 1: Querying buddyPairs collection...");const A=v(W,"buddyPairs"),U=await E(A);if(!U.exists()){alert("❌ No buddy pairs found in database");return}const G=U.val();console.log("📊 All buddy pairs:",G),console.log("🔍 Step 2: Finding pair containing current user...");let Q=null,k=null;for(const[q,ue]of Object.entries(G))if(console.log(`🔍 Checking pair ${q}:`,ue),ue.users&&Array.isArray(ue.users)&&ue.users.includes(t.uid)){console.log("✅ Found buddy pair containing current user:",q),Q=ue,Q.pairId=q,k=ue.users.find(xe=>xe!==t.uid),console.log("👥 Current user:",t.uid,"Buddy user:",k);break}if(!Q||!k){alert("❌ No buddy pair found for current user");return}console.log("📥 Step 3: Loading buddy user data...");const $=v(W,`users/${k}`),B=await E($);if(!B.exists()){alert("❌ Buddy user data not found");return}const Y=B.val();console.log("✅ Loaded buddy user data:",Y),alert(`🧪 Test Buddy Loading Results:

✅ SUCCESS!

Current User: ${t.uid}
Buddy Pair ID: ${Q.pairId}
Buddy User ID: ${k}
Buddy Hero Name: ${Y.heroName||"Unknown"}

This means the database is working correctly!

The issue might be in the loadRealBuddy function or component state.

Check the console for detailed logs.`)}catch(v){console.error("❌ Error in test buddy loading:",v),alert(`❌ Test failed: ${v.message}`)}},className:"w-10 h-10 bg-orange-600 hover:bg-orange-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Test Buddy Loading - Manual Firebase Query",children:a.jsx("span",{className:"text-lg",children:"🧪"})}),a.jsx("button",{onClick:async()=>{try{console.log("🚀 Force Load Buddy..."),console.log("Current user UID:",t==null?void 0:t.uid),console.log("Current realBuddy state:",c),console.log("Current buddyLoading state:",s),o?(console.log("🔍 Calling onRefreshBuddy function..."),o()):console.log("⚠️ onRefreshBuddy function not available!"),setTimeout(()=>{console.log("🔍 After force load - realBuddy state:",c),console.log("🔍 After force load - buddyLoading state:",s)},1e3)}catch(v){console.error("❌ Error in force load buddy:",v),alert(`❌ Force load failed: ${v.message}`)}},className:"w-10 h-10 bg-red-600 hover:bg-red-700 text-white rounded-full flex items-center justify-center transition-colors shadow-lg ml-2",title:"Force Load Buddy - Manual Trigger",children:a.jsx("span",{className:"text-lg",children:"🚀"})})]}),a.jsxs("div",{className:"mt-4",children:[s&&a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-yellow-600/20 border border-yellow-500/50 rounded-lg",children:a.jsx("span",{className:"text-yellow-400 text-sm font-semibold",children:"🔍 Searching for buddy..."})}),i&&a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-red-600/20 border border-red-500/50 rounded-lg",children:a.jsx("span",{className:"text-red-400 text-sm font-semibold",children:"❌ Buddy loading failed"})}),c&&!s&&!i&&a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-green-600/20 border border-green-500/50 rounded-lg",children:a.jsxs("span",{className:"text-green-400 text-sm font-semibold",children:["✅ Battling ",c.heroName]})}),!c&&!s&&!i&&a.jsx("div",{className:"inline-flex items-center px-4 py-2 bg-blue-600/20 border border-blue-500/50 rounded-lg",children:a.jsx("span",{className:"text-blue-400 text-sm font-semibold",children:"🤝 No buddy yet - Click 🤝 button to find one!"})})]})]}),a.jsxs("div",{className:"flex justify-center gap-12 mb-6",children:[a.jsx("div",{className:"w-80 text-center",children:a.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full font-bold text-sm shadow-lg ${C==="WINNING"?"bg-green-600":C==="TIED"?"bg-yellow-600":"bg-red-600"} text-white`,children:C==="WINNING"?"WINNING":C==="TIED"?"TIED":"LOSING"})}),a.jsx("div",{className:"w-24"})," ",a.jsx("div",{className:"w-80 text-center",children:a.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full font-bold text-sm shadow-lg ${C==="WINNING"?"bg-red-600":C==="TIED"?"bg-yellow-600":"bg-green-600"} text-white`,children:C==="WINNING"?"LOSING":C==="TIED"?"TIED":"WINNING"})})]}),a.jsxs("div",{className:"flex flex-row items-center justify-center gap-12 mb-8 w-full max-w-7xl mx-auto",children:[a.jsx("div",{className:"flex flex-col items-center space-y-4 flex-shrink-0",children:a.jsx(ny,{user:{...t,stats:x},showComparison:!1,nemesisUser:e})}),a.jsxs("div",{className:"flex flex-col items-center space-y-4 flex-shrink-0",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-red-500 to-purple-600 rounded-full flex items-center justify-center shadow-xl animate-pulse",children:a.jsx(RA,{className:"w-12 h-12 text-white"})}),a.jsx("div",{className:"bg-red-600 px-8 py-3 rounded-full",children:a.jsx("p",{className:"text-white font-bold text-2xl",children:"VS"})})]}),a.jsxs("div",{className:"flex flex-col items-center space-y-4 flex-shrink-0",children:[e.isEmpty&&!c&&a.jsx("div",{className:"mb-2 text-center",children:a.jsxs("div",{className:"bg-slate-600/20 border border-slate-500/50 rounded-lg px-4 py-2",children:[a.jsx("p",{className:"text-slate-400 text-sm font-semibold",children:"🔍 Looking for Buddy"}),a.jsx("p",{className:"text-slate-300 text-xs",children:"We are searching for a suitable match"})]})}),s&&a.jsx("div",{className:"mb-2 text-center",children:a.jsxs("div",{className:"bg-yellow-600/20 border border-yellow-500/50 rounded-lg px-4 py-2",children:[a.jsx("p",{className:"text-yellow-400 text-sm font-semibold",children:"🔍 Loading Buddy..."}),a.jsx("p",{className:"text-yellow-300 text-xs",children:"Please wait while we find your match"})]})}),i&&a.jsxs("div",{className:"mb-2 text-center",children:[a.jsxs("div",{className:"bg-red-600/20 border border-red-500/50 rounded-lg px-4 py-2 mb-2",children:[a.jsx("p",{className:"text-red-400 text-sm font-semibold",children:"❌ Error Loading Buddy"}),a.jsx("p",{className:"text-red-300 text-xs",children:i})]}),a.jsx("button",{onClick:o,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Retry"})]}),c&&a.jsx("div",{className:"mb-2 text-center",children:a.jsxs("div",{className:"bg-green-600/20 border border-green-500/50 rounded-lg px-4 py-2",children:[a.jsx("p",{className:"text-green-400 text-sm font-semibold",children:"✅ Connected with Buddy"}),a.jsxs("p",{className:"text-green-300 text-xs",children:["You're battling ",c.heroName,"!"]})]})}),a.jsx("div",{className:"mb-2 text-center",children:a.jsx("div",{className:"bg-blue-600/20 border border-blue-500/50 rounded-lg px-4 py-2",children:a.jsxs("p",{className:"text-blue-400 text-xs",children:["Debug: realBuddy=",c?"YES":"NO",", nemesis.isEmpty=",e.isEmpty?"YES":"NO",", buddyLoading=",s?"YES":"NO"]})})}),a.jsx(ny,{user:c||e,isNemesis:!0,showComparison:!1,nemesisUser:t})]})]}),C==="LOSING"&&S&&S.length>0&&a.jsxs("div",{className:"max-w-4xl mx-auto bg-slate-800/50 rounded-xl p-6 border border-slate-700",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"🎯 Quick Win Strategy"}),a.jsx("div",{className:"space-y-4",children:S.slice(0,3).map((v,E)=>a.jsx("div",{className:"bg-slate-700/50 rounded-lg p-4 border-l-4 border-blue-500",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:v.isReduction?a.jsxs(a.Fragment,{children:["🎯 Reduce your ",v.stat," by ",v.change," points!"]}):v.isCombination?a.jsxs(a.Fragment,{children:["🎯 Best Strategy: Improve multiple stats by ",v.change," total points!"]}):v.isMajor?a.jsxs(a.Fragment,{children:["🎯 Major improvement needed: ",v.change," total points!"]}):a.jsxs(a.Fragment,{children:["🎯 Increase your ",v.stat," by ",v.change," points!"]})}),a.jsxs("p",{className:"text-gray-300 text-sm",children:["💡 ",v.action]})]}),a.jsxs("div",{className:`font-bold text-2xl ml-4 ${v.isReduction?"text-green-400":v.isCombination?"text-purple-400":v.isMajor?"text-orange-400":"text-blue-400"}`,children:[v.isReduction?"-":"+",v.change]})]})},E))}),a.jsx("div",{className:"text-center mt-4",children:a.jsx("p",{className:"text-gray-400 text-sm",children:"Focus on the top recommendation for the fastest path to victory!"})})]})]}),u&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-md w-full border border-slate-600",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:"Battle Algorithm"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:g,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm transition-colors",title:"Share achievement for Motivation bonus",children:"📤 Share"}),a.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white text-2xl",children:"×"})]})]}),a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"Formula:"}),a.jsx("p",{className:"text-gray-300 font-mono",children:"(Mental Strength × 1.5) + (Motivation × 1.0) + (Trigger Defense × 1.2) - (Addiction × 1.0)"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"Your Score:"}),a.jsxs("p",{className:"text-green-400 font-mono",children:["(",x.mentalStrength||50," × 1.5) + (",x.motivation||50," × 1.0) + (",x.triggerDefense||30," × 1.2) - (",x.addictionLevel||50," × 1.0) = ",b.toFixed(1)]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"Nemesis Score:"}),a.jsxs("p",{className:"text-red-400 font-mono",children:["(",m.mentalStrength||50," × 1.5) + (",m.motivation||50," × 1.0) + (",m.triggerDefense||30," × 1.2) - (",m.addictionLevel||50," × 1.0) = ",P.toFixed(1)]})]}),a.jsx("div",{className:"bg-slate-700/50 rounded-lg p-3",children:a.jsxs("p",{className:"text-gray-300 text-xs",children:[a.jsx("strong",{children:"Mental Strength (×1.5):"})," Your resilience and coping ability",a.jsx("br",{}),a.jsx("strong",{children:"Motivation (×1.0):"})," Your drive to quit",a.jsx("br",{}),a.jsx("strong",{children:"Trigger Defense (×1.2):"})," Your ability to resist triggers",a.jsx("br",{}),a.jsx("strong",{children:"Addiction (×1.0):"})," Your nicotine dependence level"]})})]})]})})]})},FA=({isOpen:t,onClose:e,title:n,message:r,type:s="info"})=>{if(!t)return null;const i=()=>{switch(s){case"success":return"🎉";case"warning":return"⚠️";case"info":return"ℹ️";default:return"💡"}},o=()=>{switch(s){case"success":return"from-green-600 to-green-700";case"warning":return"from-yellow-600 to-yellow-700";case"info":return"from-blue-600 to-blue-700";default:return"from-slate-600 to-slate-700"}};return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full border border-slate-600 shadow-2xl animate-in slide-in-from-bottom-4 duration-300",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-slate-600 to-slate-700 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-3xl",children:i()})}),a.jsx("h3",{className:"text-xl font-bold text-white mb-3",children:n}),a.jsx("div",{className:"text-gray-300 mb-6 whitespace-pre-line text-sm leading-relaxed",children:r}),a.jsx("button",{onClick:e,className:`w-full bg-gradient-to-r ${o()} hover:from-slate-700 hover:to-slate-800 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105`,children:"Got it"})]})})})},UA=({gameType:t,onClose:e})=>{N.useState(0);const[n,r]=N.useState(!1),s=()=>r(!n),i=()=>{const c=N.useRef(null),[u,d]=N.useState([{x:7,y:7}]),[h,f]=N.useState({x:1,y:0}),[g,_]=N.useState({x:1,y:0}),[x,M]=N.useState({x:10,y:10}),[m,p]=N.useState(!1),[y,b]=N.useState(0),[P,C]=N.useState(1),R={1:160,2:Math.round(160/1.25),3:Math.round(160/1.25/1.25)},T={1:2,2:5,3:10};return N.useEffect(()=>{const L=w=>{if(m){w.preventDefault(),d([{x:7,y:7}]),f({x:1,y:0}),_({x:1,y:0}),M({x:10,y:10}),p(!1),b(0),C(1);return}switch(w.key){case"ArrowUp":w.preventDefault(),h.y!==1&&_({x:0,y:-1});break;case"ArrowDown":w.preventDefault(),h.y!==-1&&_({x:0,y:1});break;case"ArrowLeft":w.preventDefault(),h.x!==1&&_({x:-1,y:0});break;case"ArrowRight":w.preventDefault(),h.x!==-1&&_({x:1,y:0});break}};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[h,m]),N.useEffect(()=>{if(n||m)return;const L=setInterval(()=>{d(w=>{const S={x:w[0].x+h.x,y:w[0].y+h.y};if(S.x<0&&(S.x=14),S.x>=15&&(S.x=0),S.y<0&&(S.y=14),S.y>=15&&(S.y=0),w.slice(0,-1).some(U=>U.x===S.x&&U.y===S.y))return p(!0),w;const E=S.x===x.x&&S.y===x.y;let A;return E?(b(U=>U+T[P]),M({x:Math.floor(Math.random()*15),y:Math.floor(Math.random()*15)}),A=[S,...w]):A=[S,...w.slice(0,-1)],(g.x!==h.x||g.y!==h.y)&&setTimeout(()=>{f(g)},0),A})},R[P]);return()=>clearInterval(L)},[h,g,x,n,m]),N.useEffect(()=>{const L=c.current;if(!L)return;const w=L.getContext("2d"),S=20,v=15;w.fillStyle="#1f2937",w.fillRect(0,0,300,300),w.strokeStyle="#374151",w.lineWidth=1;for(let E=0;E<=v;E++)w.beginPath(),w.moveTo(E*S,0),w.lineTo(E*S,300),w.stroke(),w.beginPath(),w.moveTo(0,E*S),w.lineTo(300,E*S),w.stroke();u.forEach((E,A)=>{A===0?w.fillStyle="#fbbf24":w.fillStyle="#10b981",w.fillRect(E.x*S+1,E.y*S+1,S-2,S-2)}),w.fillStyle="#ef4444",w.fillRect(x.x*S+2,x.y*S+2,S-4,S-4)},[u,x]),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-center gap-2 mb-3",children:[a.jsx("span",{className:"text-white mr-2 text-sm",children:"Level:"}),[1,2,3].map(L=>a.jsxs("button",{onClick:()=>C(L),className:`
                  px-4 py-2 text-sm font-mono border-2 border-green-500 transition-all
                  ${P===L?"bg-green-500 text-black":"bg-green-900 text-green-400"}
                  hover:bg-green-600 cursor-pointer
                `,style:{minWidth:"80px"},children:[a.jsxs("div",{children:["Level ",L]}),a.jsxs("div",{className:"text-xs mt-1",children:[L===1&&"Normal",L===2&&"Fast",L===3&&"Insane"]})]},L))]}),a.jsxs("div",{className:"text-center text-yellow-400 text-xs mb-3",children:[a.jsxs("div",{children:["Speed: ",R[P],"ms | Points: ",T[P]," per food"]}),P===1&&"Good for beginners",P===2&&"For experienced players",P===3&&"Ultimate challenge"]})]}),a.jsx("canvas",{ref:c,width:"300",height:"300",className:"border-2 border-gray-300 mx-auto",style:{imageRendering:"pixelated"}}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["Score: ",y," | Level: ",P]}),a.jsxs("div",{className:"flex justify-center gap-4 mb-2 text-sm",children:[a.jsxs("div",{className:"text-gray-600",children:[a.jsx("span",{className:"font-semibold",children:"Current:"}),h.x===1&&"→",h.x===-1&&"←",h.y===1&&"↓",h.y===-1&&"↑"]}),g.x!==h.x||g.y!==h.y?a.jsxs("div",{className:"text-blue-600",children:[a.jsx("span",{className:"font-semibold",children:"Next:"}),g.x===1&&"→",g.x===-1&&"←",g.y===1&&"↓",g.y===-1&&"↑"]}):null]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Use arrow keys to control the snake"}),m&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-red-600 font-bold mb-2",children:"Game Over!"}),a.jsx("button",{onClick:()=>{d([{x:7,y:7}]),f({x:1,y:0}),_({x:1,y:0}),M({x:10,y:10}),p(!1),b(0),C(1)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm",children:"Restart Game"})]})]})]})},o=()=>{const[c,u]=N.useState(0),[d,h]=N.useState(0),[f]=N.useState(Date.now()),g=()=>{u(_=>_+1)};return N.useEffect(()=>{const _=(Date.now()-f)/1e3;_>0&&h((c/_).toFixed(1))},[c,f]),a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Click as Fast as You Can!"}),a.jsxs("div",{className:"text-lg text-gray-700 mb-2",children:["Total Clicks: ",c]}),a.jsxs("div",{className:"text-lg text-gray-700 mb-2",children:["Clicks/Second: ",d]}),a.jsx("button",{onClick:g,className:"w-48 h-48 text-2xl font-bold bg-orange-500 hover:bg-orange-600 border-none rounded-full text-white cursor-pointer transition-colors shadow-lg",children:"CLICK ME!"}),a.jsx("div",{className:"mt-4 text-sm text-gray-600",children:"Challenge: Try to reach 500 clicks!"})]})},l=()=>{try{switch(t){case"snake":return a.jsx(i,{});case"click-counter":return a.jsx(o,{});default:return a.jsx("div",{children:"Game not found"})}}catch(c){return console.error("Error rendering game:",c),a.jsxs("div",{className:"text-center text-red-600",children:[a.jsx("p",{className:"text-lg font-bold mb-2",children:"⚠️ Game Error"}),a.jsx("p",{className:"text-sm",children:"Something went wrong loading the game."}),a.jsx("button",{onClick:()=>window.location.reload(),className:"mt-2 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded text-sm",children:"Reload Game"})]})}};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[t==="snake"&&"🐍 Snake Game",t==="puzzle"&&"🧠 Memory Puzzle"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:s,className:"bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm",children:n?"Resume":"Pause"}),a.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]})]}),a.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[500px] flex items-center justify-center relative",children:[l(),a.jsxs("div",{className:"absolute top-2 left-2 bg-black/70 text-white p-2 rounded text-xs max-w-48",children:[a.jsx("p",{className:"font-bold mb-1",children:"Controls:"}),t==="snake"&&a.jsx("p",{children:"Arrow keys to move"}),t==="click-counter"&&a.jsx("p",{children:"Click the button rapidly!"})]}),a.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 text-white p-2 rounded text-xs",children:[a.jsx("p",{className:"font-bold mb-1",children:"Status:"}),a.jsx("p",{children:n?"⏸️ Paused":"▶️ Playing"})]})]}),a.jsx("div",{className:"mt-4 text-center",children:a.jsx("p",{className:"text-sm text-gray-500",children:"Games now run without time limits - play as long as you need!"})})]})})},$A=({user:t,nemesis:e,onBackToLogin:n,onResetForTesting:r})=>{const[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState(null),[d,h]=N.useState(!1),[f,g]=N.useState({title:"",message:"",type:"info"}),[_,x]=N.useState(0),[M,m]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;(async()=>{try{const L=new bp(W,t.uid);await L.initialize(),m(L)}catch(L){console.error("Error initializing StatManager:",L)}})(),(async()=>{try{const{ref:L,get:w,onValue:S}=await ye(()=>import("./index.esm-b358409e.js"),[]),v=L(W,`users/${t.uid}/profile/cravingsResisted`),E=await w(v);if(E.exists())x(E.val()||0);else{const U=parseInt(localStorage.getItem("cravingWins")||0);x(U)}return S(v,U=>{U.exists()&&x(U.val()||0)})}catch(L){console.error("Error loading cravings resisted from Firebase:",L);const w=parseInt(localStorage.getItem("cravingWins")||0);x(w)}})()},[t==null?void 0:t.uid]);const p=()=>{console.log("SOS sent to nemesis:",e.heroName);const R={timestamp:new Date().toISOString(),nemesis:e.heroName,status:"sent"};localStorage.setItem("lastSOS",JSON.stringify(R)),l(!0),setTimeout(()=>l(!1),5e3),M&&M.trackAppUsageDuringCravings()},y=R=>{u(R),i(!0)},b=()=>{u(null),i(!1)},P=async()=>{try{const R=_;if(localStorage.setItem("cravingWins",R+1),t&&t.uid){const{ref:T,set:L}=await ye(()=>import("./index.esm-b358409e.js"),[]),w=T(W,`users/${t.uid}/profile/cravingsResisted`);await L(w,R+1),x(R+1),console.log("Cravings resisted updated in profile:",R+1)}M&&await M.handleCravingResistance(),g({title:"Congratulations!",message:`🎉 Great job resisting that craving!

Every trigger survival increases:
• Mental Strength +1 point
• Trigger Defense +3 points

Keep up the amazing work!`,type:"success"}),h(!0)}catch(R){console.error("Error updating stats:",R),g({title:"Congratulations!",message:`🎉 Great job resisting that craving!

Your progress has been recorded locally.

Keep up the amazing work!`,type:"success"}),h(!0)}},C=(R,T)=>{g({title:R,message:T,type:"info"}),h(!0)};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 py-8 pb-20",children:a.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex justify-start gap-3",children:[a.jsx("button",{onClick:n,className:"px-6 py-3 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors flex items-center gap-2",children:"← Back to Login"}),!1]})}),a.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-8 border-2 border-red-200",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse",children:a.jsx("span",{className:"text-4xl",children:"🆘"})}),a.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Need Immediate Help?"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Press the SOS button to alert your nemesis and get instant support"}),a.jsx("button",{onClick:p,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-6 px-8 rounded-xl text-xl transition-all duration-300 transform hover:scale-105 shadow-lg",children:"🆘 SOS - Get Help Now"}),(()=>{const R=localStorage.getItem("lastSOS");if(R){const T=JSON.parse(R),L=Math.floor((Date.now()-new Date(T.timestamp))/(1e3*60));return a.jsx("div",{className:"mt-4 p-3 bg-red-50 rounded-lg border border-red-200",children:a.jsxs("p",{className:"text-sm text-red-600",children:["Last SOS sent ",L," minutes ago to ",T.nemesis]})})}return null})()]})}),a.jsx("div",{className:"bg-slate-800/50 rounded-xl p-6 mb-6 border border-slate-600",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"🎮 Distract Yourself"}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsx("button",{onClick:()=>y("snake"),className:"w-full bg-gradient-to-r from-orange-500/20 to-orange-600/20 hover:from-orange-500/30 hover:to-orange-600/30 text-white font-bold py-4 px-6 rounded-xl text-lg transition-all duration-300 transform hover:scale-105 border border-orange-500/30",children:"🐍 Play Snake"}),a.jsx("button",{onClick:()=>y("click-counter"),className:"w-full bg-gradient-to-r from-blue-500/20 to-blue-600/20 hover:from-blue-500/30 hover:to-blue-600/30 text-white font-bold py-4 px-6 rounded-xl text-lg transition-all duration-300 transform hover:scale-105 border border-blue-500/30",children:"⚡ Click Counter"})]})]})}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-600",children:[a.jsx("h2",{className:"text-xl font-bold text-white mb-4 text-center",children:"⚡ Quick Actions"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx("button",{onClick:()=>C("💧 Drink Water",`Hydration helps reduce cravings!

Drink a full glass of water slowly.

This will help you feel full and reduce the urge to vape.`),className:"bg-gradient-to-r from-blue-500/20 to-blue-600/20 hover:from-blue-500/30 hover:to-blue-600/30 text-white font-semibold py-4 px-4 rounded-xl transition-all duration-300 border border-blue-500/30 hover:scale-105",children:"💧 Drink Water"}),a.jsx("button",{onClick:()=>C("🫁 Breathe",`Take 3 deep breaths:

1. Inhale for 4 seconds
2. Hold for 4 seconds
3. Exhale for 4 seconds

Repeat 3 times`),className:"bg-gradient-to-r from-blue-500/20 to-blue-600/20 hover:from-blue-500/30 hover:to-blue-600/30 text-white font-semibold py-4 px-4 rounded-xl transition-all duration-300 border border-blue-500/30 hover:scale-105",children:"🫁 Breathe"}),a.jsx("button",{onClick:()=>C("🚶‍♂️ Walk",`Take a 5-minute walk:

Physical activity releases endorphins that can help reduce cravings.

Walk around your room or step outside if possible.`),className:"bg-gradient-to-r from-purple-500/20 to-purple-600/20 hover:from-purple-500/30 hover:to-purple-600/30 text-white font-semibold py-4 px-4 rounded-xl transition-all duration-300 border border-purple-500/30 hover:scale-105",children:"🚶‍♂️ Walk"}),a.jsx("button",{onClick:()=>C("🧘‍♀️ Meditate",`Quick Meditation:

1. Close your eyes
2. Focus on your breath
3. Count to 10 slowly
4. Repeat 3 times

This helps calm your mind and reduce stress.`),className:"bg-gradient-to-r from-green-500/20 to-green-600/20 hover:from-green-500/30 hover:to-green-600/30 text-white font-semibold py-4 px-4 rounded-xl transition-all duration-300 border border-green-500/30 hover:scale-105",children:"🧘‍♀️ Meditate"})]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("span",{className:"text-2xl",children:"✅"})}),a.jsx("h3",{className:"text-xl font-bold text-green-600 mb-2",children:"Help is on the way!"}),a.jsxs("p",{className:"text-gray-600 mb-4",children:["Your nemesis ",a.jsx("strong",{children:e.heroName})," has been notified and will reach out soon."]}),a.jsx("button",{onClick:()=>l(!1),className:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:"Got it"})]})}),s&&c&&a.jsx(UA,{gameType:c,onClose:b}),a.jsx(FA,{isOpen:d,onClose:()=>h(!1),title:f.title,message:f.message,type:f.type}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-6 border border-slate-600 mt-6",children:[a.jsx("h2",{className:"text-xl font-bold text-white mb-4 text-center",children:"📊 Cravings Resisted"}),a.jsxs("div",{className:"text-center p-6 bg-slate-700/50 rounded-lg border border-slate-500/30",children:[a.jsx("div",{className:"text-4xl mb-3",children:"🎯"}),a.jsx("p",{className:"text-lg font-bold text-white mb-2",children:"Total Wins"}),a.jsx("p",{className:"text-3xl font-bold text-green-400 mb-3",children:_}),a.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Times you successfully resisted cravings"}),a.jsx("button",{onClick:P,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg",children:"🎯 I Resisted a Craving!"})]})]})]})})},BA=({user:t,onNavigate:e})=>{var ga;const[n,r]=N.useState(null),[s,i]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState(!1),[d,h]=N.useState(!1),[f,g]=N.useState(!1),[_,x]=N.useState(null),[M,m]=N.useState(0),[p,y]=N.useState(null),[b,P]=N.useState(!1),[C,R]=N.useState([]),[T,L]=N.useState(null);N.useEffect(()=>{if(!(t!=null&&t.uid))return;(async()=>{try{const J=new bp(W,t.uid);await J.initialize(),L(J)}catch(J){console.error("Error initializing StatManager:",J)}})();const X=async()=>{try{const{ref:J,get:pe,onValue:We}=await ye(()=>import("./index.esm-b358409e.js"),[]),Et=J(W,`users/${t.uid}/profile/relapseDate`),It=await pe(Et);It.exists()&&r(new Date(It.val()));const Dn=J(W,`users/${t.uid}/profile/scheduledTriggers`),ze=await pe(Dn);ze.exists()&&R(ze.val());const nt=new Date().toDateString(),Nt=J(W,`users/${t.uid}/profile/daily/${nt}/water`),Kt=We(Nt,Lt=>{Lt.exists()&&m(Lt.val()||0)}),qc=J(W,`users/${t.uid}/profile/daily/${nt}/mood`),ya=We(qc,Lt=>{Lt.exists()&&y(Lt.val())}),va=J(W,`users/${t.uid}/profile/daily/${nt}/breathing`),Kc=We(va,Lt=>{Lt.exists()&&P(Lt.val()||!1)}),Yc=J(W,`users/${t.uid}/profile/scheduledTriggers`),Qc=We(Yc,Lt=>{Lt.exists()&&R(Lt.val()||[])});return()=>{Kt(),ya(),Kc(),Qc()}}catch(J){console.error("Error loading profile data from Firebase:",J),Ne()}},Ne=()=>{const J=localStorage.getItem("quitCoachRelapseDate");J&&r(new Date(J));const pe=new Date().toDateString(),We=localStorage.getItem(`water_${pe}`),Et=localStorage.getItem(`mood_${pe}`),It=localStorage.getItem(`breathing_${pe}`);We&&m(parseInt(We)),Et&&y(JSON.parse(Et)),It&&P(It==="true");const Dn=localStorage.getItem("scheduledTriggers");Dn&&R(JSON.parse(Dn))};X()},[t==null?void 0:t.uid]),N.useEffect(()=>{T&&T.trackLoggingActivity()},[T]),N.useEffect(()=>{if(!(t!=null&&t.uid))return;(async()=>{try{const{ref:X,get:Ne,set:J}=await ye(()=>import("./index.esm-b358409e.js"),[]),pe=X(W,`users/${t.uid}/profile`),We=await Ne(pe);if(!We.exists()||Object.keys(We.val()).length===0){console.log("Migrating localStorage data to Firebase...");const Et=localStorage.getItem("quitCoachRelapseDate");Et&&(await J(X(W,`users/${t.uid}/profile/relapseDate`),Et),r(new Date(Et)));const It=parseInt(localStorage.getItem("cravingWins")||0);It>0&&await J(X(W,`users/${t.uid}/profile/cravingsResisted`),It);for(let ze=0;ze<7;ze++){const nt=new Date;nt.setDate(nt.getDate()-ze);const Nt=nt.toDateString(),Kt=localStorage.getItem(`water_${Nt}`);Kt&&await J(X(W,`users/${t.uid}/profile/daily/${Nt}/water`),parseInt(Kt))}for(let ze=0;ze<7;ze++){const nt=new Date;nt.setDate(nt.getDate()-ze);const Nt=nt.toDateString(),Kt=localStorage.getItem(`mood_${Nt}`);Kt&&await J(X(W,`users/${t.uid}/profile/daily/${Nt}/mood`),JSON.parse(Kt))}for(let ze=0;ze<7;ze++){const nt=new Date;nt.setDate(nt.getDate()-ze);const Nt=nt.toDateString(),Kt=localStorage.getItem(`breathing_${Nt}`);Kt&&await J(X(W,`users/${t.uid}/profile/daily/${Nt}/breathing`),Kt==="true")}const Dn=localStorage.getItem("scheduledTriggers");if(Dn){const ze=JSON.parse(Dn);await J(X(W,`users/${t.uid}/profile/scheduledTriggers`),ze),R(ze)}console.log("localStorage data migration to Firebase completed")}}catch(X){console.error("Error migrating localStorage data to Firebase:",X)}})()},[t==null?void 0:t.uid]);const w=()=>n&&n>((t==null?void 0:t.quitDate)||new Date(0))?n:(t==null?void 0:t.quitDate)||new Date,S=()=>{const ie=new Date,X=new Date(ie);X.setHours(24,0,0,0);const Ne=X-ie,J=Math.floor(Ne/(1e3*60*60)),pe=Math.floor(Ne%(1e3*60*60)/(1e3*60)),We=Math.floor(Ne%(1e3*60)/1e3);return{hours:J,minutes:pe,seconds:We}},[v,E]=N.useState(S()),[A,U]=N.useState(0),[G,Q]=N.useState(0),[k,$]=N.useState(0),[B,Y]=N.useState(0);N.useEffect(()=>{const ie=setInterval(()=>{E(S());const X=w(),J=new Date-X,pe=Math.floor(J/(1e3*60*60*24)),We=Math.floor(J%(1e3*60*60*24)/(1e3*60*60)),Et=Math.floor(J%(1e3*60*60)/(1e3*60)),It=Math.floor(J%(1e3*60)/1e3);U(pe),Q(We),$(Et),Y(It)},1e3);return()=>clearInterval(ie)},[n,t==null?void 0:t.quitDate]);const q=async(ie,X)=>{if(!(t!=null&&t.uid))return!1;try{const{ref:Ne,set:J}=await ye(()=>import("./index.esm-b358409e.js"),[]),pe=Ne(W,`users/${t.uid}/profile/${ie}`);return await J(pe,X),!0}catch(Ne){return console.error("Error saving to Firebase:",Ne),!1}},ue=async()=>{const ie=new Date;r(ie),T&&await T.handleRelapse(),await q("relapseDate",ie.toISOString())||localStorage.setItem("quitCoachRelapseDate",ie.toISOString())},re=(()=>{const ie=new Date,X=ie.getDay(),Ne=X===0?6:X-1,J=[{name:"Mon",color:"bg-slate-700"},{name:"Tue",color:"bg-slate-700"},{name:"Wed",color:"bg-slate-700"},{name:"Thu",color:"bg-slate-700"},{name:"Fri",color:"bg-slate-700"},{name:"Sat",color:"bg-slate-700"},{name:"Sun",color:"bg-slate-700"}];for(let pe=0;pe<=Ne;pe++)J[pe].color="bg-green-500";return n&&n.toDateString()===ie.toDateString()&&(J[Ne].color="bg-red-500"),J})(),he=async ie=>{m(ie);const X=new Date().toDateString();T&&await T.handleHydrationUpdate(ie),await q(`daily/${X}/water`,ie)||localStorage.setItem(`water_${X}`,ie.toString()),i(!1)},ot=async ie=>{y(ie);const X=new Date().toDateString();await q(`daily/${X}/mood`,ie)||localStorage.setItem(`mood_${X}`,JSON.stringify(ie)),u(!1)},Gc=async()=>{P(!0);const ie=new Date().toDateString();T&&await T.handleBreathingExercise(),await q(`daily/${ie}/breathing`,!0)||localStorage.setItem(`breathing_${ie}`,"true"),l(!1)},ma=async(ie,X,Ne)=>{const J={day:ie,triggerType:X,time:Ne,id:Date.now()},pe=[...C,J];R(pe),T&&await T.handleTriggerPlanning(),await q("scheduledTriggers",pe)||localStorage.setItem("scheduledTriggers",JSON.stringify(pe)),h(!1)},Sp=async()=>{T&&await T.handleTriggerListUpdate()};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 pb-20",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 pt-16",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center",children:t!=null&&t.avatar?a.jsx("img",{src:t.avatar,alt:"Avatar",className:"w-full h-full object-cover rounded-full"}):a.jsx("span",{className:"text-white font-bold text-lg",children:t!=null&&t.heroName?t.heroName.charAt(0).toUpperCase():"H"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-lg",children:"Hello,"}),a.jsx("p",{className:"text-white text-2xl font-bold",children:(t==null?void 0:t.heroName)||"Hero"})]})]}),a.jsx("div",{className:"bg-yellow-500 px-3 py-1 rounded-full",children:a.jsx("span",{className:"font-bold text-slate-900",children:A})})]}),a.jsxs("div",{className:"px-4 space-y-6",children:[a.jsx("div",{className:"mb-6",children:a.jsxs("button",{onClick:ue,className:"w-full bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105",children:[a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("span",{className:"text-2xl",children:"⚠️"}),a.jsx("span",{className:"text-lg",children:"RELAPSE"}),a.jsx("span",{className:"text-2xl",children:"⚠️"})]}),a.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Reset progress and start over"})]})}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-white text-xl font-bold",children:"My week"}),a.jsxs("div",{className:"bg-green-500 px-3 py-1 rounded-full flex items-center gap-1",children:[a.jsx("span",{className:"text-white text-sm",children:"✓"}),a.jsx("span",{className:"text-white font-bold",children:"0"})]})]}),a.jsx("div",{className:"flex justify-between items-center mb-4",children:re.map((ie,X)=>a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full mb-1 ${ie.color}`}),a.jsx("p",{className:"text-gray-400 text-xs",children:ie.name})]},ie.name))})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[a.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Remaining time for Today"}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-white text-3xl font-bold",children:[v.hours.toString().padStart(2,"0"),":",v.minutes.toString().padStart(2,"0"),":",v.seconds.toString().padStart(2,"0")]}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Countdown to midnight"})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-white text-2xl font-bold mb-4",children:"My progress"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-yellow-400 text-lg",children:"⏰"}),a.jsx("span",{className:"text-gray-300",children:"Clean for"})]}),a.jsxs("div",{className:"flex items-baseline gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-white text-3xl font-bold",children:A.toString().padStart(2,"0")}),a.jsx("div",{className:"text-gray-400 text-sm",children:"days"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-white text-3xl font-bold",children:G.toString().padStart(2,"0")}),a.jsx("div",{className:"text-gray-400 text-sm",children:"hours"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-white text-3xl font-bold",children:k.toString().padStart(2,"0")}),a.jsx("div",{className:"text-gray-400 text-sm",children:"minutes"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-white text-2xl font-bold animate-pulse",children:B.toString().padStart(2,"0")}),a.jsx("div",{className:"text-gray-400 text-sm",children:"seconds"})]})]}),n&&a.jsx("div",{className:"mt-3 text-center",children:a.jsxs("p",{className:"text-red-400 text-sm",children:["Last relapse: ",n.toLocaleDateString()," at ",n.toLocaleTimeString()]})})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-white text-2xl font-bold mb-4",children:"Habit Tracking"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("button",{onClick:()=>i(!0),className:"w-full bg-gradient-to-r from-blue-500/20 to-blue-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"💧"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Stay hydrated"}),a.jsx("p",{className:"text-gray-300 text-sm",children:M>0?`${M} glasses today`:"Tap to log water intake"})]}),a.jsx("div",{className:"text-blue-400 text-2xl",children:"→"})]})}),a.jsx("button",{onClick:()=>l(!0),className:"w-full bg-gradient-to-r from-purple-500/20 to-purple-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"🫁"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Complete breathing exercise"}),a.jsx("p",{className:"text-gray-300 text-sm",children:b?"Completed! Stay calm!":"Tap to start 4-cycle breathing"})]}),a.jsx("div",{className:"text-purple-400 text-2xl",children:"→"})]})}),a.jsx("button",{onClick:()=>u(!0),className:"w-full bg-gradient-to-r from-green-500/20 to-green-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"🌤️"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Mood tracking"}),a.jsx("p",{className:"text-gray-300 text-sm",children:p?`You feel ${p.name.toLowerCase()}`:"How do you feel today?"})]}),a.jsx("div",{className:"text-green-400 text-2xl",children:"→"})]})})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-white text-2xl font-bold mb-4",children:"This Week's Battle Plan"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:()=>h(!0),className:"w-full bg-gradient-to-r from-orange-500/20 to-orange-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"🛡️"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Trigger defense planning"}),a.jsx("p",{className:"text-gray-300 text-sm",children:C.length>0?`${C.length} triggers planned`:"Plan your trigger defense strategy"})]}),a.jsx("div",{className:"text-orange-400 text-2xl",children:"→"})]})}),a.jsx("button",{onClick:Sp,className:"w-full bg-gradient-to-r from-purple-500/20 to-purple-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"📝"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Update trigger list"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Review and update your personal triggers for +1 Trigger Defense"})]}),a.jsx("div",{className:"text-purple-400 text-2xl",children:"→"})]})})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-white text-2xl font-bold mb-4",children:"Benefits Monitor"}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("span",{className:"text-yellow-400",children:"$"}),a.jsx("span",{className:"text-gray-300 text-sm",children:"Money saved"})]}),a.jsx("div",{className:"text-white text-2xl font-bold",children:((ga=t==null?void 0:t.stats)==null?void 0:ga.moneySaved)||0}),a.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Work in progress"})]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-white text-2xl font-bold mb-4",children:"Diary"}),a.jsx("button",{onClick:()=>g(!0),className:"w-full bg-gradient-to-r from-indigo-500/20 to-indigo-600/20 bg-slate-800/50 rounded-xl p-4 text-left hover:scale-105 transition-all duration-300",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center text-xl",children:"📅"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-white font-bold text-lg",children:"Monthly overview"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"View your progress and daily activities"})]}),a.jsx("div",{className:"text-indigo-400 text-2xl",children:"→"})]})})]})]}),a.jsx(VA,{isOpen:s,onClose:()=>i(!1),onConfirm:he,currentWater:M}),a.jsx(WA,{isOpen:o,onClose:()=>l(!1),onComplete:Gc}),a.jsx(zA,{isOpen:c,onClose:()=>u(!1),onSelect:ot,selectedMood:p}),a.jsx(HA,{isOpen:d,onClose:()=>h(!1),onSchedule:ma,scheduledTriggers:C}),a.jsx(GA,{isOpen:f,onClose:()=>g(!1),selectedDate:_,onDateSelect:x,dailyData:{water:M,mood:p,breathing:b,relapseDate:n}})]})},VA=({isOpen:t,onClose:e,onConfirm:n,currentWater:r})=>{const[s,i]=N.useState(r);return t?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"💧 Water Intake"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"How many glasses of water today?"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("input",{type:"number",min:"0",max:"20",value:s,onChange:o=>i(parseInt(o.target.value)||0),className:"w-full bg-slate-700 text-white text-center text-2xl font-bold py-4 rounded-lg border border-slate-600 focus:border-blue-500 focus:outline-none",placeholder:"0"}),a.jsx("p",{className:"text-gray-400 text-sm text-center mt-2",children:"0-20 glasses"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:e,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:()=>n(s),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Confirm"})]})]})}):null},WA=({isOpen:t,onClose:e,onComplete:n})=>{const[r,s]=N.useState(1),[i,o]=N.useState("exhale"),[l,c]=N.useState(5),[u,d]=N.useState(!1);N.useEffect(()=>{if(!t||!u)return;const _=setInterval(()=>{c(x=>{if(x<=1){if(i==="exhale")o("inhale"),c(4);else if(i==="inhale")o("hold"),c(7);else if(i==="hold")if(r<4)s(M=>M+1),o("exhale"),c(5);else return d(!1),n(),0;return x}return x-1})},1e3);return()=>clearInterval(_)},[t,u,i,r,n]);const h=()=>{d(!0),s(1),o("exhale"),c(5)};if(!t)return null;const f=()=>{switch(i){case"exhale":return"Exhale, empty lungs";case"inhale":return"Inhale quietly through nose";case"hold":return"Hold your breath";default:return""}},g=()=>{switch(i){case"exhale":return"w-32 h-32";case"inhale":return"w-48 h-48";case"hold":return"w-40 h-40";default:return"w-40 h-40"}};return a.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"text-center text-white",children:u?a.jsxs(a.Fragment,{children:[a.jsxs("h3",{className:"text-2xl font-bold mb-4",children:["Cycle ",r,"/4"]}),a.jsx("p",{className:"text-xl text-gray-300 mb-8",children:f()}),a.jsx("div",{className:"flex justify-center mb-8",children:a.jsx("div",{className:`${g()} rounded-full border-4 border-blue-400 flex items-center justify-center transition-all duration-1000 ${i==="hold"?"animate-pulse":""}`,children:a.jsx("span",{className:"text-4xl font-bold",children:l})})}),a.jsx("button",{onClick:e,className:"bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:"Stop"})]}):a.jsxs("div",{className:"mb-8",children:[a.jsx("h3",{className:"text-3xl font-bold mb-4",children:"🫁 Breathing Exercise"}),a.jsx("p",{className:"text-xl text-gray-300 mb-6",children:"4-cycle breathing pattern"}),a.jsx("button",{onClick:h,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl text-xl transition-colors",children:"Start Exercise"})]})})})},zA=({isOpen:t,onClose:e,onSelect:n,selectedMood:r})=>{const s=[{name:"Anger",icon:"😠",color:"bg-red-500"},{name:"Disgust",icon:"🤢",color:"bg-orange-500"},{name:"Enjoyment",icon:"😊",color:"bg-yellow-500"},{name:"Calm",icon:"😌",color:"bg-blue-500"},{name:"Fear",icon:"😨",color:"bg-purple-500"},{name:"Sadness",icon:"😢",color:"bg-indigo-500"},{name:"Indifferent",icon:"😐",color:"bg-gray-500"}];return t?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"🌤️ How do you feel?"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Select your current mood"})]}),a.jsx("div",{className:"grid grid-cols-2 gap-3 mb-6",children:s.map(i=>a.jsxs("button",{onClick:()=>n(i),className:`p-4 rounded-xl text-center transition-all duration-300 hover:scale-105 ${(r==null?void 0:r.name)===i.name?"ring-2 ring-blue-400":"bg-slate-700 hover:bg-slate-600"}`,children:[a.jsx("div",{className:`w-12 h-12 ${i.color} rounded-full flex items-center justify-center text-2xl mx-auto mb-2`,children:i.icon}),a.jsx("p",{className:"text-white font-semibold",children:i.name})]},i.name))}),a.jsx("button",{onClick:e,className:"w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"})]})}):null},HA=({isOpen:t,onClose:e,onSchedule:n,scheduledTriggers:r})=>{const[s,i]=N.useState(""),[o,l]=N.useState(""),[c,u]=N.useState("12:00"),d=["Social event","Drinks","High-stress event","Social pressure"],h=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return t?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"🛡️ Trigger Defense Planning"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Schedule your trigger defense strategy"})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-white text-sm font-semibold mb-2",children:"Day of the week"}),a.jsxs("select",{value:s,onChange:f=>i(f.target.value),className:"w-full bg-slate-700 text-white p-3 rounded-lg border border-slate-600 focus:border-blue-500 focus:outline-none",children:[a.jsx("option",{value:"",children:"Select a day"}),h.map(f=>a.jsx("option",{value:f,children:f},f))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-white text-sm font-semibold mb-2",children:"Trigger type"}),a.jsxs("select",{value:o,onChange:f=>l(f.target.value),className:"w-full bg-slate-700 text-white p-3 rounded-lg border border-slate-600 focus:border-blue-500 focus:outline-none",children:[a.jsx("option",{value:"",children:"Select trigger type"}),d.map(f=>a.jsx("option",{value:f,children:f},f))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-white text-sm font-semibold mb-2",children:"Time"}),a.jsx("input",{type:"time",value:c,onChange:f=>u(f.target.value),className:"w-full bg-slate-700 text-white p-3 rounded-lg border border-slate-600 focus:border-blue-500 focus:outline-none"})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:e,className:"flex-1 bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{onClick:()=>{s&&o&&c&&n(s,o,c)},disabled:!s||!o||!c,className:"flex-1 bg-orange-600 hover:bg-orange-700 disabled:bg-slate-600 text-white font-bold py-3 rounded-lg transition-colors disabled:cursor-not-allowed",children:"Schedule"})]})]})}):null},GA=({isOpen:t,onClose:e,selectedDate:n,onDateSelect:r,dailyData:s})=>t?a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 max-w-md w-full shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"📅 Daily Summary"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"Your activities and progress"})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"💧 Water Intake"}),a.jsxs("p",{className:"text-gray-300",children:[s.water," glasses"]})]}),a.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"🌤️ Mood"}),a.jsx("p",{className:"text-gray-300",children:s.mood?s.mood.name:"Not logged"})]}),a.jsxs("div",{className:"bg-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-white font-semibold mb-2",children:"🫁 Breathing Exercise"}),a.jsx("p",{className:"text-gray-300",children:s.breathing?"✓ Completed":"✗ Not completed"})]}),s.relapseDate&&a.jsxs("div",{className:"bg-red-900/50 rounded-lg p-4 border border-red-500",children:[a.jsx("h4",{className:"text-red-300 font-semibold mb-2",children:"⚠️ Relapse"}),a.jsxs("p",{className:"text-red-300",children:[s.relapseDate.toLocaleDateString()," at ",s.relapseDate.toLocaleTimeString()]})]})]}),a.jsx("button",{onClick:e,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition-colors",children:"Close"})]})}):null,qA=({onResetApp:t})=>a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 pb-20",children:a.jsxs("div",{className:"max-w-md mx-auto px-4 pt-16",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(vx,{className:"w-16 h-16 mx-auto mb-4 text-blue-400"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Settings"}),a.jsx("p",{className:"text-gray-300",children:"Manage your app preferences"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[a.jsx("h3",{className:"text-white font-semibold mb-2",children:"App Data"}),a.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Reset your progress and start over"}),a.jsx("button",{onClick:t,className:"w-full bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg transition-colors",children:"Reset App & Start Over"})]}),a.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4",children:[a.jsx("h3",{className:"text-white font-semibold mb-2",children:"About"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"QuitCard Arena v1.0.0"}),a.jsx("p",{className:"text-gray-400 text-sm",children:"Your journey to freedom starts here"})]})]})]})}),KA=({user:t,nemesis:e,buddyMatchingService:n})=>{var S;const[r,s]=N.useState([{id:1,sender:"buddy",text:"Hey! How's your quit journey going?",timestamp:new Date(Date.now()-6e4).toLocaleTimeString()},{id:2,sender:"user",text:"Going strong! Day 3 now.",timestamp:new Date(Date.now()-3e4).toLocaleTimeString()}]),[i,o]=N.useState(""),[l,c]=N.useState(!1),[u,d]=N.useState(null),[h,f]=N.useState(!1),[g,_]=N.useState(null),[x,M]=N.useState(!1),[m,p]=N.useState(null),[y,b]=N.useState(null);N.useEffect(()=>{(async()=>{if(!(!n||!(t!=null&&t.uid)))try{console.log("🔍 Checking for existing buddy pair...");const E=await n.getUserBuddyInfo(t.uid);if(E){console.log("✅ Found existing buddy pair:",E),b(E);const A=await n.getBuddyPairInfo(E.id);A&&_(A)}}catch(E){console.error("Error loading existing buddy pair:",E)}})()},[n,t==null?void 0:t.uid]);const P=()=>{if(i.trim().length===0)return;const v=i.trim().slice(0,20),E={id:Date.now(),sender:"user",text:v,timestamp:new Date().toLocaleTimeString()};s(A=>[...A,E]),o(""),c(!0),setTimeout(()=>{const A=["Keep it up! 💪","You're doing great!","Stay strong today!","One day at a time!","I believe in you!","You've got this!","Every day counts!","Stay focused! 🎯"],U=A[Math.floor(Math.random()*A.length)],G={id:Date.now()+1,sender:"buddy",text:U,timestamp:new Date().toLocaleTimeString()};s(Q=>[...Q,G]),c(!1)},1500)},C=v=>{v.key==="Enter"&&P()},R=async()=>{if(!n||!(t!=null&&t.uid)){p({error:!0,message:"Buddy matching service not available"});return}M(!0),p(null);try{console.log("🔍 Searching for compatible buddies...");const v=await n.findCompatibleMatches(t.uid,5);if(v&&v.length>0){console.log("✅ Found compatible matches:",v);const E=v[0],A=E.compatibilityScore,U=E.matchReasons;p({success:!0,matches:v,bestMatch:E,compatibilityScore:A,matchReasons:U,message:`Found ${v.length} compatible buddy${v.length>1?"s":""}!`}),_(E)}else console.log("⚠️ No compatible matches found"),p({success:!1,message:"No compatible buddies found at the moment. Check back later!",suggestion:"Make sure your profile is complete and you're available for matching."})}catch(v){console.error("❌ Error finding buddy:",v),p({error:!0,message:"Failed to search for buddies. Please try again.",details:v.message})}finally{M(!1)}},T=async()=>{if(!n||!(t!=null&&t.uid)||!g){console.error("Cannot create buddy pair: missing required data");return}try{console.log("🤝 Creating buddy pair...");const v=await n.createBuddyPair(t.uid,g.userId,{compatibilityScore:g.compatibilityScore,matchReasons:g.matchReasons,matchedAt:Date.now()});console.log("✅ Buddy pair created successfully:",v),b({id:v,user1:t.uid,user2:g.userId,matchedAt:Date.now()}),await n.removeFromMatchingPool(t.uid),await n.removeFromMatchingPool(g.userId),p({success:!0,message:"🎉 Buddy pair created successfully! You can now chat with your new buddy.",pairId:v})}catch(v){console.error("❌ Error creating buddy pair:",v),p({error:!0,message:"Failed to create buddy pair. Please try again.",details:v.message})}},L=async()=>{if(!(!n||!(t!=null&&t.uid)))try{await n.removeFromMatchingPool(t.uid),console.log("✅ Removed from matching pool"),p({success:!0,message:'You have been removed from the matching pool. You can rejoin anytime by clicking "Find My Buddy" again.'}),_(null)}catch(v){console.error("❌ Error removing from matching pool:",v)}},w=async()=>{f(!0),d(null);try{if(!n)throw new Error("BuddyMatchingService not available");console.log("🧪 Starting Real Buddy Matching Service Test...");const v=await n.getMatchingPoolStats();if(console.log("Matching pool stats:",v),t!=null&&t.uid){const E=await n.findCompatibleMatches(t.uid,3);if(console.log(`Found ${E.length} compatible matches for current user`),E.length>0){const A=E[0];console.log("Best match:",A);const U=await n.createBuddyPair(t.uid,A.userId,{compatibilityScore:A.compatibilityScore,matchReasons:A.matchReasons,matchedAt:Date.now()});console.log("Buddy pair created with ID:",U);const G=await n.getBuddyPairInfo(U);console.log("Buddy pair info:",G),await n.removeFromMatchingPool(t.uid),await n.removeFromMatchingPool(A.userId),d({success:!0,userCount:v.totalUsers,poolStats:v,matchesFound:E.length,bestMatch:A.heroName,compatibilityScore:A.compatibilityScore,pairId:U,message:"Real buddy matching service test completed successfully!",timestamp:new Date().toLocaleTimeString()})}else d({success:!1,message:"No compatible matches found for testing",poolStats:v,timestamp:new Date().toLocaleTimeString()})}else throw new Error("No authenticated user for testing")}catch(v){console.error("❌ Error testing real buddy matching service:",v),d({error:!0,message:v.message,timestamp:new Date().toLocaleTimeString()})}finally{f(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 py-8 pb-20",children:a.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"💬 Chat with Buddy"}),a.jsx("p",{className:"text-gray-300",children:"Stay connected with your quit buddy for support"})]}),a.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"space-y-4 mb-6 max-h-96 overflow-y-auto",children:[r.map(v=>a.jsx("div",{className:`flex ${v.sender==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs px-4 py-2 rounded-2xl ${v.sender==="user"?"bg-blue-600 text-white":"bg-slate-700 text-gray-200"}`,children:[a.jsx("div",{className:"text-sm",children:v.text}),a.jsx("div",{className:"text-xs opacity-70 mt-1",children:v.timestamp})]})},v.id)),l&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"bg-slate-700 text-gray-200 px-4 py-2 rounded-2xl",children:a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx("span",{className:"text-sm",children:"Buddy is typing"}),a.jsxs("div",{className:"flex space-x-1",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:i,onChange:v=>o(v.target.value),onKeyPress:C,placeholder:"Type your message (max 20 chars)...",maxLength:20,className:"flex-1 bg-slate-700 text-white px-4 py-3 rounded-xl border border-slate-600 focus:border-blue-500 focus:outline-none"}),a.jsx("button",{onClick:P,disabled:i.trim().length===0,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 text-white px-6 py-3 rounded-xl transition-colors disabled:cursor-not-allowed",children:"Send"})]}),a.jsx("div",{className:"text-right mt-2",children:a.jsxs("span",{className:`text-xs ${i.length>=18?"text-yellow-400":"text-gray-400"}`,children:[i.length,"/20"]})})]}),a.jsxs("div",{className:"mt-6 bg-slate-800 rounded-2xl p-6 shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"🤝 Find Your Quit Buddy"}),a.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Connect with someone on a similar quit journey"}),a.jsxs("div",{className:"flex gap-3 justify-center",children:[a.jsx("button",{onClick:R,disabled:x||!n,className:"bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white px-6 py-3 rounded-xl transition-colors disabled:cursor-not-allowed font-semibold",children:x?"🔍 Searching...":"Find My Buddy"}),a.jsx("button",{onClick:L,disabled:!n,className:"bg-slate-600 hover:bg-slate-700 text-white px-4 py-3 rounded-xl transition-colors font-semibold",children:"Leave Pool"})]})]}),m&&a.jsx("div",{className:"mt-4 p-4 bg-slate-700 rounded-xl border border-slate-600",children:m.error?a.jsxs("div",{className:"text-red-400",children:[a.jsxs("p",{className:"font-semibold",children:["❌ ",m.message]}),m.details&&a.jsx("p",{className:"text-sm mt-1",children:m.details})]}):m.success&&m.bestMatch?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-green-400",children:a.jsxs("p",{className:"font-semibold",children:["✅ ",m.message]})}),a.jsxs("div",{className:"bg-slate-600 rounded-lg p-3",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:((S=m.bestMatch.heroName)==null?void 0:S.charAt(0))||"B"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-white font-semibold",children:m.bestMatch.heroName||"Buddy"}),a.jsxs("p",{className:"text-gray-300 text-sm",children:["Compatibility: ",m.compatibilityScore," points"]})]})]}),m.matchReasons&&m.matchReasons.length>0&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-gray-300 text-xs mb-1",children:"Why you're a great match:"}),a.jsx("ul",{className:"text-xs text-gray-400 space-y-1",children:m.matchReasons.slice(0,3).map((v,E)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx("span",{className:"text-green-400 mr-2",children:"•"}),v]},E))})]})]}),a.jsxs("button",{onClick:T,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors font-semibold",children:["🤝 Connect with ",m.bestMatch.heroName||"Buddy"]})]}):a.jsxs("div",{className:"text-yellow-400",children:[a.jsxs("p",{className:"font-semibold",children:["⚠️ ",m.message]}),m.suggestion&&a.jsx("p",{className:"text-sm mt-1 text-gray-300",children:m.suggestion})]})}),y?a.jsx("div",{className:"mt-4 p-4 bg-green-900/20 rounded-xl border border-green-600/50",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white font-bold",children:"🤝"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-green-400 font-semibold",children:"Connected with Buddy"}),a.jsx("p",{className:"text-gray-300 text-sm",children:"You can now chat and support each other!"}),a.jsxs("p",{className:"text-xs text-gray-400",children:["Connected: ",new Date(y.matchedAt).toLocaleDateString()]})]})]})}):g?a.jsx("div",{className:"mt-4 p-4 bg-blue-900/20 rounded-xl border border-blue-600/50",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold",children:"👥"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-blue-400 font-semibold",children:"Buddy Found"}),a.jsx("p",{className:"text-gray-300 text-sm",children:'Click "Connect" above to start your journey together!'})]})]})}):null]}),a.jsx("div",{className:"mt-6 bg-slate-800 rounded-2xl p-6 shadow-2xl border border-slate-700",children:a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:e.heroName.charAt(0)}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-white",children:e.heroName}),a.jsx("p",{className:"text-gray-300",children:"Your Quit Buddy"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Always here to support you"})]})]})}),a.jsxs("div",{className:"mt-6 bg-slate-800 rounded-2xl p-6 shadow-2xl border border-slate-700",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"🧪 Test Buddy Matching Algorithm"}),a.jsx("p",{className:"text-gray-300 text-sm mb-4",children:"Verify the matching service works correctly"}),a.jsx("button",{onClick:w,disabled:h,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-slate-600 text-white px-6 py-3 rounded-xl transition-colors disabled:cursor-not-allowed font-semibold",children:h?"Testing...":"Test Algorithm"})]}),u&&a.jsxs("div",{className:"mt-4 p-4 bg-slate-700 rounded-xl border border-slate-600",children:[a.jsx("h4",{className:"text-lg font-bold text-white mb-3",children:"Testing Results:"}),u.error?a.jsxs("div",{className:"text-red-400",children:[a.jsx("p",{className:"font-semibold",children:"❌ Test Failed:"}),a.jsx("p",{className:"text-sm",children:u.message}),a.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Timestamp: ",u.timestamp]})]}):u.success?a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsx("p",{className:"text-green-400",children:a.jsxs("span",{className:"font-semibold",children:["✅ ",u.message]})}),a.jsx("p",{className:"text-blue-400",children:a.jsxs("span",{className:"font-semibold",children:["Matching Pool: ",u.userCount," users available"]})}),a.jsxs("p",{className:"text-yellow-400",children:[a.jsxs("span",{className:"font-semibold",children:["Best Match: ",u.bestMatch]}),u.compatibilityScore>0&&` (Score: ${u.compatibilityScore})`]}),u.pairId&&a.jsx("p",{className:"text-purple-400",children:a.jsxs("span",{className:"font-semibold",children:["Buddy Pair Created: ",u.pairId]})}),a.jsxs("p",{className:"text-gray-400 text-xs mt-3",children:[a.jsx("span",{className:"font-semibold",children:"Check console for detailed logs"}),a.jsx("br",{}),"Timestamp: ",u.timestamp]})]}):a.jsxs("div",{className:"text-yellow-400",children:[a.jsxs("p",{className:"font-semibold",children:["⚠️ ",u.message]}),u.poolStats&&a.jsxs("p",{className:"text-sm text-gray-300",children:["Pool Stats: ",u.poolStats.totalUsers," users, ",u.poolStats.activeUsers," active"]}),a.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Timestamp: ",u.timestamp]})]})]})]})]})})},YA=()=>{const[t,e]=N.useState("arena"),[n,r]=N.useState("auth"),[s,i]=N.useState(null),[o,l]=N.useState(null),[c,u]=N.useState(!1),[d,h]=N.useState(null),[f,g]=N.useState(!0),[_,x]=N.useState({isLoading:!1,progress:0,currentStep:"",error:null,isComplete:!1}),[M,m]=N.useState([]),[p,y]=N.useState(null),b=()=>({mentalStrength:50,motivation:50,triggerDefense:30,addictionLevel:50,moneySaved:0}),P=()=>({dailyWater:0,dailyMood:null,dailyBreathing:!1,scheduledTriggers:[],relapseDate:null,cravingsResisted:0}),C=I=>{I.relapseDate&&$(new Date(I.relapseDate)),I.dailyWater!==void 0&&Y(I.dailyWater),I.dailyMood!==void 0&&ue(I.dailyMood),I.dailyBreathing!==void 0&&re(I.dailyBreathing),I.scheduledTriggers&&ot(I.scheduledTriggers)},R=(I,V)=>{const F=document.createElement("div");F.className="fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg bg-red-500 text-white max-w-sm",F.innerHTML=`
      <div class="font-bold">${I}</div>
      <div class="text-sm opacity-90">${V}</div>
      <button class="mt-2 text-sm underline" onclick="this.parentElement.remove()">Dismiss</button>
    `,document.body.appendChild(F),setTimeout(()=>{F.parentNode&&F.parentNode.removeChild(F)},1e4)},T=async I=>{if(!I)return!1;x({isLoading:!0,progress:0,currentStep:"Initializing...",error:null,isComplete:!1});try{const{ref:V,get:F,onValue:oe}=await ye(()=>import("./index.esm-b358409e.js"),[]);x(me=>({...me,currentStep:"Loading profile data...",progress:20}));const Ue=V(W,`users/${I}`),Oe=await F(Ue);if(!Oe.exists())throw new Error("User profile not found");const at=Oe.val(),lt=L(at);x(me=>({...me,currentStep:"Loading battle stats...",progress:40}));const Ct=V(W,`users/${I}/stats`),an=await F(Ct),jn=an.exists()?w(an.val()):b();x(me=>({...me,currentStep:"Loading habits and progress...",progress:60}));const ks=V(W,`users/${I}/profile`),On=await F(ks),ct=On.exists()?S(On.val()):P();x(me=>({...me,currentStep:"Loading achievements...",progress:80}));const mt=V(W,`users/${I}/profile/cravingsResisted`),ir=await F(mt),Ps=ir.exists()?Math.max(0,parseInt(ir.val())||0):0;x(me=>({...me,currentStep:"Setting up live sync...",progress:90}));const Ln=oe(Ct,me=>{if(me.exists()){const Rs=w(me.val());if(ga(Rs),n==="arena"&&o){const Sx={...o,stats:Rs};calculateRealTimeStats(Sx).then(setRealTimeUserStats)}}}),or=oe(ks,me=>{if(me.exists()){const Rs=S(me.val());n==="profile"&&C(Rs)}}),ke=oe(mt,me=>{if(me.exists()){const Rs=Math.max(0,parseInt(me.val())||0);n==="craving-support"&&ma(Rs)}});return m([Ln,or,ke]),x(me=>({...me,currentStep:"Finalizing...",progress:100})),l(me=>({...me,...lt,stats:jn})),C(ct),ma(Ps),lt.onboardingCompleted&&u(!0),x({isLoading:!1,progress:100,currentStep:"Data loaded successfully!",error:null,isComplete:!0}),console.log("✅ All user data loaded successfully:",{profile:lt,stats:jn,profileData:ct,cravingsResisted:Ps}),!0}catch(V){return console.error("❌ Error loading user data:",V),x({isLoading:!1,progress:0,currentStep:"Failed to load data",error:V.message,isComplete:!1}),R("Failed to load user data",V.message),!1}},L=I=>I?{uid:I.uid||"",email:I.email||"",heroName:I.heroName||"Hero",archetype:I.archetype||"The Determined",avatar:I.avatar||dr("default"),quitDate:I.quitDate||new Date().toISOString(),onboardingCompleted:!!I.onboardingCompleted,updatedAt:I.updatedAt||Date.now(),...I}:v(),w=I=>I?{mentalStrength:Math.max(0,Math.min(100,parseInt(I.mentalStrength)||50)),motivation:Math.max(0,Math.min(100,parseInt(I.motivation)||50)),triggerDefense:Math.max(0,Math.min(100,parseInt(I.triggerDefense)||30)),addictionLevel:Math.max(0,Math.min(100,parseInt(I.addictionLevel)||50)),moneySaved:Math.max(0,parseInt(I.moneySaved)||0),...I}:b(),S=I=>I?{dailyWater:Math.max(0,parseInt(I.dailyWater)||0),dailyMood:I.dailyMood||null,dailyBreathing:!!I.dailyBreathing,scheduledTriggers:Array.isArray(I.scheduledTriggers)?I.scheduledTriggers:[],relapseDate:I.relapseDate?new Date(I.relapseDate).toISOString():null,cravingsResisted:Math.max(0,parseInt(I.cravingsResisted)||0),...I}:P(),v=()=>({uid:"",email:"",heroName:"Hero",archetype:"The Determined",avatar:dr("default"),quitDate:new Date().toISOString(),onboardingCompleted:!1,updatedAt:Date.now()});N.useEffect(()=>()=>{M.forEach(I=>{typeof I=="function"&&I()})},[M]),N.useEffect(()=>{const I=()=>{console.log("🌐 Internet connection restored"),d!=null&&d.uid&&_.isComplete&&(console.log("🔄 Auto-refreshing data after connection restore..."),T(d.uid))},V=()=>{console.log("📡 Internet connection lost"),x(F=>({...F,currentStep:"Offline mode - data will sync when connection is restored",error:"No internet connection"}))};return window.addEventListener("online",I),window.addEventListener("offline",V),()=>{window.removeEventListener("online",I),window.removeEventListener("offline",V)}},[d==null?void 0:d.uid,_.isComplete]);const[E,A]=N.useState(null);N.useEffect(()=>{(async()=>{try{const V=(await ye(()=>import("./offlineManager-c0c9e5cf.js"),[])).default,F=new V;A(F),window.refreshUserData=Q,console.log("✅ Offline manager initialized")}catch(V){console.error("Error initializing offline manager:",V)}})()},[]);const U=async I=>{if(!I)return!1;const V=await T(I);if(V&&E&&(await E.cacheUserData(o),await E.cacheProfileData({dailyWater:B,dailyMood:q,dailyBreathing:xe,scheduledTriggers:he,relapseDate:k,cravingsResisted:Gc})),!V&&E){console.log("📱 Loading offline data...");const F=await E.getCachedUserData(),oe=await E.getCachedProfileData();if(F)return console.log("📱 Using offline user data"),l(F),u(F.onboardingCompleted),oe&&C(oe),!0}return V},G=async()=>d!=null&&d.uid?(console.log("🔄 Refreshing user data with offline support..."),await U(d.uid)):!1,Q=async()=>{if(!(d!=null&&d.uid)){R("Cannot Refresh","No authenticated user found");return}if(console.log("🔄 Manually refreshing user data..."),await G()){const V=document.createElement("div");V.className="fixed top-20 right-4 z-50 p-4 rounded-lg shadow-lg bg-green-500 text-white max-w-sm",V.innerHTML=`
        <div class="font-bold">✅ Data Refreshed!</div>
        <div class="text-sm opacity-90">Your data has been synced across all devices</div>
        <button class="mt-2 text-sm underline" onclick="this.parentElement.remove()">Dismiss</button>
      `,document.body.appendChild(V),setTimeout(()=>{V.parentNode&&V.parentNode.removeChild(V)},5e3)}else R("Refresh Failed","Could not refresh data. Please try again.")},[k,$]=N.useState(null),[B,Y]=N.useState(0),[q,ue]=N.useState(null),[xe,re]=N.useState(!1),[he,ot]=N.useState([]),[Gc,ma]=N.useState(0),[Sp,ga]=N.useState(b());N.useEffect(()=>{const I=F=>{if(F.message&&F.message.includes("content_script")){console.warn("Browser extension error (ignored):",F.message);return}if(F.message&&(F.message.includes("FrameDoesNotExistError")||F.message.includes("background.js"))){console.warn("Background frame error (ignored):",F.message);return}console.error("Global error caught:",F)},V=F=>{if(F.reason&&F.reason.message&&F.reason.message.includes("content_script")){console.warn("Browser extension promise rejection (ignored):",F.reason.message);return}if(F.reason&&F.reason.message&&(F.reason.message.includes("FrameDoesNotExistError")||F.reason.message.includes("background.js"))){console.warn("Background frame promise rejection (ignored):",F.reason.message);return}console.error("Unhandled promise rejection:",F.reason)};return window.addEventListener("error",I),window.addEventListener("unhandledrejection",V),()=>{window.removeEventListener("error",I),window.removeEventListener("unhandledrejection",V)}},[]),N.useEffect(()=>{const I=async(V=0)=>{try{const{ref:F,set:oe,get:Ue,child:Oe}=await ye(()=>import("./index.esm-b358409e.js"),[]),at=F(W),lt=Oe(at,"healthchecks/vite_dev");await oe(lt,{lastRun:Date.now()});const Ct=await Ue(lt);console.log("🔥 Firebase RTDB connected. Healthcheck exists:",Ct.exists())}catch(F){if(console.error("Firebase connectivity test failed:",(F==null?void 0:F.message)||F),V<3){const oe=Math.pow(2,V)*1e3;console.log(`Retrying Firebase connection in ${oe}ms... (attempt ${V+1}/3)`),setTimeout(()=>I(V+1),oe)}else console.error("Firebase connection failed after 3 retries. Check your internet connection and Firebase configuration.")}};I()},[]),N.useEffect(()=>{let I=!0,V=null;return(async()=>{try{console.log("Initializing authentication state..."),g(!0);const{onAuthStateChanged:oe}=await ye(()=>import("./index.esm-a2e859a0.js"),[]);V=oe(ns,async Oe=>{if(I)if(console.log("Auth state changed:",Oe?`User: ${Oe.uid}`:"No user"),Oe){h(Oe),console.log("User authenticated, checking database for user data...");try{const{ref:at,get:lt}=await ye(()=>import("./index.esm-b358409e.js"),[]),Ct=at(W,`users/${Oe.uid}`),an=await lt(Ct);if(an.exists()){const jn=an.val();console.log("Existing user data found - auto-login successful"),l(jn),u(!0),r("arena"),console.log("User auto-logged in and redirected to Arena")}else console.log("No user data found - new user needs onboarding"),r("onboarding")}catch(at){console.error("Error fetching user data during auto-login:",at),r("onboarding")}}else console.log("No authenticated user - showing login screen"),h(null),l(null),u(!1),r("auth")});const Ue=setTimeout(()=>{I&&(console.warn("Auth initialization timeout - forcing to auth screen"),g(!1),r("auth"))},1e4);V&&clearTimeout(Ue)}catch(oe){console.error("Error initializing authentication:",oe),I&&(g(!1),r("auth"))}finally{I&&g(!1)}})(),()=>{I=!1,V&&V()}},[]);const ie=async I=>{console.log("Authentication successful, checking for existing user data...",{uid:I==null?void 0:I.uid,email:I==null?void 0:I.email});try{const{ref:V,get:F}=await ye(()=>import("./index.esm-b358409e.js"),[]);console.log("Checking database for existing user data...");const oe=V(W,`users/${I.uid}`),Ue=await F(oe);if(Ue.exists()){const Oe=Ue.val();if(console.log("Existing user data found - loading all user data..."),await U(I.uid))console.log("✅ All user data loaded successfully, going to Arena"),r("arena");else{console.log("⚠️ Data loading failed, but proceeding to Arena with basic data"),l(Oe);const lt=!!Oe.onboardingCompleted;u(lt),r("arena")}}else console.log("No user data found - starting onboarding"),r("onboarding")}catch(V){console.error("Database check failed:",V),r("onboarding")}},[X,Ne]=N.useState(null),[J,pe]=N.useState(!1),[We,Et]=N.useState(null),It=async()=>{var I,V,F,oe,Ue,Oe,at,lt;if(!(o!=null&&o.uid)){console.log("⚠️ Cannot load buddy: missing user UID"),pe(!1);return}if(J){console.log("⚠️ Buddy loading already in progress, skipping...");return}pe(!0),Et(null);try{console.log("🔍 Loading real buddy data for user:",o.uid);const{ref:Ct,get:an,query:jn,orderByChild:ks,equalTo:On}=await ye(()=>import("./index.esm-b358409e.js"),[]);console.log("🔍 Querying buddyPairs collection...");let ct=null,mt=null;const ir=Ct(W,"buddyPairs"),Ps=await an(ir);if(Ps.exists()){const Ln=Ps.val();console.log("📊 All buddy pairs:",Ln);for(const[or,ke]of Object.entries(Ln))if(console.log(`🔍 Checking pair ${or}:`,ke),ke.users&&Array.isArray(ke.users)&&ke.users.includes(o.uid)){console.log("✅ Found buddy pair containing current user:",or),ct=ke,ct.pairId=or,mt=ke.users.find(me=>me!==o.uid),console.log("👥 Current user:",o.uid,"Buddy user:",mt);break}}if(ct&&mt){console.log("✅ Found existing buddy pair:",ct),console.log("👤 Buddy user ID:",mt),console.log("📥 Loading buddy user data...");const Ln=Ct(W,`users/${mt}`),or=await an(Ln);if(or.exists()){const ke=or.val();console.log("✅ Loaded buddy user data:",ke);const me={heroName:ke.heroName||"Buddy",stats:{streakDays:((I=ke.stats)==null?void 0:I.streakDays)||0,addictionLevel:((V=ke.stats)==null?void 0:V.addictionLevel)||50,willpower:((F=ke.stats)==null?void 0:F.mentalStrength)||50,motivation:((oe=ke.stats)==null?void 0:oe.mentalStrength)||50,cravingResistance:((Ue=ke.stats)==null?void 0:Ue.mentalStrength)||50,triggerDefense:((Oe=ke.stats)==null?void 0:Oe.triggerDefense)||30,moneySaved:((at=ke.stats)==null?void 0:at.moneySaved)||0,experiencePoints:((lt=ke.stats)==null?void 0:lt.experiencePoints)||0},achievements:ke.achievements||[],archetype:ke.archetype||"The Determined",avatar:ke.avatar||dr(ke.heroName||"buddy","adventurer"),userId:mt,isRealBuddy:!0,pairId:ct.pairId};console.log("🎯 Buddy data loaded successfully:",me.heroName),Ne(me),await Dn(o.uid,mt)}else console.log("⚠️ Buddy user data not found for ID:",mt),Ne(null)}else console.log("ℹ️ No existing buddy pair found for user:",o.uid),Ne(null)}catch(Ct){console.error("❌ Error loading real buddy:",Ct),Et(Ct.message),Ne(null)}finally{pe(!1)}},Dn=async(I,V)=>{try{console.log("🧹 Removing users from matching pool..."),console.log("User 1:",I,"User 2:",V);const{ref:F,remove:oe,set:Ue}=await ye(()=>import("./index.esm-b358409e.js"),[]);await oe(F(W,`matchingPool/${I}`)),await oe(F(W,`matchingPool/${V}`)),console.log("✅ Removed both users from matching pool"),X!=null&&X.pairId&&(await Ue(F(W,`buddyPairs/${X.pairId}/user1RemovedFromPool`),!0),await Ue(F(W,`buddyPairs/${X.pairId}/user2RemovedFromPool`),!0),console.log("✅ Updated buddy pair pool removal flags"))}catch(F){console.error("❌ Error removing users from matching pool:",F)}};N.useEffect(()=>{if(o!=null&&o.uid&&!X&&!J){console.log("🔍 Loading buddy data for new user:",o.uid);try{It()}catch(I){console.error("❌ Error in buddy loading effect:",I),Et("Failed to load buddy data"),pe(!1)}}},[o==null?void 0:o.uid]);const ze=async()=>{if(!(o!=null&&o.uid)){console.log("⚠️ Cannot auto-match: missing user UID");return}try{console.log("🔍 Auto-matching available users..."),console.log("Current user UID:",o.uid);const{ref:I,get:V,set:F,push:oe,remove:Ue}=await ye(()=>import("./index.esm-b358409e.js"),[]),Oe=I(W,"buddyPairs"),at=await V(Oe);let lt=!1;if(at.exists()){const ir=at.val();for(const[Ps,Ln]of Object.entries(ir))if(Ln.users&&Ln.users.includes(o.uid)){console.log("✅ User already has a buddy, skipping auto-match"),lt=!0;break}}if(lt)return;const Ct=I(W,"matchingPool"),an=await V(Ct);if(!an.exists()){console.log("ℹ️ No matching pool found");return}const jn=Object.keys(an.val());if(console.log("📊 Users in matching pool:",jn),jn.length<2){console.log("ℹ️ Need at least 2 users for auto-matching");return}const ks=jn.filter(ir=>ir!==o.uid);if(ks.length===0){console.log("ℹ️ No other users available for matching");return}const On=ks[0];console.log(`🎯 Auto-matching with user: ${On}`);const ct=oe(I(W,"buddyPairs")).key,mt={pairId:ct,users:[o.uid,On],matchedAt:new Date().toISOString(),compatibilityScore:.85,matchReasons:["Auto-matched from app","High compatibility detected"],status:"active",lastMessageAt:new Date().toISOString(),user1RemovedFromPool:!1,user2RemovedFromPool:!1};await F(I(W,`buddyPairs/${ct}`),mt),console.log("✅ Auto-created buddy pair:",ct),await F(I(W,`users/${o.uid}/buddyInfo`),{hasBuddy:!0,buddyId:On,pairId:ct,matchedAt:mt.matchedAt}),await F(I(W,`users/${On}/buddyInfo`),{hasBuddy:!0,buddyId:o.uid,pairId:ct,matchedAt:mt.matchedAt}),await Ue(I(W,`matchingPool/${o.uid}`)),await Ue(I(W,`matchingPool/${On}`)),await F(I(W,`buddyPairs/${ct}/user1RemovedFromPool`),!0),await F(I(W,`buddyPairs/${ct}/user2RemovedFromPool`),!0),console.log("✅ Auto-match complete! Reloading buddy data..."),await It()}catch(I){console.error("❌ Error in auto-matching:",I),alert("Failed to find buddy match. Please try again later.")}};N.useEffect(()=>{const I=V=>{const F=V.detail;console.log("Navigating to tab:",F),F==="buddy-chat"&&(r("buddy-chat"),e("buddy-chat"))};return window.addEventListener("navigateToTab",I),()=>{window.removeEventListener("navigateToTab",I)}},[]);const nt={heroName:"",stats:{streakDays:0,addictionLevel:0,willpower:0,motivation:0,cravingResistance:0,triggerDefense:0,moneySaved:0,experiencePoints:0},achievements:[],archetype:"",avatar:null,isEmpty:!0,message:"We are looking for a suitable buddy for you"},Nt=()=>J?{heroName:"Loading Buddy...",stats:{streakDays:0,addictionLevel:50,willpower:50,motivation:50,cravingResistance:50,triggerDefense:30,moneySaved:0,experiencePoints:0},achievements:[],archetype:"LOADING",avatar:dr("loading","adventurer"),isLoading:!0}:We?{heroName:"Error Loading Buddy",stats:{streakDays:0,addictionLevel:50,willpower:50,motivation:50,cravingResistance:50,triggerDefense:30,moneySaved:0,experiencePoints:0},achievements:[],archetype:"ERROR",avatar:dr("error","adventurer"),isError:!0,errorMessage:We}:X||nt,Kt=async I=>{console.log("Onboarding completed with user data:",I);try{if(!I||!I.heroName||!I.stats)throw new Error("Invalid user data received from onboarding");if(!d)throw new Error("No authenticated user found");const V={...I,uid:d.uid,email:d.email,displayName:d.displayName||I.heroName,photoURL:d.photoURL,onboardingCompleted:!0,updatedAt:Date.now()};console.log("Saving user data to Firebase:",V);const{ref:F,set:oe}=await ye(()=>import("./index.esm-b358409e.js"),[]),Ue=F(W,`users/${d.uid}`);if(await oe(Ue,V),console.log("Firebase save successful, updating app state..."),l(V),u(!0),p)try{console.log("Adding user to buddy matching pool..."),await p.addToMatchingPool(d.uid,{quitStartDate:V.quitDate,addictionLevel:V.stats.addictionLevel,triggers:V.triggers||[],timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,quitExperience:V.quitAttempts||"first",availableForMatching:!0,lastActive:Date.now(),userId:d.uid,heroName:V.heroName,archetype:V.archetype}),console.log("✅ User added to buddy matching pool successfully")}catch(at){console.error("⚠️ Failed to add user to buddy matching pool:",at)}console.log("Loading all user data after onboarding completion...");const Oe=await U(d.uid);console.log(Oe?"✅ All user data loaded successfully after onboarding":"⚠️ Data loading failed after onboarding, but proceeding"),r("arena"),console.log("Onboarding completed successfully:",{user:V,hasCompletedOnboarding:!0,currentView:"arena"})}catch(V){console.error("Error in handleOnboardingComplete:",V);const F={heroName:(I==null?void 0:I.heroName)||"Hero",archetype:(I==null?void 0:I.archetype)||"The Determined",avatar:(I==null?void 0:I.avatar)||dr("fallback"),stats:{addictionLevel:50,mentalStrength:50,motivation:50,triggerDefense:30,streakDays:0,moneySaved:0,experiencePoints:0},achievements:[],quitDate:new Date,uid:d==null?void 0:d.uid,email:d==null?void 0:d.email,onboardingCompleted:!0};if(console.log("Using fallback user data due to error:",F),d)try{console.log("Attempting to save fallback data to Firebase...");const{ref:oe,set:Ue}=await ye(()=>import("./index.esm-b358409e.js"),[]),Oe=oe(W,`users/${d.uid}`);await Ue(Oe,F),console.log("Fallback data saved to Firebase successfully")}catch(oe){console.error("Failed to save fallback data to Firebase:",oe)}l(F),u(!0),r("arena"),console.log("App state set with fallback data")}},qc=()=>{l(null),u(!1),r("onboarding"),e("arena"),i(null),localStorage.removeItem("quitCoachUser")},ya=async()=>{try{console.log("Logging out user...");const{signOut:I}=await ye(()=>import("./index.esm-a2e859a0.js"),[]);await I(ns),l(null),h(null),u(!1),r("auth"),localStorage.removeItem("lastSOS"),localStorage.removeItem("cravingWins"),localStorage.removeItem("specialFeatures"),console.log("User successfully logged out and redirected to login screen")}catch(I){console.error("Error during logout:",I),l(null),h(null),u(!1),r("auth")}},va=async()=>{if(!d){console.error("No authenticated user to reset");return}try{console.log("Resetting ALL user data for testing...");const{ref:I,set:V}=await ye(()=>import("./index.esm-b358409e.js"),[]),F=I(W,`users/${d.uid}`);await V(F,null);const oe=I(W,"users");await V(oe,null),console.log("All user data cleared from database"),l(null),u(!1),r("onboarding"),console.log("Account reset successful - ready for fresh onboarding")}catch(I){console.error("Error resetting account for testing:",I)}},Kc=I=>{console.log("Tab changed to:",I),e(I),r(I)},Yc=I=>{r(I==="mood-selector"?"mood-selector":"profile")},Qc=I=>{i(I),r("profile")},Lt=()=>{r("profile")};return f?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold mb-4",children:"🔐 Restoring Session..."}),a.jsx("p",{className:"text-xl text-gray-300 mb-4",children:"Checking authentication state"}),a.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 max-w-md mx-auto",children:a.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Checking Firebase Auth persistence"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Verifying user session (30 days)"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Loading user data from database"]})]})}),a.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"This should take only a few seconds"})]})}):n==="auth"?a.jsx(xA,{onAuthSuccess:ie}):_.isLoading?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center text-white",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-white mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold mb-4",children:"📊 Loading Your Data..."}),a.jsx("p",{className:"text-xl text-gray-300 mb-4",children:_.currentStep}),a.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 max-w-md mx-auto mb-6",children:[a.jsx("div",{className:"w-full bg-slate-700 rounded-full h-3 mb-3",children:a.jsx("div",{className:"bg-blue-500 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${_.progress}%`}})}),a.jsxs("div",{className:"text-sm text-gray-400",children:[_.progress,"% Complete"]})]}),a.jsx("div",{className:"bg-slate-800/50 rounded-lg p-4 max-w-md mx-auto",children:a.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Profile and onboarding data"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Battle stats and progress"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Habits and achievements"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-blue-400",children:"✓"}),"Setting up live sync"]})]})}),_.error&&a.jsxs("div",{className:"mt-4 p-3 bg-red-600/20 border border-red-500/30 rounded-lg max-w-md mx-auto",children:[a.jsxs("p",{className:"text-red-300 text-sm",children:[a.jsx("span",{className:"font-semibold",children:"Error:"})," ",_.error]}),a.jsx("p",{className:"text-red-400 text-xs mt-1",children:"Don't worry, you can still use the app with basic functionality"})]}),a.jsx("p",{className:"text-gray-400 text-sm mt-4",children:"Syncing your data across all devices..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900",children:[a.jsx(bA,{}),!1,n==="onboarding"&&a.jsxs("div",{children:[console.log("Rendering OnboardingFlow"),a.jsx(AA,{onComplete:Kt,authUser:d})]}),c&&o?a.jsxs(a.Fragment,{children:[console.log("Main app rendering with user:",o,"view:",n),n==="arena"&&a.jsxs("div",{children:[console.log("Rendering ArenaView with user:",o),(()=>{try{const I=Nt();return a.jsx(MA,{user:o,nemesis:I,onBackToLogin:ya,onResetForTesting:va,buddyLoading:J,buddyError:We,onRefreshBuddy:It,onAutoMatch:ze,realBuddy:X})}catch(I){return console.error("Error rendering ArenaView:",I),a.jsxs("div",{className:"text-white text-center p-8",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Error Loading Arena"}),a.jsx("p",{className:"text-gray-300 mb-4",children:I.message}),a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 px-4 py-2 rounded hover:bg-blue-700",children:"Reload App"})]})}})()]}),n==="craving-support"&&a.jsxs("div",{children:[console.log("Rendering CravingSupportView with user:",o),a.jsx($A,{user:o,nemesis:Nt(),onBackToLogin:ya,onResetForTesting:va})]}),n==="profile"&&a.jsxs("div",{children:[console.log("Rendering ProfileView with user:",o),a.jsx(BA,{user:o,onNavigate:Yc})]}),n==="mood-selector"&&a.jsx(MoodSelector,{onMoodSelect:Qc,onBack:Lt}),n==="buddy-chat"&&a.jsx(KA,{user:o,nemesis:Nt(),buddyMatchingService:p}),n==="settings"&&a.jsx(qA,{onResetApp:qc}),a.jsx(LA,{activeTab:t,onTabChange:Kc,dataLoadingState:_,onRefreshData:Q,offlineManager:E})]}):a.jsx("div",{className:"flex items-center justify-center min-h-screen text-white",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Loading..."}),a.jsx("p",{className:"text-gray-300",children:c?"User data missing":"Onboarding not completed"}),a.jsxs("p",{className:"text-gray-300",children:["Current view: ",n]}),a.jsxs("p",{className:"text-gray-300",children:["User data: ",o?JSON.stringify(o,null,2):"None"]}),a.jsx("button",{onClick:()=>{console.log("Debug button clicked"),console.log("Current state:",{hasCompletedOnboarding:c,user:o,currentView:n}),console.log("User data:",o)},className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Debug State"})]})})]})};Hu.createRoot(document.getElementById("root")).render(a.jsx($x.StrictMode,{children:a.jsx(YA,{})}));export{eD as $,nD as A,rD as B,sD as C,gs as D,JA as E,ah as F,hD as G,fD as H,pD as I,mD as J,Y_ as K,yD as L,Z as M,QA as N,AC as O,DC as P,wn as Q,_n as R,ID as S,ZC as T,SD as U,Ye as V,XA as W,ZA as X,cD as Y,lD as Z,TD as _,KC as a,hk as a$,DD as a0,ha as a1,da as a2,OD as a3,zo as a4,Cs as a5,pr as a6,kD as a7,mr as a8,Un as a9,XD as aA,JP as aB,LD as aC,fT as aD,a2 as aE,w2 as aF,kg as aG,Hk as aH,UT as aI,ZD as aJ,HD as aK,ck as aL,h2 as aM,g2 as aN,_2 as aO,l2 as aP,t2 as aQ,Ik as aR,MD as aS,tT as aT,uk as aU,f2 as aV,m2 as aW,v2 as aX,gT as aY,i2 as aZ,yk as a_,tr as aa,nl as ab,AD as ac,os as ad,ri as ae,WP as af,PD as ag,u2 as ah,uh as ai,RD as aj,zP as ak,mp as al,gr as am,VD as an,Nk as ao,c2 as ap,Dw as aq,VP as ar,Lw as as,fk as at,BD as au,BT as av,pk as aw,jD as ax,o2 as ay,qD as az,qt as b,zD as b0,Ek as b1,FD as b2,sp as b3,$D as b4,mk as b5,GD as b6,d2 as b7,sP as b8,y2 as b9,s2 as ba,UD as bb,r2 as bc,QD as bd,JD as be,p2 as bf,YD as bg,n2 as bh,e2 as bi,KD as bj,WD as bk,ye as bl,Nf as c,En as d,gi as e,CD as f,QC as g,ND as h,bD as i,oD as j,aD as k,gD as l,_D as m,vD as n,Le as o,YC as p,wD as q,Z_ as r,Lv as s,xD as t,ED as u,Hf as v,uD as w,dD as x,iD as y,tD as z};
